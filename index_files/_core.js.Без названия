!function(){"use strict";function t(t){console.warn("video load error, gif fallback used");const e=t.querySelector("img");e&&t.parentNode.replaceChild(e,t)}function e(t){const e=document.cookie.match(new RegExp(`(?:^|; )${t.replace(/([$()*+./?[\\\]^{|}])/g,"\\$1")}=([^;]*)`));return e?decodeURIComponent(e[1]):void 0}function i(t,e,i={}){let s=i.expires;if("number"==typeof s&&s){const t=new Date;t.setTime(t.getTime()+1e3*s),s=t,i.expires=t}s&&s.toUTCString&&(i.expires=s.toUTCString());let o=`${t}=${e=encodeURIComponent(e)}`;Object.keys(i).forEach((t=>{o+=`; ${t}`;const e=i[t];!0!==e&&(o+=`=${e}`)})),document.cookie=o}function s(t){window.setCookie(t,"",{expires:-1})}function o(t){let e;if(t){const t=window.location.href.indexOf("?");if(-1===t)return[];e=window.location.href.substr(t+1)}else e=window.location.search.substr(1);const i={};return e.split("&").forEach((t=>{if(!t)return;const e=(t=t.split("+").join(" ")).indexOf("=");let s=e>-1?t.substr(0,e):t;const o=e>-1?n(t.substr(e+1)):"",a=s.indexOf("[");if(-1===a)i[n(s)]=o;else{const t=s.indexOf("]",a),e=n(s.substring(a+1,t));s=n(s.substring(0,a)),i[s]||(i[s]=[]),e?i[s][e]=o:i[s].push(o)}})),i}function n(t){try{return decodeURIComponent(t)}catch(e){return t}}function a(t,e=3,i=" "){return(t+="").split("").reverse().join("").match(new RegExp(`.{0,${e}}`,"g")).join(i).split("").reverse().join("").trim()}function r(t){t.preventDefault()}function l(t=!1){document.body[!0===t?"addEventListener":"removeEventListener"]("touchmove",r,!1)}!function(t){const e=[],i="ResizeObserver loop completed with undelivered notifications.";let s;!function(t){t.BORDER_BOX="border-box",t.CONTENT_BOX="content-box",t.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(s||(s={}));const o=function(){function t(t,e,i,s){return this.x=t,this.y=e,this.width=i,this.height=s,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return t.prototype.toJSON=function(){let t=this;return{x:t.x,y:t.y,top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}},t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t}(),n=function(t){return t instanceof SVGElement&&"getBBox"in t},a=function(t){if(n(t)){let e=t.getBBox(),i=e.width,s=e.height;return!i&&!s}let e=t,i=e.offsetWidth,s=e.offsetHeight;return!(i||s||t.getClientRects().length)},r=function(t){let e,i;const s=null===(i=null===(e=t)||void 0===e?void 0:e.ownerDocument)||void 0===i?void 0:i.defaultView;return!!(s&&t instanceof s.Element)},l=void 0!==t?t:{},d=new Map,c=/auto|scroll/,h=/^tb|vertical/,u=/msie|trident/i.test(l.navigator&&l.navigator.userAgent),p=function(t){return parseFloat(t||"0")},m=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=!1),Object.freeze({inlineSize:(i?e:t)||0,blockSize:(i?t:e)||0})},f=Object.freeze({devicePixelContentBoxSize:m(),borderBoxSize:m(),contentBoxSize:m(),contentRect:new o(0,0,0,0)}),g=function(t){if(d.has(t))return d.get(t);if(a(t))return d.set(t,f),f;const e=getComputedStyle(t),i=n(t)&&t.ownerSVGElement&&t.getBBox(),s=!u&&"border-box"===e.boxSizing,r=h.test(e.writingMode||""),l=!i&&c.test(e.overflowY||""),g=!i&&c.test(e.overflowX||""),v=i?0:p(e.paddingTop),b=i?0:p(e.paddingRight),w=i?0:p(e.paddingBottom),$=i?0:p(e.paddingLeft),y=i?0:p(e.borderTopWidth),_=i?0:p(e.borderRightWidth),x=i?0:p(e.borderBottomWidth),A=$+b,C=v+w,S=(i?0:p(e.borderLeftWidth))+_,k=y+x,I=g?t.offsetHeight-k-t.clientHeight:0,E=l?t.offsetWidth-S-t.clientWidth:0,F=s?A+S:0,z=s?C+k:0,T=i?i.width:p(e.width)-F-E,D=i?i.height:p(e.height)-z-I,R=T+A+E+S,M=D+C+I+k,B=Object.freeze({devicePixelContentBoxSize:m(Math.round(T*devicePixelRatio),Math.round(D*devicePixelRatio),r),borderBoxSize:m(R,M,r),contentBoxSize:m(T,D,r),contentRect:new o($,v,T,D)});return d.set(t,B),B},v=function(t,e){let i=g(t),o=i.borderBoxSize,n=i.contentBoxSize,a=i.devicePixelContentBoxSize;switch(e){case s.DEVICE_PIXEL_CONTENT_BOX:return a;case s.BORDER_BOX:return o;default:return n}},b=function(t){const e=g(t);this.target=t,this.contentRect=e.contentRect,this.borderBoxSize=[e.borderBoxSize],this.contentBoxSize=[e.contentBoxSize],this.devicePixelContentBoxSize=[e.devicePixelContentBoxSize]},w=function(t){if(a(t))return 1/0;let e=0,i=t.parentNode;for(;i;)e+=1,i=i.parentNode;return e},$=function(){let t=1/0;const i=[];e.forEach((e=>{if(0===e.activeTargets.length)return;const s=[];e.activeTargets.forEach((e=>{const i=new b(e.target),o=w(e.target);s.push(i),e.lastReportedSize=v(e.target,e.observedBox),o<t&&(t=o)})),i.push((()=>{e.callback.call(e.observer,s,e.observer)})),e.activeTargets.splice(0,e.activeTargets.length)}));for(let t=0,e=i;t<e.length;t++){(0,e[t])()}return t},y=function(t){d.clear(),e.forEach((e=>{e.activeTargets.splice(0,e.activeTargets.length),e.skippedTargets.splice(0,e.skippedTargets.length),e.observationTargets.forEach((i=>{i.isActive()&&(w(i.target)>t?e.activeTargets.push(i):e.skippedTargets.push(i))}))}))},_=function(){let s=0;for(y(s);e.some((t=>t.activeTargets.length>0));)s=$(),y(s);return e.some((t=>t.skippedTargets.length>0))&&function(){let e;"function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:i}):(e=document.createEvent("Event"),e.initEvent("error",!1,!1),e.message=i),t.dispatchEvent(e)}(),s>0};let x;const A=[],C=function(t){if(!x){const t=document.createTextNode(""),e={characterData:!0};new MutationObserver((()=>A.splice(0).forEach((t=>t())))).observe(t,e),x=function(){t.textContent=""}}A.push(t),x()};let S=0;const k={attributes:!0,characterData:!0,childList:!0,subtree:!0},I=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"];let E=!1;const F=new(function(){function t(){const t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return t.prototype.run=function(t){const e=this;var i;E||(E=!0,i=()=>{let i=!1;try{i=_()}finally{if(E=!1,!S)return;i?e.run(60):t?e.run(t-1):e.start()}},C((()=>{requestAnimationFrame(i)})))},t.prototype.schedule=function(){this.stop(),this.run(12)},t.prototype.observe=function(){const t=this,e=function(){return t.observer&&t.observer.observe(document.body,k)};document.body?e():l.addEventListener("DOMContentLoaded",e)},t.prototype.start=function(){const t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),I.forEach((e=>l.addEventListener(e,t.listener,!0))))},t.prototype.stop=function(){const t=this;this.stopped||(this.observer&&this.observer.disconnect(),I.forEach((e=>l.removeEventListener(e,t.listener,!0))),this.stopped=!0)},t}()),z=function(t){!S&&t>0&&F.start(),S+=t,!S&&F.stop()},T=function(){function t(t,e){this.target=t,this.observedBox=e||s.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return t.prototype.isActive=function(){const t=v(this.target,this.observedBox);var e;return e=this.target,n(e)||function(t){switch(t.tagName){case"INPUT":if("image"!==t.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)||"inline"!==getComputedStyle(e).display||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},t}(),D=function(t,e){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=t,this.callback=e},R=new Map,M=function(t,e){for(let i=0;i<t.length;i+=1)if(t[i].target===e)return i;return-1},B=function(){function t(){}return t.connect=function(t,i){const s=new D(t,i);e.push(s),R.set(t,s)},t.observe=function(t,e,i){if(R.has(t)){const s=R.get(t);M(s.observationTargets,e)<0&&(s.observationTargets.push(new T(e,i&&i.box)),z(1),F.schedule())}},t.unobserve=function(t,e){if(R.has(t)){const i=R.get(t),s=M(i.observationTargets,e);s>=0&&(i.observationTargets.splice(s,1),z(-1))}},t.disconnect=function(t){if(R.has(t)){const i=R.get(t);e.splice(e.indexOf(i),1),R.delete(t),z(-i.observationTargets.length)}},t}(),L=function(){function t(t){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof t)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");B.connect(this,t)}return t.prototype.observe=function(t,e){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!r(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");B.observe(this,t,e)},t.prototype.unobserve=function(t){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!r(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");B.unobserve(this,t)},t.prototype.disconnect=function(){B.disconnect(this)},t.toString=function(){return"function ResizeObserver () { [polyfill code] }"},t}();"ResizeObserver"in t&&"ResizeObserverEntry"in t||(t.ResizeObserver=L,t.ResizeObserverEntry=b)}(window);const d=function(){const t=/(auto|scroll)/,e=(t,i)=>null===t.parentNode?i:e(t.parentNode,i.concat([t])),i=(t,e)=>getComputedStyle(t,null).getPropertyValue(e),s=(e,s)=>t.test(((t,e)=>i(t,e?`overflow-${e}`:"overflow"))(e,s));return(t,i)=>{if(!(t instanceof HTMLElement||t instanceof SVGElement))return;const o=e(t.parentNode,[]);for(let t=0;t<o.length;t+=1)if(s(o[t],i))return o[t];return document.scrollingElement||document.documentElement}}();!function(n){n.videoImgFallback=t,n.getCookie=e,n.setCookie=i,n.deleteCookie=s,n.getJsonFromUrl=o,n.chunkSplit=a,n.freezeVp=r,n.preventBodyScrolling=l,n.scrollParent=d}(window);class c{on(t,e){}one(t,e){}off(t,e){}emit(t,...e){}constructor(){!function(t){"object"!=typeof t&&(t=this);const e={_JQInit(){this._JQ=$({})},emit(t,e){return this._JQ||this._JQInit(),this._JQ.trigger(t,e),this},one(t,e){return this._JQ||this._JQInit(),this._JQ.one(t,e),this},on(t,e){return this._JQ||this._JQInit(),this._JQ.on(t,e),this},off(t,e){return this._JQ||this._JQInit(),this._JQ.off(t,e),this}};Object.keys(e).forEach((i=>{t[i]=e[i].bind(t)}))}(this)}}var h=new class extends c{init(){}};function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function p(){return(p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}const m=2560,f={avif:null,webp:null};function g(){var t;const e="object"==typeof flexbe_cli&&(null==(t=flexbe_cli.vars)?void 0:t._group.images)||{};return{avif_support:f.avif||e.avif_support,webp_support:f.webp||e.webp_support,avif:!1,webp:!1,slow_network:!1,quality_map:{jpg:70,webp:70,avif:55}}}async function v(t){try{const e=new Image;return"decode"in e?(e.src=t,await e.decode(),!0):await new Promise((i=>{e.onload=()=>i(!0),e.onerror=()=>i(!1),e.src=t}))}catch(t){return!1}}async function b(t){return new Promise(((e,i)=>{const s=new Image,o=()=>{e(s),setTimeout((()=>{"function"==typeof s.remove&&s.remove()}),10)};"decode"in s&&!/\.svg/.test(t)?(s.src=t,s.decode().then(o).catch(i)):(s.onerror=i,s.onload=o,s.src=t)}))}function w(t){if("string"!=typeof t)return t;t=t.replace(/(\/img\/[\d_q]+)\/[\w-]+(\.\w{3,4})/i,"$1$2");let[,e,i,s,o]=t.match(/\/img\/(\d+)_?(\d+)?_?q?(\d+)?\.(\w{3,4})/i)||[];return i=i?+i:0,s=s?+s:"none",{id:e,ext:o,name:`${e}.${o}`,size:i,quality:s}}function y(t,e){const i=e.avif_support,s=e.webp_support,o=e.avif,n=e.webp;let a=t.ext;return i&&o?a="avif":s&&n?a="webp":"webp"===t.ext&&(a=s?"webp":t.transparent?"png":"jpg"),a}function _(t,e,i){var s;i=p({},g(),i);const{id:o,ext:n}=t;if(!o)return"";e||"webp"!==t.ext||i.webp_support||(e=Math.min(t.width||m,m));const a=null!=(s=t.animated)?s:"gif"===n,r=`/img/${o}.${n}`;if(!e||a||"svg"===n)return r;const l=y(t,i),d=i.slow_network&&S();let c=i.quality_map;switch(d&&(c={jpg:50,webp:50,avif:45}),l){case"png":return`/img/${o}_${e}.png`;case"avif":case"webp":case"jpg":return`/img/${o}_${e}_q${c[l]}.${l}`;case"gif":default:return r}}function x(t){if("string"==typeof t&&(t=w(t)),!t||"object"!=typeof t)return{};let e=t.img_ext||t.ext;const i=t.img_id||t.id,s=t.img_name||t.name;e&&"false"!==e||(e=s?function(t){const e=String(t).match(/\.(jpg|jpeg|png|gif|svg|bmp|webp)$/i);return e&&e[1]?e[1]:""}(s):"jpg");const o=t.img_border||t.border;return{id:i,ext:e,average:function(t){return"transparent"!==t?t:"#000000"}(t.img_average||t.average),preview:t.img_preview||t.preview||"",width:t.img_width||t.width||0,height:t.img_height||t.height||0,proportion:+(+t.img_proportion||+t.proportion||0).toFixed(2),border:o,animated:t.img_animated||t.animated||"gif"===e,transparent:t.img_transparent||t.transparent||0}}function A(t,e=0,i){return _(x(t),"number"==typeof e?Math.round(e):e,i)}async function C(t){let e=t,i=+t.proportion;if(i&&(i<2||i<5&&i%1>0)&&(i*=100),"string"==typeof e||!i){"object"==typeof e&&(e=A(t,50));const s=await b(e);i=s.naturalHeight/s.naturalWidth*100}return i}function S(){var t;return"4g"!==((null==(t=navigator.connection)?void 0:t.effectiveType)||"4g")}async function k(t,e,i){i=p({},g(),i);const s=t.width||0,o=t.img_scale||t.scale||"cover",n=t.img_type||t.type||"background",a=e.height/e.width,r=await C(t)/100,l=i.slow_network&&S()?Math.min(1.5,window.devicePixelRatio):Math.min(2,window.devicePixelRatio),d=y(t,i);let c,h;return"image"===n||a>r&&"contain"===o||a<r&&"cover"===o?(c=e.width,h=c*r):(h=e.height,c=h/r),l>1&&(c*=l,h*=l),i.sizes&&(c=function(t,e){let i=(e=e.sort(((t,e)=>e-t)))[0];return e.forEach((e=>{t<i&&t<=e&&(i=e)})),i}(c,i.sizes),h=c*r),c<=150&&/webp|jpg/.test(d)&&(c=c/l*2,h=c*r),s&&c>s&&(c=s,h=c*r),c>m&&(c=m,h=c*r),{width:Math.ceil(c),height:Math.ceil(h)}}var I=Object.freeze({__proto__:null,resolveImageSupports:async function(){return null!=f.avif||(f.avif=await v("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=")),null!=f.webp||(f.webp=await v("data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA")),f},checkFormatSupport:v,preloadImage:b,parseImageUrl:w,getImage:x,getImageUrl:A,getImageProportion:C,getImageOptimalSize:k,createUrl:_});var E={init(){const t=document.getElementById("flexbe-globals");try{const e=JSON.parse(t.getAttribute("data-store"));Object.assign(this,e),t.parentNode.removeChild(t)}catch(t){}}};function F(t,e){let i=["screen"];return null!=t&&i.push(`(min-width: ${t}px)`),null!=e&&i.push(`(max-width: ${e}px)`),i=i.join(" and "),window.matchMedia(i).matches}const z={async init(){this.deviceInfo(),this.applyClasses(),await this.supportsInfo(),$(window).on("resize.deviceInfo",(()=>{this.deviceInfo()})),$(window).on("resized.deviceInfo",(()=>{this.applyClasses()}))},async supportsInfo(){const t=flexbe_cli.vars._group.images||{},[e,i]=await Promise.all([t.webp_support||v("data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"),t.avif_support||v("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=")]);t.webp_support=e,t.avif_support=i},deviceInfo(){var t,e;const i=null==(t=window.CSS)?void 0:t.supports("zoom",1),s=navigator.userAgent.toLowerCase();this.is_responsive=!!flexbe_cli.vars._page.responsive,this.is_screen_mobile=F(0,767),this.is_screen_mobile_scaled=i&&F(0,399),this.is_screen_desktop=F(768,1e4),this.is_screen_desktop_scaled=i&&F(768,1279),this.is_touch=window.matchMedia("(any-pointer: coarse)").matches,this.is_pointer=window.matchMedia("(any-hover: hover)").matches,this.is_tablet=/ipad|xoom|kindle|playbook|tablet/i.test(s),this.is_mobile=!this.is_tablet&&-1!==s.indexOf("mobile"),this.is_desktop=!this.is_mobile&&!this.is_tablet,this.is_chrome=/(chromium|chrome)\/(\d+)/.test(s),this.is_safari=-1!==s.indexOf("safari")&&(null==(e=s.match(/version\/(\d+)/))?void 0:e[1]),this.is_firefox=-1!==s.indexOf("firefox"),this.is_mobile_ie=-1!==s.indexOf("iemobile"),this.is_ie=-1!==s.indexOf("trident")||-1!==s.indexOf("msie"),this.is_EDGE=-1!==s.indexOf("edge"),this.is_OSX=/ipad|iphone|ipod|macintosh/gi.test(s),this.is_android=-1!==s.indexOf("android"),this.is_ios=this.is_OSX&&this.is_touch&&!this.is_desktop,this.is_bot=/bot|aolbuild|bingpreview|msnbot|baidu|duckduckgo|mediapartners-google|teoma|slurp/gi.test(s),this.is_instagram=/instagram/i.test(s),this.is_mobile&&this.is_touch?this.device_type="mobile":this.is_tablet&&this.is_touch?this.device_type="tablet":this.device_type="desktop"},applyClasses(){const t=$(document.body);t.toggleClass("is-mobile",z.is_mobile),t.toggleClass("is-tablet",z.is_tablet),t.toggleClass("is-desktop",z.is_desktop),t.toggleClass("is-pointer",z.is_pointer),t.toggleClass("is-touch",z.is_touch),t.toggleClass("is-ios",!!z.is_ios),t.toggleClass("is-android",z.is_android),t.toggleClass("is-osx",z.is_OSX&&z.is_desktop),t.toggleClass("is-safari",!!z.is_safari),z.is_safari&&t.addClass(`is-safari-${z.is_safari}`),t.toggleClass("is-edge",z.is_EDGE),t.toggleClass("is-firefox",z.is_firefox),t.toggleClass("is-chrome",z.is_chrome),t.toggleClass("is-instagram",z.is_instagram)}};let T;var D=new class{constructor(){u(this,"containerWidth",null),u(this,"oldWidth",null),u(this,"oldHeight",null),u(this,"resizeLocked",!1),u(this,"deviceWidth",null),u(this,"deviceHeight",null),u(this,"width",null),u(this,"height",null),u(this,"zoom",1)}get viewportWidth(){return Math.round(this.width/this.zoom)}get viewportHeight(){return Math.round(this.height/this.zoom)}init(){this.simulateWindowResized(),this.simulateDocumentResize(),this.updateSizes(),this.watchContainerSize(),this.applySizeVariablesOnResize()}trigger(t,e=window){$(e).trigger(t)}toggleMobileView(t){const e=t?400:document.documentElement.clientWidth,i=document.documentElement.clientHeight;this.lockResizeEvent(t),this.updateSizes({width:e,height:i}),this.trigger("resize"),this.trigger("resized")}lockResizeEvent(t){this.resizeLocked=t}updateSizes({width:t,height:e}={}){var i;const s=document.documentElement,o=s.clientWidth,n=s.clientHeight,a=null!=(i=this.scrollbarWidth)?i:window.innerWidth-o;if(null!=t||(t=this.resizeLocked?this.width:o),null!=e||(e=this.resizeLocked?this.height:n),this.oldWidth=this.deviceWidth,this.oldHeight=this.deviceHeight,this.scrollbarWidth=a,this.deviceWidth=o,this.deviceHeight=n,this.width=t,this.height=e,this.zoom=1,this.responsiveMode=z.is_responsive&&t<=767?"mobile":"desktop",!flexbe_cli.is_admin&&z.is_desktop&&("desktop"===this.responsiveMode&&z.is_screen_desktop_scaled||"mobile"===this.responsiveMode&&z.is_screen_mobile_scaled)){const e=z.is_screen_desktop_scaled?1280:400;this.zoom=t/e}}applySizeVariablesOnResize(){const t=$(document.documentElement),e=$(document.body),i=()=>{let i=this.viewportHeight;const s=z.is_desktop||flexbe_cli.is_admin?10:200;(flexbe_cli.is_admin||flexbe_cli.is_service)&&"mobile"===this.responsiveMode&&(i=Math.min(700,i)),t.css("--100vw",`${this.viewportWidth}px`),t.css("--100vh",`${this.viewportHeight}px`),t.css("--zoomLevel",`${this.zoom}`),t.css("--scrollbarWidth",`${this.scrollbarWidth}px`),(!this.coverHeight||Math.abs(this.coverHeight-i)>s)&&(this.coverHeight=i,t.css("--coverHeight",`${i}px`)),e.toggleClass("adaptive-mobile","mobile"===this.responsiveMode),e.toggleClass("adaptive-desktop","desktop"===this.responsiveMode)};i(),z.is_ios&&setTimeout((()=>i()),150),$(window).on("resized.setVars",(()=>i()))}watchContainerSize(){const t=()=>{const t=document.createElement("div");t.classList.add("container"),requestAnimationFrame((()=>{document.body.appendChild(t),this.containerWidth=t.offsetWidth,document.body.removeChild(t)}))};t(),$(window).on("resized.setContainer",(()=>t()))}simulateWindowResized(){let t,e=this.oldWidth,i=this.oldHeight;$(window).on("resize orientationchange",(s=>{s.originalEvent&&(this.updateSizes(),clearTimeout(t),t=setTimeout((()=>{this.oldWidth=e,this.oldHeight=i,e=this.deviceWidth,i=this.deviceHeight,this.trigger("resized")}),80))}))}simulateDocumentResize(){requestAnimationFrame((()=>{this.documentHeight=document.body.offsetHeight}));const t=flexbe_cli.is_admin?500:150,e=(t=0)=>{const e=document.body.offsetHeight;Math.abs(e-this.documentHeight)>=5&&(this.documentHeight=e,this.trigger("documentresize",document),clearTimeout(T),T=setTimeout((()=>{this.trigger("documentresized",document)}),t))};if("function"==typeof ResizeObserver){let i=!0;new ResizeObserver((()=>{i?i=!1:e(t)})).observe(document.querySelector("body"))}else setInterval((()=>{e(0)}),t)}};const R=[];function M(t="",e=(()=>{}),i=15e3,s=!1){if(t&&0!==t.length||e(!1),!s){"string"==typeof t&&(t=[t]);let s=0;const o=i=>{const o=t.every((t=>"boolean"==typeof R[t]));s+=1,o&&s===t.length&&e(i)};return Array.isArray(t)&&t.forEach((t=>{M(t,o,i,!0)})),!1}if(!0===R[t])e(!0);else if(Array.isArray(R[t]))R[t].push(e);else{let s,o=!1;const n=(e=!0)=>{if(o)return;o=!0,clearTimeout(s);const i=R[t];R[t]=e,i.forEach((t=>{"function"==typeof t&&t(e)}))};if(R[t]=[e],/\.css(\?.*)?$/.test(t)){const e=document.createElement("link");e.onerror=n.bind(this,!1),e.onload=n.bind(this,!0),s=setTimeout(n.bind(this,"timeout"),i),e.rel="stylesheet",e.href=t,document.body.appendChild(e)}else{const e=document.createElement("script");e.onload=n.bind(this,!0),e.onerror=n.bind(this,!1),s=setTimeout(n.bind(this,"timeout"),i),e.async=!0,e.src=t,document.body.appendChild(e)}}}const B={inScroll:!1,skip:!1,_latest:null,get latest(){return this._latest/D.zoom},init(){requestAnimationFrame((()=>{this._latest=window.pageYOffset})),document.addEventListener("mousewheel",(()=>{this.$inScrollElement&&(this.$inScrollElement.stop(),this.$inScrollElement=null)}),{passive:!0}),document.addEventListener("scroll",(()=>{this.inScroll=!0,this._latest=window.scrollY}),{passive:!0}),document.addEventListener("scrollend",(()=>{this.inScroll=!1}),{passive:!0}),this.scrollLock.init(),this.scrollImprovement.init()},scrollImprovement:{scrollTimer:0,pointerState:!1,init(){this.createStopScrollEvent(),this.scrollRestore()},createStopScrollEvent(){let t=B.latest;document.addEventListener("scroll",(()=>{const e=t>B.latest?"up":"down",i=Math.max(B.latest-t,t-B.latest);clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout((()=>{t=B.latest,document.dispatchEvent(new CustomEvent("scrollend",{detail:{direction:e,distance:i}}))}),200)}),{passive:!0})},scrollRestore(){window.history.scrollRestoration&&(window.history.scrollRestoration="auto")}},scrollLock:{loaded:!1,locked:!1,init(){this.loaded||M(["/_s/lib/scroll-lock/scroll-lock.min.js?fix"],(()=>{this.loaded=!0,window.scrollLock._state.lockableSelectors=["html","[data-scroll-lock-lockable]"],window.scrollLock._state.scrollableSelectors=["[data-scroll-lock-scrollable]",".scroller",".scrollable"],window.scrollLock._state.fillGapSelectors=["html","[data-scroll-lock-lockable]","[data-scroll-lock-fill-gap]"],this.locked&&(window.scrollLock.disablePageScroll(),D.trigger("resized"))}))},lock(){this.locked=!0,void 0!==window.scrollLock&&(window.scrollLock.disablePageScroll(),D.trigger("resized"))},unlock(){this.locked=!1,void 0!==window.scrollLock&&(window.scrollLock.clearQueueScrollLocks(),window.scrollLock.enablePageScroll(),D.trigger("resized"))}},to(t){document.scrollingElement.scrollTo(0,t)},toElement(t,e={}){const i=$(t);if(!(t=i[0]))return!1;null==e.animation&&(e.animation=!0),null==e.centered&&(e.centered=!0),null==e.force&&(e.force=!0);let s,o=0,n=0,a=window.scrollParent(t,"y");a&&!$(a).is(".b_block, .container-list")||(a=document.scrollingElement);const r=e.padding||0,l=a===document.body||a===document.documentElement,d=l?flexbe_cli.resize.viewportHeight:a.offsetHeight,c=i.offset().top,h=t.offsetHeight,u=l?$("html, body"):$(a);z.is_mobile?s=u.find(".menu-fixed > .nav-header"):4===flexbe_cli.theme_id?n=flexbe_cli.fixed.getAllFixedHeight(c):s=u.find('.floating[data-floating="true"]'),s&&s.length&&(n+=s[0].offsetHeight-2);const p=Math.max(0,d-n-h);if(h>=d&&(e.centered=!1),o=e.centered?c-Math.max(0,p/2)-n:c-r-n,e.offset&&(o+=e.offset),!e.force){const t=a.offsetTop,s=i[0].getBoundingClientRect();if(s.top>=t&&s.bottom<=t+d)return"function"==typeof e.complete&&e.complete(),!1}this.$inScrollElement=u,$(document).off("documentresize.scrollTo").on("documentresize.scrollTo",(()=>{this.toElement(t,e)})),u.stop(),u.animate({scrollTop:o},{delay:e.delay||0,duration:e.duration?e.duration:e.animation?450:0,easing:e.animation?"swing":"linear",always:(...t)=>{this.$inScrollElement=!1,$(document).off("documentresize.scrollTo"),"function"==typeof e.complete&&e.complete(...t)}})}};function L(t,e=!1){const i=$(t).eq(0);if(i.length&&(e||i.is(":hidden"))){const t=new Event("bringIntoView",{bubbles:!0,cancelable:!0});i[0].dispatchEvent(t)}}function P(t,e=!1){const i=window.parent||window;if(!t)return console.warn("WRONG ACTION","empty_link"),void(flexbe_cli.is_admin&&h.emit("editor_page_error",{type:"action",error:"link_is_wrong"}));flexbe_cli.is_admin?h.emit("editor_leave_page",{href:t}):i.location.host===window.location.host?e?i.open(t,"_blank"):i.location.href=t:window.location.href=t}function V(t="",e=!1){if("string"!=typeof t)return!1;if(!/#{1,2}.+/.test(t))return P(t,e),!0;{4===flexbe_cli.theme_id&&$('nav[data-opened="true"]').length&&h.emit("ui_mobilemenu_close",{}),4!==flexbe_cli.theme_id&&$(".mobile-menu.show").length&&$(".mobile-menu").removeClass("show").trigger("close");const e=(t=t.replace(/^\.\/#{2}/,"#").trim()).trim().split("#"),i=e[e.length-1];if(!(""===e[0]||"./"===e[0]||e[0]===window.location.pathname))return P(t),!0;const s=$(`._anchor[name="${i}" i]`),o=s.length?s.closest("[data-id]"):$(`[data-id="${i}" i]`),n=o.closest(".b_block"),a=o.closest(".m_modal");if("cart"===i)h.emit("ui_modal_close",{}),h.emit("ui_cart_open",{});else if(n.length)L(s.length?s:o),h.emit("ui_cart_close",{}),h.emit("ui_modal_close",{}),setTimeout((()=>{let t=n;if(o&&!n.is(o)){const e=n.offset().top;o.offset().top-e>D.viewportHeight-100&&(t=o)}B.toElement(t)}),30),window.history.replaceState(null,null,`#${i}`);else if(a.length){const t=a.data("id");L(s.length?s:o),h.emit("ui_cart_close",{}),h.emit("ui_modal_open",{id:t})}else window.history.replaceState(null,null,`#${i}`),flexbe_cli.is_admin&&h.emit("editor_page_error",{type:"action",error:"anchor_is_wrong"})}}if(window.parent===window&&/mode=/.test(window.location.search)){const t=window.location.href.replace(/mode=\w+/,"").replace(/\?&/,"?").replace(/\?$/,"");window.history.replaceState(null,null,t)}function O(){flexbe_cli.lockPopstate||(flexbe_cli.lockPopstate=!0,/^#/.test(window.location.hash)?V(window.location.hash):Object.keys(flexbe_cli.modal.opened).length&&h.emit("ui_modal_close"),flexbe_cli.lockPopstate=!1)}const H={};function W(t,e={},i=100){const s="object"==typeof t?t:document.querySelector(`[data-id="${t}"]`),o=null==s?void 0:s._core;if(o){const t=o.id;if(H[t])return;requestAnimationFrame((()=>o.updateTween(p({force:!0},e)))),H[t]=setTimeout((()=>{delete H[t]}),i)}}var q={strings:Object.freeze({__proto__:null,htmlSpecialChars:function(t,e=!1){return t&&"string"==typeof t?([["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"]].forEach((([i,s])=>{const o=e?s:i,n=e?i:s;t=t.replace(new RegExp(o,"g"),n)})),t):t}}),image:I,entity:Object.freeze({__proto__:null,forceUpdateTween:W})},N={init(){this.lg.init()},lg:{init(){const t=".lg-container, .b_block, .m_modal, .w_widget",e="[data-lg]";let i;this.isOpen=!1,this.isOpened=!1,$(window).one("load.lightbox",(()=>{this.loaded||this.require()}));let s={};$(document).off(".lightbox"),$(document).on("click.lightbox",e,(t=>{t.preventDefault()})),$(document).on("touchstart.lightbox pointerdown.lightbox",e,(t=>{var e,o;flexbe_cli.is_admin||(t.preventDefault(),t.stopPropagation(),i=t.target,s={x:null!=(e=t.clientX)?e:t.touches[0].clientX,y:null!=(o=t.clientY)?o:t.touches[0].clientY})})),$(document).on("touchend.lightbox pointerup.lightbox",e,(o=>{var n,a;const r=i===o.target,l=null!=(n=o.clientX)?n:o.changedTouches[0].clientX,d=null!=(a=o.clientY)?a:o.changedTouches[0].clientY,c=Math.sqrt((s.x-l)**2+(s.y-d)**2)<5;if(!r||!c)return;const h=$(o.currentTarget).find("a"),u=h.closest(t),p=h.attr("href"),m="1"===h.closest("[data-loop]").attr("data-loop"),f=!u.attr("data-lg-single"),g=u.find(e).filter(((e,i)=>{const s=$(i).closest(t),o=s.is(u),n=s.closest(".swiper-slide-duplicate").length;return o&&!n})).toArray().map((t=>{let e;const i=$(t),s=i.attr("href")||i.find("[href]").attr("href"),o=i.attr("data-sub-html");if(o){e=i.find(o).html()}else e=i.attr("alt")||i.find("img").attr("alt")||"";return m&&i.closest("[data-cloned]").length?null:{src:s,subHtml:e}})).filter((t=>t&&t.src)),v=g.findIndex((t=>t.src===p))||0;this.openGallery({index:v,dynamicEl:g,enableSlide:f,loop:m})})),$(window).on("popstate.lightbox",(()=>{const t=window.history.state||{};t.lg?this.openGallery(t.lg):this.closeGallery()})),window.history.state&&window.history.state.lg&&this.openGallery(window.history.state.lg)},openGallery(t={}){if(0===t.dynamicEl.length||this.isOpened)return;this.isOpened=!0,this.$lg=$("<div/>");const e=this.$lg,i=p({index:0,dynamicEl:[],dynamic:!0,subHtmlSelectorRelative:!0,getCaptionFromTitleOrAlt:!0,slideEndAnimation:!1,swipeThreshold:30,counter:!0,closable:!0,download:!1,easing:"ease-out",hideBarsDelay:1e3,zoomIcons:!1,actualSize:!1,enableSlide:!0,loop:!0},t);function s(){const t=window.history.state,e=i;flexbe_cli.lockPopstate=!0,t&&t.lg?window.history.replaceState({lg:e},null,`#image-${e.index+1}`):window.history.pushState({lg:e},null,`#image-${e.index+1}`),flexbe_cli.lockPopstate=!1}i.index<=0&&(i.index=0),this.require((()=>{e.lightGallery(i)})),e.on("onBeforeOpen.lg",(()=>{this.isOpen=!0,s()})),e.on("onBeforeClose.lg",(()=>{window.history.state&&window.history.state.lg&&(flexbe_cli.lockPopstate=!0,window.history.back(),setTimeout((()=>{flexbe_cli.lockPopstate=!1}),20)),this.isOpen=!1})),e.on("onBeforeSlide.lg",((t,e,o)=>{i.index=o,s()}))},closeGallery(){const t=this.$lg&&this.$lg.data("lightGallery");this.isOpened=!1,t&&t.destroy()},require(t){$("[data-lg]").length&&M(["/_s/lib/jquery/lightGallery/css/lightgallery.min.css?2","/_s/lib/jquery/lightGallery/js/lg-spaced-bundle.min.js?1"],(()=>{this.loaded||(this.loaded=!0,$(document).off("click.beforeLoadedLg")),"function"==typeof t&&t()}))}}};function j(t="",e={}){return new Promise(((i,s)=>{$.ajax(p({url:t,type:e.type||e.method||"POST",dataType:"json"},e)).done((t=>{if(null!=t.status&&!t.status||null!=t.is_success&&!t.is_success){const e=new Error(t.message);e.data=t,s(e)}else i(t)})).fail((t=>{const e=t.responseJSON,i=e?new Error(e.message):t;i.status=t.status,i.data=e,s(i)}))}))}let G;const Y={get u_id(){return localStorage.getItem("f_uid")||0},set u_id(t){return localStorage.setItem("f_uid",t)},time:0,goals:{quiz:"quiz_start",modal:"modal_open",modal_form:"form_open",modal_done:"done_open",modal_product:"product_show",order_done:"order_done",pay_done:"pay_done",cart:"add_to_cart",link:"link_open",file:"file_load",close:"modal_close",app_link:"app_link_open"},init(){this.reach_goal=this.reachGoal;const t=window.getCookie("user_id");if(flexbe_cli.is_admin||flexbe_cli.is_service||flexbe_cli.run.is_bot||!flexbe_cli.p_id||t)return!1;const{delayed_counters_ms:e}=flexbe_cli.vars._group.optimization;setTimeout((()=>{this.initStat()}),e)},initStat(){const t=window.getCookie("f_uid")||Y.u_id;t?(Y.u_id=t,async function(){try{const t=await j("/mod/stat/visit/",{data:{s_id:flexbe_cli.s_id,group_id:flexbe_cli.group_id,p_id:flexbe_cli.p_id,u_id:Y.u_id}});t.v_id||console.warn("Visit was not registered",t)}catch(t){console.error("Visit was not registered",t)}}()):async function(){try{const t=await j("/mod/stat/",{data:{s_id:flexbe_cli.s_id,group_id:flexbe_cli.group_id,p_id:flexbe_cli.p_id,utm_data:U(),device:{type:flexbe_cli.run.device_type,width:flexbe_cli.resize.viewportWidth,height:flexbe_cli.resize.viewportHeight,dpi:window.devicePixelRatio,browser:navigator.userAgent}}});window.setCookie("f_uid",t.u_id,{Path:"/"}),Y.u_id=t.u_id,h.emit("user_created")}catch(t){console.warn("Cookie visit not created",t)}}(),this.AB.init(),this.ecommerce.init(),this.QUIZ.init()},getGoal(t,e){return"modal"===t&&(/form/.test(e)?t="modal_form":/done/.test(e)?t="modal_done":/product/.test(e)?t="modal_product":/quiz/.test(e)&&(t="quiz")),this.goals[t]||!1},reachGoal(t,e={}){if(!flexbe_cli.is_admin){e=p({goalAction:"send",goalValue:""},e),h.emit("reach_goal",t,e);try{"object"==typeof Ya&&"object"==typeof Ya._metrika.counter&&Ya._metrika.counter.reachGoal(t,e),"function"==typeof ga&&ga("send",{hitType:"event",eventCategory:t,eventAction:e.goalAction,eventLabel:e.goalValue})}catch(t){console.warn("stat.js",t)}}},reachGoals(t={},e={}){const i=`${t.goal||""}`.trim(),s=`${t.mainGoal||""}`.trim(),o=`${t.htmlGoal||""}`.trim();if(s&&this.reachGoal(s,e),i)try{this.reachGoal(i,e)}catch(t){console.warn("reachGoals [goal]: ",t.message)}if(o)try{let t=$(o)[0].outerHTML;if(t){t=t.replace(/{{\s*goalAction\s*}}/g,e.goalAction||""),t=t.replace(/{{\s*goalValue\s*}}/g,e.goalValue||""),t=t.replace(/(["']?){{\s*goalParams\s*}}\1/g,JSON.stringify(e.goalParams||{}));const i=document.write;document.write=function(t){$("body").eq(0).append(t)};const s=$(`<div style="display:none">${t}</div>`);$("body").eq(0).append(s),setTimeout((()=>{s.remove()}),2e3),clearTimeout(G),G=setTimeout((()=>{document.write=i}),1e4)}}catch(t){console.warn("reachGoals [htmlGoal]: ",t.message)}},ecommerce:{inited:!1,init(){this.inited=!0,window.dataLayer||(window.dataLayer=[])},add(t){this.inited||this.init(),window.dataLayer.push({ecommerce:{currencyCode:flexbe_cli.locale.currency.code,add:{products:[this._normalizeItem(t)]}}})},remove(t){this.inited||this.init(),window.dataLayer.push({ecommerce:{currencyCode:flexbe_cli.locale.currency.code,remove:{products:[this._normalizeItem(t)]}}})},purchase(t,e=!1){if(t||0!==t.length){this.inited||this.init(),e||(e=Math.ceil(1e4*Math.random()));try{window.dataLayer.push({ecommerce:{currencyCode:flexbe_cli.locale.currency.code,purchase:{actionField:{id:e},products:t.map((t=>this._normalizeItem(t)))}}})}catch(t){}}},_normalizeItem(t){var e,i,s;return{id:t.id,name:t.name||t.title,price:null!=(e=t.price)?e:t.orderPrice,brand:null!=(i=t.brand)?i:t.vendorCode,variant:t.optionsInfo?t.optionsInfo.map((t=>t.name)).join(", "):"",quantity:null!=(s=t.count)?s:t.quantity}}},AB:{proccess:{},init(){flexbe_cli.block.$blocks.each(((t,e)=>{if(!e._core)return;const{wasView:i,abtestId:s,abtestVariant:o}=e._core;i&&o&&this.fixView(s,o)})),h.off("entity_event.abstat").on("entity_event.abstat",((t,{type:e,core:i,params:s})=>{if(!i||"onView"!==e||!s.state||!s.first)return;const{abtestId:o,abtestVariant:n}=i;n&&this.fixView(o,n)}))},setCookie(t){window.setCookie("f_ab",JSON.stringify(t),{expires:604800,path:"/",domain:document.location.hostname})},getCookie(){let t=window.getCookie("f_ab");if(t)try{t=JSON.parse(decodeURIComponent(t))}catch(t){console.warn("Can`t parse abtest cookie",t)}return t||(t={view:{},lead:[]}),t},async fixView(t,e){if(null==t||null==e||"a"!==e&&"b"!==e)return!1;if(null==this.getCookie().view[t]&&!this.proccess[t]){this.proccess[t]=!0;try{await j("/mod/stat/abtest/",{data:{testId:t,variant:e,s_id:flexbe_cli.s_id,p_id:flexbe_cli.p_id}});const i=this.getCookie();i.view[t]=e,this.setCookie(i)}catch(t){console.error("Can't fix abtest",t)}this.proccess[t]=!1}}},QUIZ:{inited:!1,init(){this.inited||(this.inited=!0,h.on("quiz_event.stat",((t,e={})=>{const i=e.payload||{};if(!["step","submit"].includes(e.event))return;if("step"===e.event&&!i.toNext)return;const s=e.quiz,o=e.answerGoals,n=e.resultGoals,a=s.core.id,r=i.fromAnswers||[],l=i.toId,d=i.sessionId,c=i.fromId,h=r.reduce(((t,e)=>t.concat((e.variants||[]).map((t=>t.id)))),[]);if(this.fixAnswer({sessionId:d,sectionId:a,answerStep:c,answerVariants:h,viewStep:l}),o){const t="answer";r.forEach((e=>{if(e.variants&&e.variants.length)e.variants.forEach((e=>{const i=e.value;Y.reachGoals(o,{goalAction:t,goalValue:i})}));else{let i=e.value||"";["email","phone","name"].includes(e.type)&&(i=""),Y.reachGoals(o,{goalAction:t,goalValue:i})}}))}n&&Y.reachGoals(n)})))},fixAnswer({sectionId:t,sessionId:e,answerStep:i,viewStep:s,answerVariants:o}){let n;function a(){return j(n,{data:{s_id:flexbe_cli.s_id,group_id:flexbe_cli.group_id,f_uid:Y.u_id,page_id:flexbe_cli.p_id,session_id:e,section_id:t,answer_step:i,answer_variants:o,view_step:s}})}s&&i?n="/mod/quiz/stat/save/composite/":i?n="/mod/quiz/stat/save/answer/":s&&(n="/mod/quiz/stat/save/view/"),n&&(Y.u_id?a():h.one("user_created",(()=>{a()})))}}};function U(){const t=function(t){if(""===t)return{};const e={};for(let i=0;i<t.length;++i){const s=t[i].split("=");2===s.length&&(e[s[0]]=decodeURIComponent(s[1].replace(/\+/g," ")))}return e}(window.location.search.substr(1).split("&")),e={};return $.each(t,((t,i)=>{"utm_"===t.substring(0,4)&&(e[t]=i)})),document.referrer&&(e.url=document.referrer),e}const Q=(t,e=2,i=",",s=".")=>{let o,n;Number.isNaN(e=Math.abs(e))&&(e=2),o=`${parseInt(t=(+t||0).toFixed(e),10)}`,(n=o.length)>3?n%=3:n=0;return(n?o.substr(0,n)+s:"")+o.substr(n).replace(/(\d{3})(?=\d)/g,`$1${s}`)+(e?i+Math.abs(t-o).toFixed(e).replace(/-/,"0").slice(2):"")},X=p({language:"en",country:"US",currency:{code:"USD",symbol:"$"},date_format:{dateLiteral:"/",dateMask:"DD/MM/YYYY",firstDay:1,dateTimeLiteral:", ",hour12:!1,timeLiteral:":",timeMask:"HH:MM"},translation:{},currency_format:{},init(t="body"){$("[data-lang]",t).each(((t,e)=>{const i=$(e).attr("data-lang"),s=String(this.tr(i));$(e).html(s)}))},tr(t,e){if(!t)return"";const i=/^currency/.test(t)?this.currency:this.translation,s=String(t).replace(/^currency\./,"").split(/\.|:{2}/).reduce(((t,e)=>t&&t[e]),i)||"";return s?this.interpolate(s,e):t},interpolate(t,e={}){const i=t=>{const e=t%100,i=e%10;return 11!==e&&1===i?"one":i>=2&&i<=4&&!(e>=12&&e<=14)?"few":"many"},s=t=>1!==t?"other":"one",o=t=>1===t?"one":t>=2&&t<=4?"few":"many",n={en:s,by:i,cs:o,cz:o,cs_CZ:o,fr:t=>t>1?"other":"one",ge:s,de:s,it:s,kz:i,pl:t=>{if(1===t)return"one";const e=t%10;return e>=2&&e<=4&&(t%100<10||t%100>=20)?"few":"many"},pt:s,ro:s,ro_RO:s,ru:i,es:s,ua:i,lv:t=>{var e;return 0===t?"zero":(null!=(e=t%10==1)?e:t%100==11)?"one":"other"}};return Object.keys(e).forEach((i=>{if("_"!==i&&e.hasOwnProperty(i)){if(t instanceof Object){const s=e[i];t=t[n[X.language](s)]}t=t.replace(new RegExp(`%${i}%`,"g"),e[i])}})),t},parseMoney(t,e=2){const i=(t=String(t).replace(/,/g,".").replace(/ /g,"").replace(/(?!^)-/g,"").replace(/^\./g,"0.")).replace(/[^\d.]/g,"");let s=((i.match(new RegExp(`\\.\\d{1,${e}}$`))||[])[0]||"").replace(/\D/g,""),o=i.replace(new RegExp(`\\.${s}$`),"");o=parseInt(o.replace(/[^\d-]/g,""),10)||0,parseInt(s,10)||(s="");const n=parseFloat(s?`${o}.${s}`:o);return/^-/.test(t)?-n:n},formatMoney(t,{currencyFormat:e=this.currency_format,currencyData:i=this.currency,freeLabel:s=!1}={}){if(!(t=parseFloat(t))&&s)return X.tr("cart::free_price");const o=e.str,n=e.d,a=Math.abs(t)>=1e4?e.t:"",r=e.d_force||parseInt(t,10)!==t?i.decimals:0,l=Q(Math.abs(t),r,n,a);let d=l;return o&&(d=o.replace(":value",l).replace(":symbol",i.symbol)),t<0&&(d=`-${d}`),d.trim()},formatNumber(t,e,i=this.currency_format){const s=i.d,o=Math.abs(t)>=1e4?i.t:"";return e=null!=e?e:i.d_force||parseInt(t,10)!==t?this.currency.decimals:0,Q(Math.abs(t),e,s,o)},animateNumber({target:t,from:e,to:i,asMoney:s,freeLabel:o=!0,duration:n,easing:a}){if(!t)return!1;const r=$(t);null==e&&(e=this.parseMoney(r.text())||"");const l=Math.abs(e-i);if(e===i)return;t._animation&&(t._animation.pause(),t._animation.reset());if(s&&(!i||!e)||l<3||"function"!=typeof anime)r.text(s?this.formatMoney(i,{freeLabel:o}):i);else{const d={value:e};null==n&&(n=Math.max(150,Math.min(.3*l,650))),null==a&&(a="linear"),t._animation=anime({targets:d,value:i,duration:n,easing:a,update:()=>{const t=Math.floor(d.value),e=s?this.formatMoney(t,{freeLabel:o}):t;r.text(e)},complete:()=>{const t=s?this.formatMoney(i,{freeLabel:o}):i;r.text(t)}})}}},flexbe_cli.locale||{}),K="hover";var J={init(){this.adaptiveHoverInit()},adaptiveHoverInit(){$(document).on("touchstart.adaptive_hover_in mouseenter.adaptive_hover_in",".js-adaptive-hover",(function(t){const e=$(t.currentTarget),i=`adaptive_hover_out_${Math.floor(1e6*Math.random())}`;function s(){e.off(`.${i}`),$(document).off(`.${i}`),e.removeClass(K)}e.addClass(K),e.one(`mouseleave.${i}`,s),$(document).one(`touchend.${i}`,s)}))}};const Z={content:"",contentAsHTML:!0,theme:"dark",animation:"fall",animationDuration:[250,180],delay:[180,100],position:"top",autoClose:!0,hideOnClick:!1,interactive:!1,distance:3,maxWidth:350,IEmin:12,trigger:"custom",triggerOpen:{click:!1,touchstart:!1,mouseenter:!0},triggerClose:{click:!1,originClick:!1,mouseleave:!0,touchleave:!0}};var tt={init(t,e={}){var i,s;if(!t)return!1;let o;const n=$(t),a=p({},Z,e,{content:null!=(i=null!=(s=e.content)?s:n.attr("data-tip"))?i:t.innerHTML});a.theme=`tooltipster-${(n.attr("data-theme")||a.theme||Z.theme).replace("tooltipster-","")}`,a.maxWidth=parseInt(n.attr("data-width"),10)||a.maxWidth,a.position=n.attr("data-tip-position")||a.position;const r=a.content||"";if(null==jQuery.fn.tooltipster)return console.warn("Tooltipster is not loaded"),!1;try{o=n.tooltipster("instance")}catch(t){}return o||r?(o?(clearTimeout(o._contentTmt),r&&r!==o.content()?(o.content(r),o.enable()):r||this.destroy(t)):(t.tooltipstered=!0,n.tooltipster(a),o=n.tooltipster("instance"),o.on("created",(()=>{n.attr("data-tooltipstered","true"),o._$tooltip.addClass("editor-ui")})),o.on("destroy",(()=>{t.tooltipstered=!1,n.removeAttr("data-tooltipstered")})),o.on("ready",(()=>{o.reposition()}))),e.show&&o.open(),o):void 0},destroy(t){if(!t)return!1;let e;const i=$(t);try{e=i.tooltipster("instance")}catch(t){}e&&(e.destroy(),t.tooltipstered=!1,i.removeAttr("data-tooltipstered"))}};let et=!1;const it="f_cookies_allowed";var st=new class{constructor(){u(this,"cookieApplied",!1),u(this,"params",{show:0,dont_set_if_not_agree:0,use_custom_warning_text:0,custom_warning_text:"",policy_uri:"",style:"right_bottom"})}init(){setTimeout((()=>requestAnimationFrame((()=>{this.params=p({},this.params,flexbe_cli.vars._group.cookies_warning||{}),flexbe_cli.is_admin||flexbe_cli.is_service||99===flexbe_cli.theme_id||!this.params.show||localStorage.getItem(it)||et||this.createNotify()}))),1e3)}createNotify(){const t=this.params,e=$("body"),i=D.viewportHeight/2,s="/\\r\\n|\\r|\\n/g";let o=flexbe_cli.scroll.latest,n=0;if(et=!0,+t.use_custom_warning_text&&t.custom_warning_text)this.content=t.custom_warning_text.replace(s,"<br />");else{const e="center_compact"===t.style?"cookies.compact_text":"cookies.long_text";this.content=flexbe_cli.locale.tr(e)}const a=t.button_text&&t.use_custom_warning_text?t.button_text.replace(s,"<br />"):flexbe_cli.locale.tr("cookies.button"),r=t.link_text?t.link_text.replace(s,"<br />"):flexbe_cli.locale.tr("cookies.button_link"),l=t.policy_uri?t.policy_uri.replace(s,"<br />"):"/legal/cookie-policy/",d=+t.use_policy?"show":"",c=$(`\n            <div class="cookies-wrap style--${t.style}">\n                <div class="cookies-container">\n                    <div class="cookies-content scrollable">\n                        <span>\n                            ${this.content}\n                            <a href="${l}" target="_blank" class="cookies-button-more ${d}">\n                             ${r}\n                            </a>\n                        </span>\n                    </div>\n\n                    <div class="cookies-button-container">\n                        <a href="${l}" target="_blank" class="cookies-button-more scrollable ${d}">\n                            ${r}\n                        </a>\n                        <div class="cookies-button scrollable">\n                            ${a}\n                        </div>\n                    </div>\n\n                    <div class="cookies-close">\n                        <svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">\n                             <path d="M7 6L13 0L14 1L8 7L14 13L13 14L7 8L1 14L0 13L6 7L0 1L1 0L7 6Z"/>\n                        </svg>\n                    </div>\n                </div>\n            </div>\n        `);e.find(".cookies-wrap").remove(),e.append(c);const h=()=>{this.cookieApplied||t.dont_set_if_not_agree&&(this.cookieApplied=!0,"function"==typeof window.applyCookies&&window.applyCookies(),document.removeEventListener("scroll",u),$(document).off("click.cookies"))},u=()=>{const t=Math.max(flexbe_cli.scroll.latest-o,o-flexbe_cli.scroll.latest);clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout((()=>{o=flexbe_cli.scroll.latest,n+=t,n>=i&&h()}),200)};setTimeout((()=>{document.addEventListener("scroll",u,{passive:!0})}),500),c.outerWidth(),c.addClass("show"),e.addClass("cookies-warning--show"),c.on("click.cookies",".cookies-button, .cookies-close",(()=>{(()=>{const t=$(".cookies-wrap");t.removeClass("show"),e.removeClass("cookies-warning--show"),localStorage.setItem(it,"allowed"),setTimeout((()=>{t.remove()}),1e3)})(),h()})),$(document).on("click.cookies","a, [data-component]",(()=>h()))}};let ot,nt,at=!1;const rt="position-fixed";var lt={createMap:()=>$('[data-is="block"][data-fixed="true"]').toArray().map(((t,e)=>{const i=$(t),s=i.attr("data-fixed-wrapper")||"self",o=i.attr("data-fixed-element"),n="self"===s?i:i.find(s),a=i.find(o);if(!a.length||!n.length)return null;const r=!!i.data("fixed-animation"),l=!!i.data("sticky"),d=a.closest("[data-static-contrast]").attr("data-static-contrast")||a.closest("[data-contrast]").attr("data-contrast"),c=a.closest("[data-fixed-contrast]").attr("data-fixed-contrast")||d,h=Math.round(n.outerHeight()),u=function(t){let e=0;for(;t;)e+=t.offsetTop,t=t.offsetParent;return Math.round(e)}(n[0]),p=u+h;let m=h;if(r){a.hasClass(rt)?m=Math.round(a.outerHeight()):(a.addClass(rt),m=Math.round(a.outerHeight()),a.removeClass(rt))}return{index:e,$block:i,$wrap:n,$fixed:a,top:u,bottom:p,height:h,heightFixed:m,contrastStatic:d,contrastFixed:c,isSticky:l,hasFixedAnimation:r,isFixed:!1,isReplaced:!1}})).filter((t=>{const e="mobile"===flexbe_cli.resize.responsiveMode,i=t.$block.data("hidden");return(!e||"mobile"!==i)&&!(!e&&"desktop"===i)})),modifyMap(t,e){let i=0,s=0;return t.forEach(((o,n)=>{const a=i+e;o.isFixedOld=o.isFixed,o.isFixed=o.hasFixedAnimation?a>o.bottom+50:a>o.top,o.fixOffset=i,o.isSticky&&o.isFixed&&(i+=o.heightFixed),o.isFixed&&(s+=o.heightFixed);const r=n&&t[n-1];o.replaceOffset=0,r&&!r.isSticky&&e+r.fixOffset+r.heightFixed>o.top&&(r.replaceOffset=Math.min(r.fixOffset+r.heightFixed,e+r.fixOffset+r.heightFixed-o.top))})),{allFixedHeight:s}},applyMap(t){const e=!t.applied&&at;t.forEach((t=>{if((t.isFixedOld!==t.isFixed||e)&&(t.$fixed.toggleClass("position-sticky",t.isFixed&&t.isSticky),t.contrastStatic&&t.contrastStatic!==t.contrastFixed&&t.$fixed.attr("data-contrast",t.isFixed?t.contrastFixed:t.contrastStatic),t.hasFixedAnimation?(clearTimeout(t._fixedAnimationBouncer),t.isFixed?(t.$wrap.css("height",`${t.height}px`),t.$fixed.removeClass("fade-out"),t.replaceOffset||(t.$fixed.addClass("position-fixed fade-in"),t._fixedAnimationBouncer=setTimeout((()=>{t.$fixed.removeClass("fade-in")}),200))):(t.$fixed.removeClass("fade-in"),t.replaceOffset||t.$fixed.addClass("fade-out"),t._fixedAnimationBouncer=setTimeout((()=>{t.$wrap.css("height",""),t.$fixed.removeClass("position-fixed fade-out")}),150))):(t.$wrap.css("height",t.isFixed?`${t.height}px`:""),t.$fixed.toggleClass(rt,t.isFixed))),t.isFixed?(t.$fixed[0].style.setProperty("top",`${t.fixOffset}px`,"important"),t.$fixed[0].style.setProperty("transform",t.replaceOffset?`translateY(-${t.replaceOffset}px)`:"none","important")):(t.$fixed[0].style.removeProperty("top"),t.$fixed[0].style.removeProperty("transform")),t.isFixedOld!==t.isFixed){const e=t.$block[0]._core;e&&e.updateTween({fixed:t.isFixed})}})),at=!0,t.applied=!0},getAllFixedHeight(t){const e=this.createMap(),{allFixedHeight:i}=this.modifyMap(e,t);return i},initFixed(){const t=flexbe_cli.is_admin,e="mobile"===flexbe_cli.resize.responsiveMode,i=this.createMap();nt=null,ot&&ot(),!i.length||t||e||(ot=function(t,e=60){let i,s,o=0;return i=requestAnimationFrame((function n(a){s||(cancelAnimationFrame(i),i=requestAnimationFrame(n),a-o<1e3/e||(t(a),o=a))})),()=>{s=!0}}((()=>{const t=window.scrollY;nt!==t&&(nt=t,this.modifyMap(i,t),this.applyMap(i))}),i.length>1?120:30))},init(){this.initFixed(),$(window).on("resized",(()=>this.initFixed()))}};function dt(t,e=!1){const i=$(t);let s=e?{}:i.data("product");if(!1===s)return!1;if(!s){s=$(t).closest("[data-product-item]").find("[data-product-action].active").data("product")}if((null==s||"object"!=typeof s||Array.isArray(s))&&(s={}),"object"==typeof s&&!s.strict){let t;if(4===flexbe_cli.theme_id?(t=i.parents(".content-zone, .flexbe-card, .flexbe-column, .modal-content").last(),t.length||(t=i.parents("[data-item-id]").last())):t=i.closest("[data-item-id], .modal-data").eq(0),s=p({},s),s.count||(s.count=1),e||!s.img){const e=t=>{const e=t.find("[data-img-id]").filter(((t,e)=>!$(e).closest(".swiper-slide-duplicate").length)).eq(0),i=e.attr("data-img-id"),s=e.attr("data-img-ext"),o=s?null:e.attr("data-img-name");return i?{id:i,ext:s,name:o}:null};s.img=e(t)||e(t.closest(".flexbe-row"))}if(e||!s.title){let e=t.find(".name, .title, .item-title, .text_title, .element-text--title, .text-style-title:not(.text-rotator), .text-style-subtitle:not(.text-rotator)").eq(0);e.length||(e=t.find(".text-style-content").eq(0)),s.title=e.text().trim()||""}if(e||!s.price&&0!==s.price){const e=t=>{const e=t.clone();flexbe_cli.is_admin&&e.find('[class^="editor"]').remove(),e.find(".text-rotator").remove(),e.find(".component-image").remove(),e.find("del, s, strike").remove();let i=String(e[0]&&e[0].innerText||"").replace(/\n/g,"<br>").replace(/\.$/,"").replace(/\u00a0/g," ");const s=i.match(/(?:\d?\D{0,2} ?)?[1-9](?:[ ,.]?\d{0,3}){2}(?:[,.]\d{1,2})?(?: ?\D)?/g)||[];return i=s.find((t=>t.includes(X.currency.symbol)))||s[0]||"",i=(i.match(/([\d\s]+[ ,.]\d+|[\d\s]+)/g)||[])[0],i?(i=X.parseMoney(i),i):null};s.price=e(i.closest(".element-item").find(".price, .item-price, .main-price, .element-text--price").eq(0))||e(i)||e(t.find(".price, .item-price, .main-price, .element-text--price").eq(0))||e(t)}}if(!s.id)if(s.productId)s.id=`product_${s.productId}:${s.variantId||"default"}`;else{const t=flexbe_cli.p_id,e=i.parents("[data-id], [data-item-id], [data-multivar]").toArray().map((t=>(t.getAttribute("data-id")||t.getAttribute("data-item-id")||"")+(t.getAttribute("data-multivar")||""))).join(":");s.id=`${t}_${e||0}`}return p({type:s.productId?"product":"custom"},s)}let ct=[];class ht extends c{constructor(){super(),this.initList()}dispatch(t,...e){const i=this[t];if("function"!=typeof i)throw new Error(`Cart dispatch: action '${t}' doesnt exist`);const s=i.apply(this,e);return this.emit("dispatch",{name:t,args:e,result:s}),s}initList(){let t=[];if(flexbe_cli.is_admin){const e="ru"===flexbe_cli.locale.language,i="RUB"===flexbe_cli.locale.currency.code;t=[{id:"default1",count:1,protect:!0,img:{unq_id:"default1",id:1000000945,ext:"jpg"},title:e?" ":"Example Item",price:i?750:10},{id:"default2",count:2,protect:!0,img:{unq_id:"default2",id:1000000948,ext:"jpg"},title:e?" ":"Another Item",price:i?2550:25}]}else try{t=JSON.parse(localStorage.getItem("f_cart"))||[],t=t.filter((t=>t&&+t.count))}catch(t){console.error(t)}this.dispatch("updateList",t)}getList(){return ct}getItem(t){return ct.find((e=>e.id===t))}getCount(){return ct.reduce(((t,e)=>t+e.count),0)}getTotal(){return ct.reduce(((t,e)=>(e.count&&e.price&&(t+=parseInt(String(e.count),10)*parseFloat(String(e.price))),t)),0)}updateList(t){if(!Array.isArray(t))return null;if(t=t.map((t=>{var e;const i=this.getItem(t.id);if("string"==typeof t.img){const e=w(t.img);t.img=e&&{id:e.id,ext:e.ext}}else null!=(e=t.img)&&e.img_id&&(t.img={id:t.img.img_id,ext:t.img.img_ext,unq_id:String(t.img.unq_id||t.img.id)});var s,o,n;(t.img=t.img||null,t.type=t.type||"custom",t.price=null==t.price?null:parseFloat(t.price),i&&null==t.orderPrice)?t.orderPrice=null!=(s=i.orderPrice)?s:i.price:null==t.orderPrice&&(t.orderPrice=t.price);return t.quantity=(n=o=t).quantity===1/0||-1===n.quantity||null==n.quantity?1/0:o.quantity,t.count=+t.count||0,t})),!flexbe_cli.is_admin)try{localStorage.setItem("f_cart",JSON.stringify(t))}catch(t){}return ct=t,ct}purchase(){flexbe_cli.stat.ecommerce.purchase(ct),this.resetList()}resetList(){const t=[...ct].filter((t=>t.protect));this.updateList(t)}addItem(t){if(!t.id)throw new Error("Cart add item: product ID is not defined");const e=[...ct],i=p({},t,{count:parseFloat(t.count)||1}),s=this.getItem(i.id);if(s){const t=e.indexOf(s);i.count+=s.count,e.splice(t,1,i)}else e.push(i);return this.updateList(e),flexbe_cli.stat.ecommerce.add(i),e}removeItem(t){const e=this.getItem(t),i=[...ct];return!e||e.protect?ct:(i.splice(i.indexOf(e),1),flexbe_cli.stat.ecommerce.remove(e),this.updateList(i))}updateCount({id:t,count:e}){const i=this.getItem(t);if(!i)return null;const s=+i.count||0;"+"===e?i.count+=1:"-"===e&&i.count>0?i.count-=1:i.count=""===e?1:e,Number.isNaN(+i.count)&&(i.count=s),this.updateList(ct);const o=i.count-s;return o>0?flexbe_cli.stat.ecommerce.add(p({},i,{count:o})):o<0&&flexbe_cli.stat.ecommerce.remove(p({},i,{count:-o})),i}normalizeListItems(t=ct,e={price:!0,count:!1,unavailable:!1}){let i=t.map((t=>{const i=p({},t);return e.price&&(i.orderPrice=t.price),e.count&&!pt.cartSettings.allowPreorder&&(i.count=Math.min(t.count,t.quantity)),i}));return e.unavailable&&(i=i.filter((t=>!t.hidden&&t.count))),this.updateList(i),i}}class ut extends c{constructor(){super(),u(this,"enabled",void 0),u(this,"activeMethod",void 0),u(this,"methods",void 0),u(this,"cartSettings",void 0),this.methods=(E._group.ecommerce.delivery||[]).filter((t=>t.enabled)),this.cartSettings=pt.cartSettings,this.enabled=this.methods.length>0,this.activeMethod=this.methods[0]}dispatch(t,...e){const i=this[t];if("function"!=typeof i)throw new Error(`Delivery dispatch: action '${t}' doesnt exist`);const s=i.apply(this,e);this.emit("dispatch",{name:t,args:e,result:s})}getActive(){const t=this.activeMethod;return t?{id:t.id,type:t.type,title:t.title,desc:t.desc,price:this.getPrice(t.id)}:null}getMethod(t){return this.methods.find((e=>`${e.id}`===t))}selectMethod(t){return this.activeMethod=this.getMethod(t)||this.methods[0],this.activeMethod}getPrice(t){const e=t?this.getMethod(t):this.activeMethod,i=this.cartSettings.useMinTotal?+this.cartSettings.minTotal:0;let s,o=0,n="",a=0,r="",l=0,d="",c=0,h="",u=0,p="",m=!1;if(e){const t=pt.cartStore.getTotal();e.prices.filter((t=>""!==t.from)).forEach(((s,n)=>{e.useMinTotal&&!n&&+s.from&&(o=+s.price,+s.from>i&&(c=+s.from)),(t>=+s.from||!n)&&(o=+s.price)}));const n=e.prices.find((t=>0===t.price));m=!!e.useNotFixTotal,s=m&&(!n||""===n.from),n&&(a=+n.from||0,l=Math.max(0,a-t),r=X.formatMoney(a),d=X.formatMoney(l)),c&&(u=Math.max(0,c-t),h=X.formatMoney(c),p=X.formatMoney(u))}return(!m||a&&l<=0)&&(m=!1,n=X.formatMoney(o,{freeLabel:!0})),{current:o,currentFormatted:n,freeFrom:a,freeFromFormatted:r,untilFree:l,untilFreeFormatted:d,minTotal:c,minTotalFormatted:h,untilMinTotal:u,untilMinTotalFormatted:p,notFixedPrice:m,notHasFree:s}}}var pt=new class{constructor(){u(this,"cartStore",null),u(this,"deliveryStore",null),u(this,"getProductInfo",dt)}get cartSettings(){var t,e,i,s;const o=E._group.ecommerce,n=o.cart,a=null!=(t=o.out_of_stock_action)?t:"forbid_preorder",r="allow_preorder"===a,l=n.use_total&&n.total>0;return{useMinTotal:l,minTotal:l?n.total:0,autoOpen:null!=(e=n.auto_open)&&e,inStockStatus:null!=(i=o.in_stock_status)?i:"in_stock",outOfStockStatus:null!=(s=o.out_of_stock_status)?s:"out_of_stock",outOfStockAction:a,allowPreorder:r}}init(t=!1){this.cartStore=new ht,t&&(this.deliveryStore=new ut)}};class mt{constructor(t,e={}){const i=$(t),s=i.attr("data-is"),o=i.attr("data-id"),n="zone"===s?"e":s[0],a=i.attr(`data-${n}-id`),r=i.attr("data-mod-id")||0,l=JSON.parse(i.attr("data-components")||null),d=JSON.parse(i.attr(`${n}-type`)||"[]");this.require=[],this.$area=i,this.area=i[0],this.$container=i,this.container=t[0],this.$root=i,this.root=i[0],this.inited=!1,this.is=s,this.id=o,this.template_id=a,this.mod_id=r,this.type=d,this.components=l,this.tween={},this.isVisible=null,this.inScreen=!1,this.inBeside=!1,this.inView=!1,this.inFocus=!1,this.wasVisible=null,this.wasScreen=!1,this.wasBeside=!1,this.wasView=!1,this.wasFocus=!1,Object.keys(e).forEach((t=>{const i=Object.getOwnPropertyDescriptor(e,t);if("value"in i){const i=e[t];this[t]="object"==typeof i?$.extend(!0,Array.isArray(i)?[]:{},i):i}else Object.defineProperty(this,t,i)}))}onInit(){}onUpdate(){}onLoad(){}onReady(){}onDestroy(){}onVisible(){}onBeside(){}onFocus(){}onScreen(){}onView(){}onMsg(){}onResize(){}onOpen(){}onClose(){}init(t,e){null==e&&(e=this.inited?"update":"init"),"init"===e?this._onInit(t):"update"===e&&this._onUpdate(t),("init"===e||t.templateRendered)&&flexbe_cli.require(this.require,(()=>{this._onLoad(t)}))}destroy(t){this._onDestroy(t)}_sendEvent(t,e){flexbe_cli.events.emit("entity_event",{type:t,core:this,params:e});const i=new CustomEvent(t,{detail:e});this.area.dispatchEvent(i,{bubbles:!1})}_onInit(t){this.inited=!0,flexbe_cli.locale.init(this.area),this._sendEvent("onInit",t),this.onInit(t),requestAnimationFrame((()=>this.updateTween()))}_onLoad(t){this.loaded=!0,this._sendEvent("onLoad",t),this.onLoad(t),this.onReady(t),this.require.length&&requestAnimationFrame((()=>this.updateTween({force:!0})))}_onUpdate(t){const e=this.$area.attr("data-mod-id")||0,i=JSON.parse(this.$area.attr("data-components")||null);this.modId=e,this.components=i,this.inited=!0,this.updated=!0,t.templateRendered&&flexbe_cli.locale.init(this.area),this._sendEvent("onUpdate",t),this.onUpdate(t),(t.templateRendered||t.styleRendered)&&requestAnimationFrame((()=>this.updateTween({force:!0})))}_onResize(t={}){this.isVisible&&(this._sendEvent("onResize",t),this.onResize(t))}_onDestroy(t){this.$area.off(".inherit"),this._sendEvent("onDestroy",t),this.onDestroy(t),delete this.area._core}_onMsg(t,e){this.onMsg(t,e)}_onVisible({state:t,force:e}){if(null==this.isVisible)return this.isVisible=t,void(this.wasVisible=t);if(this.isVisible===t&&!e)return;const i=t&&!this.wasVisible;this.isVisible=t,this._sendEvent("onVisible",{state:t,first:i}),this.onVisible({state:t,first:i}),t&&(this.wasVisible=!0)}_onFocus({state:t,force:e}){if(this.isVisible||(t=!1),this.inFocus===t&&!e)return;const i=t&&!this.wasFocus;this.inFocus=t,this._sendEvent("onFocus",{state:t,first:i}),this.onFocus(t,i),t&&(this.wasFocus=!0)}_onScreen({state:t,force:e}){if(this.isVisible||(t=!1),this.inScreen===t&&!e)return;const i=t&&!this.wasScreen;this.inScreen=t,this._sendEvent("onScreen",{state:t,first:i}),this.onScreen(t,i),t&&(this.wasScreen=!0)}_onView({state:t,force:e}){if(this.isVisible||(t=!1),this.inView===t&&!e)return;const i=t&&!this.wasView;this.inView=t,i&&"block"===this.is&&(this.$area.addClass("was-view"),setTimeout((()=>{this.$area.removeClass("wait-animation")}),1200)),this._sendEvent("onView",{state:t,first:i}),this.onView(t,i),t&&(this.wasView=!0)}_onBeside({state:t,force:e}){if(this.isVisible||(t=!1),this.inBeside===t&&!e)return;const i=t&&!this.wasBeside;this.inBeside=t,this._sendEvent("onBeside",{state:t,first:i}),this.onBeside(t,i),t&&(this.wasBeside=!0)}updateTween(){}_onOpen(t){this.updateTween(),this._sendEvent("onOpen",t),this.onOpen(t)}_onClose(t){this.updateTween(),this._sendEvent("onClose",t),this.onClose()}}class ft extends mt{constructor(t,e){super(t,e),this.is="modal",this.isOpen=!1,this.$modal=this.$area}open({fromId:t,data:e,options:i={}}){if(this.isOpen)return;this.isOpen=!0,this.lastOptions=i,this.lastScroll=flexbe_cli.scroll.latest;const s=this.$area.find(".modal-data > ._anchor").attr("name")||this.id;(i.hash||null==i.hash)&&(this._prevHash=window.location.hash,flexbe_cli.lockPopstate=!0,window.history.pushState(null,null,`#${s}`),flexbe_cli.lockPopstate=!1),this.$area.addClass("show"),flexbe_cli.modal.$list.addClass("show"),$("body").addClass("is-modal-open"),$(".w_cart.show").length&&flexbe_cli.modal.$list.addClass("rise"),setTimeout((()=>{flexbe_cli.modal.$list.addClass("overlay"),this._onOpen({data:e}),this._onBeside({state:!0}),this._onScreen({state:!0}),this._onView({state:!0}),this._onFocus({state:!0}),"function"==typeof i.onOpen&&i.onOpen()}),30),flexbe_cli.scroll.scrollLock.lock(),flexbe_cli.events.emit("modal_opened",{id:this.id,fromId:t,data:e,options:i})}close({openId:t}={}){if(!this.isOpen)return;const e=this.lastOptions,i=!t&&!this.$area.siblings(".show").length;if(this.lastOptions={},this.isOpen=!1,(e.hash||null==e.hash)&&i&&/^#{1,2}/.test(window.location.hash)){const t=this._prevHash&&this._prevHash!==window.location.hash?this._prevHash:"#";flexbe_cli.lockPopstate=!0,window.history.replaceState(null,null,t),flexbe_cli.lockPopstate=!1}this.$area.removeClass("show").addClass("hide"),setTimeout((()=>{this.$area.removeClass("show hide"),i&&(flexbe_cli.modal.$list.removeClass("show rise overlay fade-out"),"#cart"!==window.location.hash&&flexbe_cli.scroll.scrollLock.unlock(),$("body").removeClass("is-modal-open")),flexbe_cli.run.is_screen_mobile&&$("body, html").scrollTop(this.lastScroll)}),200),this._onClose(),this._onBeside({state:!1}),this._onScreen({state:!1}),this._onView({state:!1}),this._onFocus({state:!1}),"function"==typeof e.onClose&&e.onClose(this),flexbe_cli.events.emit("modal_closed",{id:this.id,openId:t})}updateTween({force:t}={}){const e=this.area,i=e.offsetWidth,s=e.offsetHeight,o=null==this.tween.width&&null==this.tween.height,n=t||i!==this.tween.width||s!==this.tween.height,a=this.isOpen;return this.tween.width=i,this.tween.height=s,this.inited&&(this._onVisible({force:t,state:a}),!o&&n&&this._onResize({force:t}),this._onBeside({force:t,state:a}),this._onScreen({force:t,state:a}),this._onView({force:t,state:a}),this._onFocus({force:t,state:a}),this._sendEvent("tween",{tween:this.tween,force:t})),n}}const gt=()=>{if(flexbe_cli.is_admin){if((window.parent.flexbe.modal.visible||[]).length)return!1}return!0},vt={};var bt={opened:{},$list:[],init(){this.list=document.querySelector(".modal-list"),this.$list=$(this.list),zt.initArea(this.$list);const t=window.getJsonFromUrl();if(t.service&&t.m_id)return this.$list.addClass("noanimate"),this.open({id:t.m_id}),!1;this.dispatchEvents()},dispatchEvents(){const t=$("body");if(flexbe_cli.events.on("ui_modal_open.core_modal",((t,e={})=>{this.open(e)})),flexbe_cli.events.on("ui_modal_close.core_modal",((t,e={})=>{this.close(e)})),t.on("click.modal-close",".m_modal .close",(t=>{t.preventDefault();const e=$(t.currentTarget).closest(".m_modal.show").attr("data-id");this.close({id:e})})),!flexbe_cli.is_admin){let e,i,s={x:0,y:0};t.off(".modal-close-overlay").on("pointerdown.modal-close-overlay pointerup.modal-close-overlay",".modal-data",(t=>{Object.keys(this.opened).length&&gt()&&("pointerdown"===t.type?(s={x:t.pageX,y:t.pageY},i=$(t.target).is(".modal-data")||$(t.target).is('[data-overlay="true"]')?t.target:null,e=t.target.clientWidth<=t.pageX):!e&&i===t.target&&Math.sqrt((t.pageX-s.x)**2+(t.pageY-s.y)**2)<10&&setTimeout((()=>{this.close({id:$(i).closest(".m_modal").attr("data-id")})}),50))})),$(window).off(".modal-close-esc").on("keyup.modal-close-esc",(t=>{if(27===t.which&&gt()&&Object.keys(this.opened).length){const t=Object.keys(this.opened),e=t[t.length-1];this.close({id:e})}}))}},find(t){if(null==this.$list||!this.$list.length)return!1;const e=this.$list.find(`[data-id="${t}"]`);if(null==e||!e.length)return!1;const i=e.toArray(),s=i[0]||!1;return!!s&&{modals:i,modal:s}},open({id:t,data:e={},options:i={}}={}){let{modals:s,modal:o}=this.find(t)||{},n=$(s);if(!o)return console.warn("WRONG ACTION","modal_not_found",t),flexbe_cli.is_admin&&flexbe_cli.events.emit("editor_page_error",{type:"action",error:"modal_is_wrong"}),!1;if(n.length>1){let{multivar:e}=i;if(!e){const i=String(t).split("_")[0];e=$(`[data-id="${i}"]`).attr("data-multivar")}let s=[];e&&"default"!==e&&(s=n.filter(`[data-multivar="${e}"]`).eq(0)),n=s.length?s.eq(0):n.eq(0),o=n[0]}const a=this.bind(o);if(o&&!a)return console.warn("Try to open modal without core object,",`id: ${t},`,"modal: ",o),!1;const r=Object.keys(this.opened),l=r[r.length-1];return!i.rise&&l&&l!==t&&this.close({id:l,openId:t}),r.includes(t)||a.open({fromId:l,data:e,options:i}),a.$area.css("zIndex",Object.keys(this.opened).length+1),delete this.opened[t],this.opened[t]=a,!0},close({id:t,openId:e}={}){if(!t)return Object.keys(this.opened).map((t=>!(!this.opened[t]||t===e)&&this.close({id:t,openId:e})));if(!this.opened[t])return!1;delete this.opened[t];const{modal:i}=this.find(t)||{},s=this.bind(i);return i?s?(s.close({openId:e}),s.$area.css("zIndex",""),!0):(console.warn("Try to close modal without core object"),!1):void 0},bind(t){if(!t)return!1;const e=t.getAttribute("data-m-id");if(e&&!t._core){const i=vt[e]||{};t._core=new ft(t,i)}return t._core},register(t,e={}){t||console.warn("Element register error: Element must have templateId"),vt[t]=e}};const wt=document,$t="a[href], [data-action]",yt="[data-action-target]";let _t;class xt{static create(...t){return _t||(_t=new xt(...t),_t)}static fixProductData(t=document){$(t).find("[data-product]").each(((t,e)=>{const i=$(e);let s=i.data("product");i.removeAttr("data-product"),(null==s||"object"==typeof s&&!Object.keys(s).length)&&(s=null),null!==s?i.data("product",s):i.removeData("product")}))}static initIosHacks(t="body"){z.is_ios&&$("a, [data-action-target]",t).off("click.iosHacks").on("click.iosHacks",(()=>!0))}constructor(){this.bindEvents(),xt.initIosHacks()}bindEvents(){const t=t=>!!t.target.closest('[data-prevent-action], [data-flexbe-events="off"]');$(wt).off("mousedown.component-links-fake",yt).on("mousedown.component-links-fake",yt,(t=>{if(2===t.which||1===t.button)return t.preventDefault(),!1})),$(wt).off("click.component-links-fake auxclick.component-links-fake").on("click.component-links-fake auxclick.component-links-fake",yt,(e=>{const i=e.originalEvent;if(!i||!i.isTrusted||e.target.closest($t)||t(e))return!0;e.stopPropagation(),e.stopImmediatePropagation(),function(t,e={}){const i=new MouseEvent(e.type||"click",{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey,button:e.button,buttons:e.buttons,relatedTarget:e.relatedTarget});t.dispatchEvent(i)}($(e.currentTarget).children($t).get(0),i)})),$(wt).off("click.component-links auxclick.component-links",$t).on("click.component-links auxclick.component-links",$t,(e=>{const i=e.currentTarget,s=$(i);if(t(e))return!0;if(flexbe_cli.is_admin&&!i.closest(".editor-focus")&&!$("body").hasClass("is-view"))return e.preventDefault(),!0;const o=s.closest("[data-action]").data("action")||("A"===i.tagName?"link":"none");return this.reachGoals(e),"link"===o?this.actionLink(e):"file"===o?this.actionFile(e):"popup"===o?this.actionPopup(e):"button"===o?this.actionButton(e):"modal"===o?this.actionModal(e):"cart"===o?this.actionCart(e):"quiz"===o?this.actionQuiz(e):"close"===o?this.actionClose(e):void 0}))}actionPopup(t){return t.preventDefault(),!1}actionFile(){return!0}actionLink(t){const e=t.currentTarget,i=e.hasAttribute("href"),s=i?e.getAttribute("href"):"",o=2===t.button||3===t.which,n=1===t.button||2===t.which,a=t.metaKey||t.ctrlKey||n||"_blank"===e.getAttribute("target"),r=e.hasAttribute("download");o||r||a&&!n?flexbe_cli.is_admin&&i&&""===s&&(e.href="./"):(t.preventDefault(),clearTimeout(this._lastLinkTmt),this._lastLinkTmt=setTimeout((()=>{V(s,a)}),15))}actionButton(t){t.stopPropagation();const e=$(t.currentTarget).closest(".content-zone, [data-item-id]").first().find(".component-button").not(".form-field-submit").find($t);e[0]&&e[0].click()}actionModal(t){const e=$(t.currentTarget),i=this.getProductInfo(e[0]);let s=e.attr("data-modal-id");if(/^(form|done)$/.test(s)&&!bt.find(s)){s=`${e.closest("[data-id]").attr("data-id").split("_")[0]}_${s}`}h.emit("ui_mobilemenu_close"),h.emit("ui_modal_open",{id:s,data:{items:i?[i]:[]}})}actionCart(t){const e=$(t.currentTarget),i=$(t.currentTarget).closest(yt),s=e.closest(".m_modal").length,o=this.getProductInfo(e[0]);o&&(i.addClass("animate-add-to-cart"),setTimeout((()=>{i.removeClass("animate-add-to-cart"),s&&(h.emit("ui_modal_close"),pt.cartStore.dispatch("addItem",o))}),s?450:1600),s||pt.cartStore.dispatch("addItem",o))}actionQuiz(t){const e=$(t.currentTarget).closest("[data-id]").attr("data-id");h.emit("quiz_command",{command:"start",id:e})}actionClose(t){t.preventDefault(),h.emit("ui_modal_close")}reachGoals(t){const e=$(t.currentTarget),i=e.attr("data-action"),s=e.attr("data-modal-id"),o=Y.getGoal(i,s),n=e.attr("data-goal"),a=e.attr("data-html-goal");Y.reachGoals({mainGoal:o,goal:n,htmlGoal:a})}getProductInfo(t){let e=dt(t)||{};return e&&(e.title&&"-"!==e.title||e.price)||(e=null),e}}const At=(t,e=0)=>(...i)=>setTimeout((()=>t(...i)),e),Ct=(t,e=0,...i)=>At(t,e)(...i),St=".b_block",kt=".m_modal",It=".w_widget",Et='[data-is="zone"]',Ft='[data-is="element"]';var zt={init(){this.dispatchEvents()},bind(t,e,i={}){const s=flexbe_cli[t].bind(e);return s&&!i.skipInit&&s.init(i),s},initArea(t,e={}){return!!t.length&&(t.toArray().forEach((t=>{xt.fixProductData(t)})),t.toArray().forEach((t=>{let i;const s=$(t);if(s.is(St)?i="block":s.is(kt)?i="modal":s.is(It)?i="widget":(flexbe_cli.element&&s.is(Ft)||s.is(Et))&&(i="element"),i)this.bind(i,t,e);else{const t=s.find(St),i=s.find(kt),o=s.find(It);t.toArray().forEach(At((t=>this.bind("block",t,e)))),i.toArray().forEach(At((t=>this.bind("modal",t,e)))),o.toArray().forEach(At((t=>this.bind("widget",t,e))))}if(flexbe_cli.element){const t=s.find(Et),i=s.find(Ft);t.toArray().forEach(At((t=>this.bind("element",t,e)))),i.toArray().forEach(At((t=>this.bind("element",t,e))))}})),t[0]._core)},dispatchEvents(){flexbe_cli.is_admin&&(flexbe_cli.events.on("entity_render.core_entity",((t,e)=>{if(!e||!e.id)return;if(e.originId&&e.originId!==e.id)return;const i=e.entity&&e.entity.$area||$(document).find(`[data-id="${e.id}"]`);i.length&&this.initArea(i,e)})),flexbe_cli.events.on("layout_change.core_entity",((t,e)=>{if("before_remove"!==e.action)return;(e.entity&&e.entity.$area||$(document).find(`[data-id="${e.id}"]`)).each(((t,i)=>{i._core&&i._core.destroy(e)}))})),flexbe_cli.events.on("client_msg.core_entity",((t,e)=>{if(!e||!e.id||!e.is)return;const i=e.entity&&e.entity.$area||$(document).find(`[data-id="${e.id}"]`);i.length&&i.each(((t,i)=>{i._core&&i._core._onMsg(e.msg,e.data)}))})))}};class Tt extends mt{constructor(t,e){super(t,e),this.is="block",this.$block=this.$area,this.$container=this.$area.find(".container-fluid"),this.container=this.$container[0],this.abtestVariant=this.$area.attr("data-abtest-variant"),this.abtestId=this.abtestVariant&&this.$area.attr("data-abtest-id")}_onInit(t){super._onInit(t)}_onUpdate(t){this.$container=this.$area.find(".container-fluid"),this.container=this.$container[0],super._onUpdate(t)}_onDestroy(t){this.inited=!1,super._onDestroy(t)}updateTween({force:t=!1,fixed:e=!1}={}){var i;const s=this;if(!s.inited)return!1;const o=s.area.offsetTop||0,n=(null==(i=s.area.offsetParent)?void 0:i.offsetTop)||0,a=Math.max(0,o+n),r=s.area.offsetWidth,l=s.area.offsetHeight,d=!(!r&&!l),c=null==this.tween.width&&null==this.tween.height,h=t||r!==s.tween.width||l!==s.tween.height;s.tween.fixed=e,s.tween.width=r,s.tween.height=l,s.tween.start=a,s.tween.end=a+l;const u=Math.max(flexbe_cli.resize.viewportHeight-s.tween.height,0),p=1/s.tween.height*(flexbe_cli.scroll.latest-s.tween.start),m=function(){const t=s.tween.start-flexbe_cli.resize.viewportHeight;return 1/(s.tween.end-t)*(flexbe_cli.scroll.latest-t)}(),f=function(){const t=flexbe_cli.scroll.latest+flexbe_cli.resize.viewportHeight/2,e=s.tween.start+s.tween.height/2;return(t-e+s.tween.height/2)/s.tween.height}();s.tween.fix=u,s.tween.position=p,s.tween.positionAbs=m,s.tween.positionCenter=f;const g=d&&f>0&&f<1,v=g||function(){if(s.tween.fixed)return!0;const t=Math.min(s.tween.height/3,flexbe_cli.resize.viewportHeight/4);return flexbe_cli.scroll.latest+flexbe_cli.resize.viewportHeight>s.tween.start+t&&flexbe_cli.scroll.latest<s.tween.end-t}(),b=v||function(){if(s.tween.fixed)return!0;return s.tween.positionAbs>=0&&s.tween.positionAbs<=1}(),w=b||function(){if(s.tween.fixed)return!0;const t=flexbe_cli.resize.viewportHeight/3;return flexbe_cli.scroll.latest+flexbe_cli.resize.viewportHeight>s.tween.start-t&&flexbe_cli.scroll.latest<s.tween.end+t}();return s._onVisible({state:d}),!c&&h&&s._onResize({force:t}),s._onBeside({force:t,state:w}),s._onScreen({force:t,state:b}),s._onView({force:t,state:v}),s._onFocus({force:t,state:g}),s._sendEvent("tween",{tween:s.tween,force:t}),h}}const Dt={};var Rt={$list:$(".container-list").eq(0),$blocks:$(".b_block"),init(){zt.initArea(this.$list),this.dispatchEvents(),this.fixCoverHeight()},dispatchEvents(){$(document).on("resized.flexbe_block documentresized.flexbe_block",$.debounce((()=>{this.fixCoverHeight(),this.$blocks.each(((t,e)=>W(e,{force:!1})))}),20)),window.addEventListener("scroll",$.throttle((()=>{this.$blocks.each(((t,e)=>W(e,{force:!1})))}),96),{passive:!0}),flexbe_cli.is_admin&&flexbe_cli.events.off("layout_change.flexbe_block").on("layout_change.flexbe_block",((t,e)=>{e&&"block"===e.is&&(this.$blocks=$(".b_block"),this.fixCoverHeight(),this.$blocks.each(((t,e)=>W(e,{force:!0}))))}))},fixCoverHeight(t){[2,3].includes(flexbe_cli.theme_id)&&(null==t&&(t=this.$list.find(".b_block")),t.each(((t,e)=>{let i,s=0,o=flexbe_cli.resize.coverHeight||flexbe_cli.resize.viewportHeight;const n=$(e),a=n.find(".cover");if(!a.length)return;const r=n.prevAll(".b_block");i=flexbe_cli.is_admin&&n.is('[data-abtest-variant="b"]')?r.eq(1):r.eq(0),i=i.filter('[data-b-type*="header"]').not('[data-b-type*="overflow"]'),s=Math.max(0,i.outerHeight()||0),s<250&&s<o/2.5&&(o-=s),a.css({"--coverHeight":`${o}px`})})))},bind(t){if(!t)return!1;const e=t.getAttribute("data-b-id");if(e&&!t._core){const i=Dt[e]||{};t._core=new Tt(t,i)}return t._core},register(t,e={}){t||console.warn("Element register error: Element must have templateId"),Dt[t]=e}};class Mt extends mt{constructor(t,e){super(t,e),this.is="widget",this.$widget=this.$area}updateTween({force:t}={}){const e=this.area,i=e.offsetWidth,s=e.offsetHeight;let o;o=null!=this.isOpen?!!this.isOpen:!(!i&&!s);const n=null==this.tween.width&&null==this.tween.height,a=!!t||i!==this.tween.width||s!==this.tween.height;return this.tween.width=i,this.tween.height=s,this.inited&&(this._onVisible({force:t,state:o}),!n&&a&&this._onResize({force:t}),this._onBeside({force:t,state:o}),this._onScreen({force:t,state:o}),this._onView({force:t,state:o}),this._onFocus({force:t,state:o}),this._sendEvent("tween",{tween:this.tween,force:t})),a}}const Bt={};var Lt={init(){this.$list=$(".widget-list"),this.list=this.$list.get(0),zt.initArea(this.$list)},bind(t){if(!t)return!1;const e=t.getAttribute("data-w-id");if(!t._core){const i=Bt[e]||{};t._core=new Mt(t,i)}return t._core},register(t,e={}){t||console.warn("Element register error: Element must have templateId"),Bt[t]=e}};class Pt extends mt{constructor(t,e){super(t,e);const i=this.$area.closest(".b_block, .m_modal, .w_widget"),s=this.$area.parent().closest("[data-is]"),o=this.$area.closest("[data-cloned]");this.is="element",this.isClone=!!o.length&&o.attr("data-cloned"),this.$container=this.$area.find("> .element-content").addBack().last(),this.container=this.$container[0],this.$root=i,this.root=i[0],this.$parent=s,this.parent=s[0]}_onInit(t){super._onInit(t),this._inheritEvents()}_onUpdate(t){this.$area.off(`.inherit.${this.id}`),this.$container=this.$area.find("> .element-content").addBack().last(),this.container=this.$container[0],super._onUpdate(t),this._inheritEvents()}_onDestroy(t){super._onDestroy(t),this.$area.off(".inherit"),this.$parent.off(`.inherit.${this.id}`)}_inheritEvents(){const t=`.inherit.${this.id}.${this.isClone?`clone${Number(this.isClone)}`:"original"}`;this.$parent.off(t),this.$parent.on(`tween${t}`,(t=>{this.updateTween(t.detail||{})})),["onVisible"].forEach((e=>{this.$parent.on(`${e}${t}`,(()=>{this.updateTween({})}))})),["onOpen","onClose","onDestroy"].forEach((e=>{this.$parent.on(`${e}${t}`,((t,...i)=>{!i.length&&t.detail&&(i[0]=t.detail),this[`_${e}`](...i)}))}))}updateTween({force:t}={}){const e=this.container||this.area,i=this.parent&&this.parent._core,s=this.root&&this.root._core;if(!i)return;const o=null==this.tween.width&&null==this.tween.height;let n=i.isVisible,a=i.inBeside,r=i.inScreen,l=i.inView,d=i.inFocus,c=!1;if(s&&"block"===s.is&&n&&a){const{top:i,bottom:s}=e.getBoundingClientRect(),o=e.offsetWidth,h=e.offsetHeight,u=flexbe_cli.resize.viewportHeight;if(n=!(!o&&!h),c=t||o!==this.tween.width||h!==this.tween.height,this.tween.width=o,this.tween.height=h,n){a=s>-u/3&&i<u+u/3,r=a&&r&&s>0&&i<u,d=r&&d&&i<=u/2&&i+h>=u/2;const t=Math.min(h/3,flexbe_cli.resize.viewportHeight/4);l=d||r&&l&&i+t>0&&s-t<u}}this.isVisible!==n&&this._onVisible({force:t,state:n}),!o&&c&&this._onResize({force:t}),this._onBeside({force:t,state:a}),this._onScreen({force:t,state:r}),this._onView({force:t,state:l}),this._onFocus({force:t,state:d}),this._sendEvent("tween",{tween:this.tween,force:t})}}const Vt={};var Ot={instances:{},get $zones(){return $('[data-is="zone"]')},get $elements(){return $('[data-is="element"]')},init(){},bind(t){if(!t)return!1;const e=t.getAttribute("data-e-id");if(!t._core){const i=Vt[e]||{};t._core=new Pt(t,i)}return t._core},register(t,e={}){t||console.warn("Element register error: Element must have templateId"),Vt[t]=e}};const Ht=new WeakMap,Wt=t=>{const{is:e,component:i}=t;Ht.has(i)||Ht.set(i,Math.floor(999999999*Math.random()));return`.inherit.component.${e}-${Ht.get(i)}`};class qt{constructor({component:t,core:e,reason:i}){this.core=e,this.owner=e.area,this.root=e.root,this.component=t,this.$component=$(t),this.require=[],this.isPageLoaded=flexbe_cli.isLoaded||!1,this.isInited=!1,this.isUpdated="onUpdate"===i,this.isLoaded=!1,this.isVisible=null,this.inScreen=!1,this.inBeside=!1,this.inView=!1,this.inFocus=!1,this.wasVisible=null,this.wasScreen=!1,this.wasBeside=!1,this.wasView=!1,this.wasFocus=!1}onInit(){}onLoad(){}onVisible(){}onScreen(){}onBeside(){}onView(){}onFocus(){}onPageLoad(){}onWindowResize(){}onResize(){}onOpen(){}onClose(){}onDestroy(){}_inheritEvents(){this._clearEvents();const t=Wt(this);this.core.$area.on(`tween${t}`,(t=>this._syncStates(t.detail))),this.core.$area.on(`onOpen${t}`,(t=>this._onOpen(t.detail))),this.core.$area.on(`onClose${t}`,(t=>this._onClose(t.detail)))}_clearEvents(){const t=Wt(this);this.core.$area.off(t)}_syncStates({force:t}={}){const e=this.component.offsetWidth,i=this.component.offsetHeight,s=null==this.componentWidth||null==this.componentHeight,o=this.core.isVisible&&!(!e&&!i),n=this.core.inBeside&&o,a=this.core.inScreen&&o,r=this.core.inView&&o,l=this.core.inFocus&&o,d=this.componentWidth!==e,c=this.componentHeight!==i,h=t||o&&!s&&(d||c);o&&(this.componentWidth=e,this.componentHeight=i),o!==this.isVisible&&this._onVisible({state:o}),h&&this._onResize({force:t}),n!==this.inBeside&&this._onBeside({state:n,force:t}),a!==this.inScreen&&this._onScreen({state:a,force:t}),r!==this.inView&&this._onView({state:r,force:t}),l!==this.inFocus&&this._onFocus({state:l,force:t})}_onInit(){this.isInited=!0,this._inheritEvents(),this._syncStates(),"function"==typeof this.onInit&&this.onInit(),M(this.require,(()=>this._onLoad()))}_onLoad(){this.isLoaded=!0,"function"==typeof this.onLoad&&this.onLoad()}_onVisible({state:t}){if(null==this.isVisible)return this.isVisible=t,void(this.wasVisible=t);const e=t&&!this.wasVisible;this.isVisible=t,this.onVisible({state:t,first:e}),t&&(this.wasVisible=!0)}_onScreen({state:t}){const e=t&&!this.wasScreen;this.inScreen=t,this.onScreen({state:t,first:e}),t&&(this.wasScreen=!0)}_onView({state:t}){const e=t&&!this.wasView;this.inView=t,this.onView({state:t,first:e}),t&&(this.wasView=!0)}_onBeside({state:t}){const e=t&&!this.wasBeside;this.inBeside=t,this.onBeside({state:t,first:e}),t&&(this.wasBeside=!0)}_onFocus({state:t}){const e=t&&!this.wasFocus;this.inFocus=t,this.onFocus({state:t,first:e}),t&&(this.wasFocus=!0)}_onResize({force:t}={}){this.onResize({force:t})}_onOpen(t){this.isOpen=!0,this._syncStates(),this.onOpen(t)}_onClose(t){this.isOpen=!1,this._syncStates(),this.onClose(t)}_onPageLoad(){this.isPageLoaded=!0,this.onPageLoad()}_onWindowResize(){this.onWindowResize()}destroy(){this._clearEvents(),this.onDestroy()}}function Nt(){const t=flexbe_cli.vars._group.images||{},e=t.lazy;if(t.lazy_priority&&e){[".bg-image",".bg-element__fill--image",".component-image",".component-icon"].forEach((t=>function(t){const e=[...document.querySelectorAll(t)];e.length&&e.forEach((t=>t.dispatchEvent(new CustomEvent("setImage"))))}(t)))}}const jt={},Gt={},Yt={},Ut=t=>t.isClone?`${t.id}_clone${t.isClone}`:t.id,Qt=(t,e)=>{const i=Ut(t);Gt[i]||(Gt[i]=[]),Gt[i].includes(e)||Gt[i].push(e)};var Xt={registerComponents(t){Object.assign(jt,t)},init(){this.setGlobalInstance("links",xt.create()),h.on("entity_event.components_init",((t,e={})=>{const i=e.core;if(!e.type||!i||!i.id)return!1;("onInit"===e.type||"onUpdate"===e.type&&e.params.templateRendered)&&this.initComponents({core:i,reason:e.type})})),$(window).off("load.core_components").one("load.core_components",(()=>{const t=Object.values(Gt)||[];Nt(),t.forEach((t=>{t.forEach((t=>t._onPageLoad()))}))})),$(window).off("resized.core_components").on("resized.core_components",(()=>{(Object.values(Gt)||[]).forEach((t=>{t.forEach((t=>t._onWindowResize()))}))}))},getInstances:t=>Gt[Ut(t)]||[],initComponents({core:t,reason:e}={}){const{$area:i}=t,s=t.components;let o=!1;const n=Ut(t);if("onUpdate"===e&&Array.isArray(Gt[n])&&Gt[n].forEach((t=>t.destroy())),Gt[n]=[],null==s?o="[data-component]":Array.isArray(s)&&(o=s.map((t=>`[data-component="${t}"]`)).join(", ")),o){i.find(o).addBack(o).toArray().forEach(At((i=>{this.initComponent(i,t,e)})))}},initComponent(t,e,i="onInit"){let s=t.componentInstance;if(e||(e=t.closest("[data-id]")._core),s&&"onInit"===i)return Qt(e,s),s;const o=String(t.getAttribute("data-component")).trim(),[n,a]=o.split(":"),r=a?String(a).replace(/^\[|]$/g,"").split(","):[],l=jt[n];return"function"==typeof l&&(s=new l({args:r,component:t,core:e,reason:i}),s instanceof qt&&(t.componentInstance=s,s._onInit(),Qt(e,s))),s},getComponentClass:t=>jt[t],getGlobalInstance:t=>Yt[t],setGlobalInstance(t,e){Yt[t]=e}};class Kt{constructor(t,e,i){this.id=t,this.params=i,this.pending=!1,this.visible=!1,this.size=!1,this.imgSize={w:0,h:0},this.$outer=$(".parallax-outer",e),this.overlay=$(".overlay",e).get(0),this.canvas=$("canvas",this.$outer).get(0),this.offScreen=document.createElement("canvas"),this.overlayOpacity=+this.overlay.getAttribute("data-opacity"),this.factor="parallax"===i.parallax||"parallax-fade"===i.parallax?.3:0,this.zoomRatio="zoom"===i.parallax||"zoom-return"===i.parallax?.2:0,this.zoomType="zoom"===i.parallax||"zoom-return"===i.parallax?2:0,this.zoomD="zoom"===i.parallax?.5:"zoom-return"===i.parallax?1:0,this.fadeout="parallax-fade"===i.parallax?1:0;const s=window.devicePixelRatio>=1.5?1960/window.devicePixelRatio:1960,o=this.$outer.width(),n=this.$outer.height(),a=this.$outer[0].getBoundingClientRect().top+B.latest;this.blSize={w:o<=s?o:s},this.blSize.r=this.blSize.w/o,this.blSize.h=this.blSize.r*n,this.blSize.y=this.blSize.r*a,this.winSize={w:D.viewportWidth*this.blSize.r,h:D.viewportHeight*this.blSize.r},this.offCtx=this.offScreen.getContext("2d",{alpha:!1}),this.canvas.width=0,this.canvas.height=0,this.ctx=this.canvas.getContext("2d",{alpha:!1}),this.img=document.createElement("img"),this.position={x:+this.$outer.data("bg-pos-x").replace("%","")/100,y:+this.$outer.data("bg-pos-y").replace("%","")/100},this.dispatchEvents(),this.img.onload=()=>{this.loaded=!0,this.imgSize={w:this.img.width,h:this.img.height},this.imgSize.r=this.imgSize.h/this.imgSize.w,this.updateCanvasSource(),setTimeout((()=>{this.$outer.addClass("ready")}),30)},this.img.src=this.$outer.attr("data-image")}dispatchEvents(){$(window).off(`scroll.component-bg-${this.id}`).on(`scroll.component-bg-${this.id}`,(()=>{this.pending||B.skip||(this.pending=!0,this.updateInst())})),$(document).off(`documentresized.bg_${this.id}`).on(`documentresized.bg_${this.id}`,(()=>{this.updateCanvasSource()})),h.off(`entity_render.bg_${this.id}`).on(`entity_render.bg_${this.id}`,((t,e)=>{e.styleRendered&&e.entity&&e.entity.id===this.id&&(this.overlayOpacity=e.entity.data.background.opacity/100,this.pending||(this.pending=!0,this.updateInst()))})),h.off(`layout_change.bg_${this.id}`).on(`layout_change.bg_${this.id}`,(()=>{this.updateCanvasSource()}))}toggleRendering(t){if("boolean"!=typeof t)return!1;t!==this.visible&&(this.visible=t)}getCosPoint(t,e,i=1){return 1-t>i&&(t=i),(1-Math.cos(Math.PI*t*e))/2}getZoomCoords(t){let e=0;1===this.zoomType?e=t:-1===this.zoomType?e=100-t:2===this.zoomType&&(e=100-100*this.getCosPoint(.01*t,2,this.zoomD));const i={ratio:this.zoomRatio/100*e};return i.w=this.blSize.w*(1+i.ratio),i.h=this.blSize.h*(1+i.ratio),i.x=(i.w-this.canvas.width)/2,i.y=(i.h-this.blSize.h)/2,i}draw(t,e){let i;if(this.fadeout&&(i=1-(1-this.overlayOpacity)*this.getCosPoint(.01*e,2,this.fadeout)),this.zoomRatio){const s=this.getZoomCoords(e);requestAnimationFrame((()=>{this.overlay.style.opacity=i,this.ctx.drawImage(this.offScreen,Math.ceil(-1*s.x),Math.ceil(t*this.factor-this.winSize.h*this.factor-s.y),s.w,s.h),this.pending=!1}))}else{const e=Math.ceil((t-this.winSize.h)*this.factor);requestAnimationFrame((()=>{this.overlay.style.opacity=i,this.ctx.drawImage(this.offScreen,0,e),this.pending=!1}))}}updateInst(){if(this.winSize.y=window.pageYOffset/D.zoom*this.blSize.r,this.winSize.y+this.winSize.h>this.blSize.y-200&&this.winSize.y<this.blSize.y+this.blSize.h+200){this.toggleRendering(!0);const t=this.winSize.y+this.winSize.h-this.blSize.y,e=100-t/(this.blSize.h+this.winSize.h)*100;this.draw(t,e)}else this.toggleRendering(!1),this.pending=!1}prerender(){this.loaded&&(this.fitToOuter(),this.offScreen.width=this.blSize.w,this.offScreen.height=this.zoomRatio?this.blSize.h:Math.ceil(this.size.offH),this.drawOffscreenImage(this.position.x,this.position.y))}updateCanvasSource(){this.prerender(),this.updateInst()}drawOffscreenImage(t,e){(t="number"==typeof t?t:.5)<0&&(t=0),(e="number"==typeof e?e:.5)<0&&(e=0),t>1&&(t=1),e>1&&(e=1);const i=this.offCtx.canvas.width,s=this.offCtx.canvas.height;let o,n,a,r;s/i<=this.imgSize.r?(a=i,r=i*this.imgSize.r,o=0,n=(r-s)*e*-1):(r=s,a=s/this.imgSize.r,n=0,o=(a-i)*t*-1),this.offCtx.drawImage(this.img,o,n,a,r)}fitToOuter(){const t=window.devicePixelRatio>=1.5?1600:1960;this.blSize={w:this.$outer.width()<=t?this.$outer.width():t},this.blSize.r=this.blSize.w/this.$outer.width(),this.blSize.h=this.blSize.r*this.$outer.height(),this.blSize.y=this.blSize.r*(this.$outer[0].getBoundingClientRect().top+B.latest),this.winSize={w:D.viewportWidth*this.blSize.r,h:D.viewportHeight*this.blSize.r},this.canvas.width=this.blSize.w,this.canvas.height=this.blSize.h,this.canvas.style.transform=`scale(${1/this.blSize.r})`;const e=Math.max(this.winSize.h,this.blSize.h),i=e-(e-Math.min(this.winSize.h,this.blSize.h))*(this.blSize.h>this.winSize.h?this.factor:1-this.factor),s=i/this.blSize.w;let o;o=this.imgSize.r>=s?{w:this.blSize.w,h:this.blSize.w*this.imgSize.r}:{h:i,w:i/this.imgSize.r},o.offH=i,o.x=(o.w-this.blSize.w)/2,this.size=o}destroy(){this.destroyed=!0,$(window).off(`resize.${this.id} documentresize.${this.id}`),$(window).off(`scroll.component-bg-${this.id}`),h.off(`entity_render.bg_${this.id}`),this.$outer.removeClass("ready"),this.offScreen.remove(),this.img.remove()}}class Jt{constructor(t,e,i){this.background=t,this.$section=t.$component,this.video=e,this.sectionSize={width:t.owner._core.tween.width,height:t.owner._core.tween.height},this.sectionSize.res=this.sectionSize.width/this.sectionSize.height,"function"==typeof i&&(this.onStructured=i),this.parallax=this.$section[0].getAttribute("data-parallax"),this.fixed="fixed"===this.parallax||"modal"===this.background.owner._core.id,this.isDesktop=flexbe_cli.run.is_desktop,this.initVideo()}initVideo(){this.$container=$(`<div class="video_bg_container ${this.video.type}">\n                <div class="video_bg_player"></div>\n                <div class="video_bg_protect"></div>\n            </div>`),this.$playerOuter=this.$container.find(".video_bg_player"),this.$playerOverlay=this.$container.find(".video_bg_protect").first(),this.video.image&&this.$playerOverlay.css({backgroundImage:`url(${this.video.image})`}),"vimeo"===this.video.type?this.createVimeo():"youtube"===this.video.type?this.createYoutube():this.createMP4(),document.addEventListener("visibilitychange",(()=>{this.background.onscreen&&!document.hidden&&setTimeout((()=>{this.play()}),50)}))}createVimeo(){M(["https://player.vimeo.com/api/player.js"],(()=>{this.$videoElement=$(`<iframe src="https://player.vimeo.com/video/${this.video.id}?muted=1&controls=0&autopause=0&loop=1&autoplay=1&background=1" width="640" height="360" frameborder="0"></iframe>`),this.insertVideo(),this.vPlayer=new window.Vimeo.Player(this.$videoElement[0]),this.getVimeoResolution().then((t=>(this.video.size=p({res:t.width/t.height},t),this.resize(),!0))).catch((()=>{})),this.play()}))}createYoutube(){const t={videoId:this.video.id,playerVars:{cc_load_policy:0,iv_load_policy:3,autoplay:1,modestbranding:1,branding:0,wmode:"opaque",rel:0,mute:1,disablekb:1,color:"white",controls:0,showinfo:0,playsinline:1},events:{onReady:()=>{this.$videoElement=this.$playerOuter.find("iframe"),this.youtubeGetResolution(),this.resize(),this.play()},onStateChange:t=>{1!==t.data||this.videoIsLoaded?0===t.data&&this.play():(this.videoIsLoaded=!0,this.videoIsResized&&(this.$section.delay(100).addClass("video_is_loaded"),this.executed=!0))}}};if(window.YT||window.onYouTubeIframeAPIReady)if(window.onYouTubeIframeAPIReady)window.youtubeBGQuae.push((()=>{const e=$("<div></div>");this.insertVideo(e),this.yPlayer=new window.YT.Player(e[0],t)}));else{const e=$("<div></div>");this.insertVideo(e),this.yPlayer=new window.YT.Player(e[0],t)}else window.onYouTubeIframeAPIReady=()=>{window.youtubeBGQuae.forEach((t=>{t()})),window.youtubeBGQuae=null,window.onYouTubeIframeAPIReady=null},window.youtubeBGQuae=[],window.youtubeBGQuae.push((()=>{const e=$("<div></div>");this.insertVideo(e),this.yPlayer=new window.YT.Player(e[0],t)})),M(["https://www.youtube.com/iframe_api"])}createMP4(){this.$videoElement=$(`<video src="${this.video.url}" controlslist="nodownload" loop="1" muted="1" autoplay="1" playsinline="1"></video>`),this.insertVideo(),this.$videoElement[0].oncanplay=()=>{setInterval((()=>{this.videoIsLoaded=!0,this.videoIsResized&&this.$section.delay(100).addClass("video_is_loaded")}),50)},this.$videoElement.on("loadeddata",(()=>{this.video.size={res:this.$videoElement.width()/this.$videoElement.height()},this.resize()}))}getVimeoResolution(){const t=this.vPlayer;let e=0;return function i(){return Promise.all([t.getVideoWidth(),t.getVideoHeight()]).then((t=>{const[s,o]=t;return s/o<2.5&&s/o>.4||3===e?{width:s,height:o}:(e+=1,i())}))}()}youtubeGetResolution(){const t=this.$videoElement.attr("width"),e=this.$videoElement.attr("height");return this.video.size={width:t,height:e,res:t/e},this.video.size}insertVideo(t){this.$playerOuter.append(t||this.$videoElement),this.$section.append(this.$container),this.onStructured&&this.onStructured(this.$container)}resize(){if(this.video&&this.video.size)if(this.$videoElement.width(this.$videoElement.height()*this.video.size.res),this.fixed){const t={width:flexbe_cli.resize.viewportWidth,height:flexbe_cli.resize.viewportHeight};this.isDesktop||(t.height+=60,t.width+=60),t.res=t.width/t.height,this.video.size.res>t.res?(this.$videoElement.css({height:`${t.height}px`}),this.$videoElement.css({width:t.height*this.video.size.res+"px"})):(this.$videoElement.css({width:`${t.width}px`}),this.$videoElement.css({height:t.width/this.video.size.res+"px"}))}else{this.$section.hasClass("small_component_bg")?this.sectionSize={width:this.$section.width(),height:this.$section.height()}:this.sectionSize={width:this.background.owner._core.tween.width,height:this.background.owner._core.tween.height},this.sectionSize.res=this.sectionSize.width/this.sectionSize.height;const t=flexbe_cli.resize.viewportWidth/flexbe_cli.resize.viewportHeight;if(this.video.size.res>this.sectionSize.res||t<this.video.size.res&&this.parallax){const t=this.$playerOuter.height();this.$videoElement.css({height:`${t}px`}),this.$videoElement.css({width:t*this.video.size.res+"px"})}else{const t=this.$playerOuter.width();this.$videoElement.css({width:`${t}px`}),this.$videoElement.css({height:t/this.video.size.res+"px"})}}this.videoIsResized=!0,this.videoIsLoaded&&this.$section.delay(100).addClass("video_is_loaded")}play(){if("vimeo"===this.video.type){const t=setInterval((()=>{this.vPlayer&&this.vPlayer.play&&(setTimeout((()=>{this.vPlayer.play(),this.videoIsLoaded=!0,this.videoIsResized&&this.$section.delay(100).addClass("video_is_loaded")}),50),clearInterval(t))}),10)}else if("youtube"===this.video.type){const t=setInterval((()=>{this.yPlayer&&this.yPlayer.playVideo&&(this.yPlayer.playVideo(),clearInterval(t))}),10)}else this.$videoElement&&this.$videoElement[0]&&this.$videoElement[0].pause&&(this.$videoElement[0].play(),$(document).one("touchstart.video-bg",(()=>{this.$videoElement[0].play()})))}pause(){"vimeo"===this.video.type&&this.vPlayer?this.vPlayer.pause():"youtube"===this.video.type&&this.yPlayer&&this.yPlayer.pauseVideo?this.yPlayer.pauseVideo():this.$videoElement&&this.$videoElement[0]&&this.$videoElement[0].pause&&this.$videoElement[0].pause()}}const Zt=[800,1366,1920,2560];const te={};class ee{constructor(t){if(this.$legend=t.find(".range-legend"),this.$component=t.find(".range-outer"),this.$input=t.find("input"),this.startEdge=this.$component.data("start"),this.isDouble=!!this.$component.data("double"),this.endEdge=this.$component.data("end"),this.range=this.endEdge-this.startEdge,this.barWidth=this.$component.width(),this.step=this.$component.data("step")||1,this.steps=Math.round(this.range/this.step),this.legendType=this.$legend.data("type"),this.legendText=1==+this.$legend.data("text"),this.animated=!0,this.duration=this.steps<10&&1/this.steps*300,this.fractExponent=Math.max(this.getFract(this.startEdge),this.getFract(this.endEdge),this.getFract(this.step)),this.fractDevider=Math.pow(10,this.fractExponent),this.$value=$(".range-value",this.$component),this.$endRunner=$(".range-runner-right",this.$component),this.$endRunnerTip=$(".runner-tip",this.$endRunner),this.$endRunnerValue=$(".value",this.$endRunner),this.endRunnerWidth=this.$endRunner.width(),this.$startRunner=$(".range-runner-left",this.$component),this.$startRunnerValue=$(".value",this.$startRunner),this.$startRunnerTip=$(".runner-tip",this.$startRunner),this.startRunnerWidth=this.$startRunner.width(),this.maxAllowedLeft=20,this.maxAllowedRight=D.viewportWidth-20,this.defaultShift=this.$endRunner.width()/2,this.activeRunner=!1,this.isDouble){const t=this.$input.data("value").split("  ");this.startValue=+t[0],this.endValue=+t[1]}else this.endValue=+this.$input.data("value"),this.startValue=+this.startEdge;this.endParams={},this.drawLegend(),this.updateTooltip(this.$startRunnerTip),this.updateTooltip(this.$endRunnerTip),this.setEvents(),this.setRunnersValue()}formatN(t){return`${t<0?"-":""}${X.formatNumber(t,this.fractExponent)}`}getFract(t){const e=`${t}`.split(".");return e[1]&&e[1].length||0}drawLegend(){if(this.legendText)return!1;const t=this.$legend.find(".from"),e=this.$legend.find(".to");if(t.text(this.formatN(this.startEdge)),e.text(this.formatN(this.endEdge)),"complex"!==this.legendType)return!1;this.$legend.find(".legend-point:not(.from, .to)").off("click").remove(),this.$legend.removeClass("complex").addClass("limits");const i=[`${this.formatN(this.startEdge)}`.length,`${this.formatN(this.endEdge)}`.length,`${this.formatN(this.step)}`.length],s=(i[0]+i[1]+i[2])/3,o=Math.max(this.startEdge,this.endEdge),n=[5*this.step*this.fractDevider/this.fractDevider];for(let t=1;t<=12;t++){const e=10**t*this.step;e<o&&u(n,e,this.fractDevider)}let a;const r=Math.ceil(this.$legend.find(i[0]>i[1]?".from":".to").width()/Math.max(i[1],i[0])),l=Math.round(.83*this.barWidth/(r*s)),d=this.range>0?1:-1;for(let t=Math.min(l,10);t>=3;t--){const e=h(this.step,Math.abs(this.steps),t,n);if(e&&Number.isInteger(e/this.step)&&Number.isInteger(this.range/e)){a=e;break}}if(!a||!Number.isInteger(this.range/(a*d))||this.range/(a*d)<3)for(let t=Math.min(Math.round(this.range/this.step),l,10);t>=2;t-=1){const e=this.roundFraction(this.range/t);if(e%this.step==0){a=e*d;break}}const c=this.roundFraction(this.range/(a*d));if(a&&Number.isInteger(c)){const t=[];for(let e=1;e<c;e+=1){const i=Math.round((this.startEdge+a*e*d)*this.fractDevider)/this.fractDevider;t.push(`<div class="legend-point" data-value="${i}">${this.formatN(i)}</div>`)}c>2&&(this.$legend.attr("data-count",c),this.$legend.removeClass("limits").addClass("complex"));const e=$(t.join(""));this.$legend.find(".from").after(e)}else this.$legend.removeClass("complex").addClass("limits");function h(t,e,i,s){return s.includes(e/i*t)?e/i*t:s.includes((e+1)/i*t)?(e+1)/i*t:s.includes((e+2)/i*t)?(e+2)/i*t:s.includes((e+3)/i*t)?(e+3)/i*t:s.includes((e+4)/i*t)?(e+4)/i*t:s.includes((e+5)/i*t)?(e+5)/i*t:s.includes((e+6)/i*t)?(e+6)/i*t:s.includes((e+7)/i*t)?(e+7)/i*t:s.includes((e+8)/i*t)?(e+8)/i*t:!!s.includes((e+9)/i*t)&&(e+9)/i*t}function u(t,e,i){for(let s=1;s<10;s+=1)t.push(Math.round(e*s*i)/i),t.push(Math.round(e*s*i+e/2)/i)}this.$legend.find(".legend-point:not(.to), .legend-point:not(.from)").each(((t,e)=>{$(e).on("click",(()=>{if(this.updateBarWidth(),this.isDouble){const t=(this.startValue+this.endValue)/2,i=+$(e).data("value"),s=this.startEdge<this.endEdge?1:-1;i*s>=t*s?this.endValue=i:this.startValue=i}else this.endValue=$(e).data("value");this.setRunnersValue()}))}))}roundFraction(t){return Math.round(1e10*t)/1e10}setRunnersValue(t=!1){if(!Number.isFinite(this.endValue)||!Number.isFinite(this.range)||this.isDouble&&!Number.isFinite(this.startValue))return!1;const e=this.startEdge<this.endEdge?1:-1;"start"===this.activeRunner?this.startValue*e<=this.startEdge*e?this.startValue=this.startEdge:this.startValue*e>=this.endValue*e&&(this.startValue=this.endValue):this.endValue*e>=this.endEdge*e?this.endValue=this.endEdge:this.endValue*e<=this.startValue*e&&(this.endValue=this.startValue);const i=this.isDouble?this.startValue:this.startEdge,s=this.isDouble?(this.startValue-this.startEdge)/(this.range/100):0,o=(this.endValue-i)/(this.range/100);this.endValue=Math.round(this.endValue*this.fractDevider)/this.fractDevider,this.startValue=Math.round(this.startValue*this.fractDevider)/this.fractDevider,requestAnimationFrame((()=>{this.$endRunnerValue.text(this.formatN(this.endValue)),this.$startRunnerValue.text(this.formatN(this.startValue))})),"end"===this.activeRunner?this.updateTooltip(this.$endRunnerTip):this.updateTooltip(this.$startRunnerTip),this.$value.css({width:`${o}%`,marginLeft:`${s}%`}),t||(this.isDouble?this.$input.val(`${this.startValue}  ${this.endValue}`):this.$input.val(this.endValue))}updateTooltip(t){const e=t.closest(".range-runner");if(e&&e.length){const e=t.innerWidth(),i=t.closest(".range-runner")[0].getBoundingClientRect().left+this.startRunnerWidth/2;let s;s=e/2>i+this.maxAllowedLeft?e/2-(i-this.maxAllowedLeft):e/2+i>this.maxAllowedRight?this.maxAllowedRight-i-e/2:0,t.css({transform:`translateX(${s}px)`})}}getValueFromLength(t){const e=this.range/(this.barWidth/t);return(Math.round(e/this.step)+this.startEdge/this.step)*this.step}applyEndPosition(t){return this["start"===this.activeRunner?"startValue":"endValue"]=this.getValueFromLength(t),this.setRunnersValue(),!0}touchHendler(t){if(!this.endParams.active||1!==t.touches.length)return $("body")[0].removeEventListener("touchmove",this.touchHendler),!1;this.toggleAnimation(!1),t.preventDefault(),t.stopPropagation();const e=t.touches[0].pageX-this.endParams.left-this.endParams.shift;this.applyEndPosition(e)}startWatchingEvents(t=this.defaultShift){this.endParams={active:!0,left:this.$component.offset().left,shift:t},clearTimeout(this.calmRunnersTimeout),"end"===this.activeRunner?this.$endRunner.addClass("active"):this.$startRunner.addClass("active")}toggleAnimation(t){t?Math.abs(this.barWidth/this.steps)<15?this.$component.addClass("animated"):(this.$component.removeClass("active-animation"),this.duration&&this.$component.removeClass("animation-speed-"+(12-Math.abs(Math.round(this.steps))))):Math.abs(this.barWidth/this.steps)<15?this.$component.removeClass("animated"):(this.$component.addClass("active-animation"),this.duration&&this.$component.addClass("animation-speed-"+(12-Math.abs(Math.round(this.steps)))))}afterRunnerReleased(){this.endParams.active&&("start"===this.activeRunner?this.$startRunner.focus():this.$endRunner.focus()),this.endParams.active=!1,this.debounceActive(),this.barWidth/this.steps<15?this.$component.addClass("animated"):this.$component.removeClass("active-animation"),this.toggleAnimation(!0)}updateBarWidth(){const t=this.$component.width();t!==this.barWidth&&(this.barWidth=t,"complex"===this.legendType&&this.drawLegend())}setEvents(){const t=$(window),e=this;function i(i){if(!e.endParams.active)return t.off("mousemove.dragRange"),!1;e.toggleAnimation(!1);const s=i.pageX-e.endParams.left-e.endParams.shift;return e.applyEndPosition(s),!0}this.$component.on("resized",(()=>{this.updateBarWidth()})),this.$component.on("touchstart",(e=>{if(1!==e.touches.length)return!1;if(this.isDouble){const t=(this.$endRunner.offset().left+this.$startRunner.offset().left)/2;this.activeRunner=e.touches[0].pageX>=t?"end":"start","start"===this.activeRunner?(this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner")):(this.$endRunner.addClass("upper-runner"),this.$startRunner.removeClass("upper-runner"))}else this.activeRunner="end";e.stopPropagation(),this.updateBarWidth();const i=e.touches[0].pageX-this.$value.offset().left;this.startWatchingEvents(),this.applyEndPosition(i-this.defaultShift),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",(()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")}))})),this.$component.on("mousedown",(e=>{const s=e.pageX-this.$component.offset().left;if(this.isDouble){const t=(this.$endRunner.offset().left+this.$startRunner.offset().left)/2;this.activeRunner=e.pageX>=t?"end":"start","start"===this.activeRunner?(this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner")):(this.$endRunner.addClass("upper-runner"),this.$startRunner.removeClass("upper-runner"))}this.updateBarWidth(),this.startWatchingEvents(),this.applyEndPosition(s-this.defaultShift),"start"===this.activeRunner?this.$startRunner.focus():this.$endRunner.focus(),t.on("mousemove.dragRange",i),t.on("mouseup.range",(()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")}))})),this.$endRunner.on("touchstart",(e=>{if(1!==e.touches.length)return!1;e.stopPropagation(),this.updateBarWidth(),this.activeRunner="end",this.$startRunner.removeClass("upper-runner"),this.$endRunner.addClass("upper-runner"),e.stopPropagation(),this.startWatchingEvents(e.touches[0].pageX-this.$endRunner.offset().left),this.toggleAnimation(!1),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",(()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")}))})),this.$startRunner.on("touchstart",(e=>{if(1!==e.touches.length)return!1;e.stopPropagation(),this.updateBarWidth(),this.activeRunner="start",this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner"),e.stopPropagation(),this.startWatchingEvents(e.touches[0].pageX-this.$startRunner.offset().left),this.toggleAnimation(!1),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",(()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")}))})),this.$endRunner.on("mousedown",(e=>{e.stopPropagation(),this.activeRunner="end",this.$startRunner.removeClass("upper-runner"),this.$endRunner.addClass("upper-runner"),this.updateBarWidth(),this.$endRunner.focus(),this.startWatchingEvents(e.pageX-this.$endRunner.offset().left),this.toggleAnimation(!1),t.on("mousemove.dragRange",i),t.on("mouseup.range",(()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")}))})),this.$startRunner.on("mousedown",(e=>{e.stopPropagation(),this.activeRunner="start",this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner"),this.updateBarWidth(),this.$startRunner.focus(),this.startWatchingEvents(e.pageX-this.$startRunner.offset().left),this.toggleAnimation(!1),t.on("mousemove.dragRange",i),t.on("mouseup.range",(()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")}))})),this.$legend.find(".legend-point.to, .legend-point.from").each(((t,e)=>{$(e).on("click",(()=>{if(this.updateBarWidth(),this.isDouble){const t=this.startEdge<this.endEdge?1:-1,i=(this.startValue+this.endValue)/2,s=+$(e).data("value");s*t>=i*t?this.endValue=s:this.startValue=s}else this.endValue=$(e).data("value");this.setRunnersValue()}))})),this.$input.on("change",(()=>{if(this.isDouble){const t=this.$input.val().split("  ");this.startValue=+t[0],this.endValue=+t[1]}else this.endValue=+this.$input.val();this.setRunnersValue(!0)})),this.$startRunner.on("keyup",(t=>{t.preventDefault(),this.activeRunner="start",this.handleKeydown(t,this.$startRunner)})),this.$endRunner.on("keyup",(t=>{t.preventDefault(),this.activeRunner="end",this.handleKeydown(t,this.$endRunner)})),this.$startRunner.on("keydown",(t=>{this.activeRunner="start",this.handleKeyup(t,this.$startRunner)})),this.$endRunner.on("keydown",(t=>{this.activeRunner="end",this.handleKeyup(t,this.$endRunner)})),this.$startRunner.on("blur",(()=>{this.handleBlur()}))}handleBlur(){this.movingInterval&&(clearInterval(this.movingInterval),this.movingInterval=!1),this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1)}handleKeydown(t,e){if(this.movingInterval&&(clearInterval(this.movingInterval),this.movingInterval=!1),this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1),[37,38,39,40].includes(t.keyCode)){const i=t.shiftKey?10:1,s="start"===this.activeRunner?"startValue":"endValue";38===t.keyCode||39===t.keyCode?this[s]=(this[s]/this.step+i)*this.step:37!==t.keyCode&&40!==t.keyCode||(this[s]=(this[s]/this.step-i)*this.step),e.addClass("active"),this.debounceActive(),this.setRunnersValue()}}handleKeyup(t,e){9!==t.keyCode&&[37,38,39,40].includes(t.keyCode)&&(t.preventDefault(),e.addClass("active"),this.debounceActive(),this.startDebouncedMove(t))}startDebouncedMove(t){this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1),this.movingDebounceTimeout=setTimeout((()=>{this.movingInterval=setInterval((()=>{this.debounceActive();const e=t.shiftKey?10:1,i="start"===this.activeRunner?"startValue":"endValue";38===t.keyCode||39===t.keyCode?this[i]=(Math.round(this[i]/this.step)+e)*this.step:37!==t.keyCode&&40!==t.keyCode||(this[i]=(Math.round(this[i]/this.step)-e)*this.step),this.setRunnersValue()}),50)}),300)}debounceActive(){this.calmRunnersTimeout&&clearTimeout(this.calmRunnersTimeout),this.calmRunnersTimeout=setTimeout((()=>{this.$endRunner.removeClass("active"),this.$startRunner.removeClass("active")}),500)}}const ie={selectClass:"",dropdownClass:"",selectedClass:"selected",optionSelector:"option",attrValue:"value",position:"over",title:!1};class se{static create(t){return new this(t)}constructor(t){this.opts=t,this.config=p({},ie,t.config),this.element=t.element,this.$select=$(this.element),this.isNativeSelect=this.$select.is("select"),this.selectAllDevice="select"===this.$select.data("type"),this.blurTimeOut=!1,this.blurListTimeOut=!1,this.focused=!1,this.active=!1,this.createSelect()}createSelect(){this.$customSelect=$(`\n                <div class="dropdown-container ${this.config.selectClass}">\n                    <div tabindex="0" class="dropdown-select">\n                        <span class="dropdown-select__content selected"></span>\n\n                        <span class="arrow">\n                            <svg viewBox="0 0 10 6" xmlns="http://www.w3.org/2000/svg">\n                                <path fill="currentColor" d="M 1.4 6.99441e-15L 0 1.34043L 5 6L 10 1.34043L 8.6 0L 5 3.34998L 1.4 6.99441e-15Z"/>\n                            </svg>\n                        </span>\n                    </div>\n                </div>\n            `),this.$customSelect__content=this.$customSelect.find(".dropdown-select__content"),this.$select.after(this.$customSelect),this.syncSelect(),this.selectAllDevice||flexbe_cli.run.is_screen_desktop||!flexbe_cli.responsive?(this.$customSelect.off("click.selected").on("click.selected",".dropdown-select",(()=>{clearTimeout(this.blurListTimeOut),this.active?this.collapse():this.activate()})),this.$customSelect.off("focus.selectFocus").on("focus.selectFocus",".dropdown-select",(()=>{this.focused=!0,this.$listWrapper||this.createList()})),this.isNativeSelect&&this.$select.off("change.changeSelect").on("change.changeSelect",(t=>{const e=this.$listWrapper.find(".dropdown-select-ul li"),i=t.currentTarget.value;e.removeClass(this.config.selectedClass),e.filter(((t,e)=>e.getAttribute(this.config.attrValue)===i)).addClass(this.config.selectedClass),this.$customSelect__content.text(i),"function"==typeof this.opts.onChange&&this.opts.onChange(t)})),this.$customSelect.off("keydown.selectKeydown").on("keydown.selectKeydown",".dropdown-select",(t=>{if(this.focused&&[13,27,32,38,40].includes(t.keyCode)){t.preventDefault();const e=this.$list.find(`.option-e.${this.config.selectedClass}`).filter((t=>!$(t).attr("disabled")));if(40===t.keyCode)t.preventDefault(),this.select(e.next(),!1),this.scrollToSelected();else if(38===t.keyCode)t.preventDefault(),this.select(e.prev(),!1),this.scrollToSelected();else if(this.active||32!==t.keyCode){if(this.active&&[13,27,32].includes(t.keyCode))return t.preventDefault(),this.collapse(),!1}else t.preventDefault(),this.activate()}}))):this.$select.off("change.selected").on("change.selected",(t=>{const e=t.target.value;this.$customSelect__content.text(e)}))}syncSelect(){const t=this.$select.children(this.config.optionSelector).filter(((t,e)=>{var i;return(null!=(i=e.selected)?i:$(e).attr("selected"))||$(e).hasClass(this.config.selectedClass)})).eq(0),e=t.html()||"";this.$customSelect__content.attr(this.config.attrValue,t.attr(this.config.attrValue)),this.$customSelect__content.html(e)}createList(){const t=this.$select.children(this.config.optionSelector);this.$listWrapper=$(`\n            <div class="select-container-in-body">\n                <div class="overlay"></div>\n                <ul class="dropdown-select-ul scrollable ${this.config.dropdownClass}" tabindex="0"></ul>\n            </div>\n        `),this.$list=this.$listWrapper.find(".dropdown-select-ul"),t.each(((t,e)=>{var i,s,o;const n=$(e),a=(null!=(i=e.selected)?i:n.attr("selected"))||n.hasClass(this.config.selectedClass),r=(null!=(s=e.disabled)?s:n.attr("disabled"))||n.hasClass("disabled"),l=(null!=(o=e.locked)?o:n.attr("locked"))||n.hasClass("locked"),d=this.isNativeSelect?n.val():n.attr(this.config.attrValue),c=n.html().trim()||"";let h="";this.config.title&&(h=n.attr("data-title"));const u=$(`<li title='${h}' class="option-e"></li>`);a&&!r&&u.addClass(this.config.selectedClass),r&&u.attr("disabled","disabled"),l&&u.attr("locked","locked"),u.attr(this.config.attrValue,d),u.html(c),this.$list.append(u)}))}select(t,e){if(!t[0])return;if(t.attr("disabled"))return clearTimeout(this.blurTimeOut),void this.$list.off("blur.listBlur").on("blur.listBlur",(()=>{this.focused=!1,this.blurListTimeOut=setTimeout((()=>{this.$listWrapper&&this.collapse()}),200)}));const i=t.attr(this.config.attrValue);if(t.siblings("li").removeClass(this.config.selectedClass),t.addClass(this.config.selectedClass),this.isNativeSelect)this.$select.val(i);else{const t=this.$select.children(this.config.optionSelector);t.removeAttr("selected").removeClass(this.config.selectedClass),t.filter(`[${this.config.attrValue}=${i}]`).addClass(this.config.selectedClass).attr("selected","selected")}this.syncSelect(),e&&this.collapse()}scrollToSelected(){const t=this.$list[0].offsetHeight;if(this.$list[0].scrollHeight<=t)return!1;const e=this.$list.children(".option-e").find(`.${this.config.selectedClass}`)[0];e&&e.scrollIntoView()}collapse(){clearTimeout(this.blurTimeOut),this.active=!1,this.$listWrapper.removeClass("active rise"),this.$listWrapper.detach(),"function"==typeof this.opts.onCollapse&&this.opts.onCollapse()}activate(){if(this.active)return!1;this.active=!0,this.createList();const t={left:this.$customSelect.offset().left,top:this.$customSelect.offset().top,width:this.$customSelect.width()};"under"===this.config.position&&(t.top=t.top+this.$customSelect.height()+10),this.$listWrapper.off("click.closeSelect").on("click.closeSelect",".overlay",(t=>{this.collapse(),document.elementFromPoint(t.clientX,t.clientY).focus()})),this.$listWrapper.off("click.selectLi").on("click.selectLi",".dropdown-select-ul li",(t=>{const e=$(t.currentTarget);this.select(e,!0),"function"==typeof this.opts.onSelect&&this.opts.onSelect(t)})),this.$listWrapper.off("mousewheel.selectUl").on("mousewheel.selectUl",".dropdown-select-ul",(t=>{const e=t.currentTarget.scrollHeight,i=t.currentTarget.clientHeight;return!(t.currentTarget.scrollTop===e-i&&t.deltaY>0||0===t.currentTarget.scrollTop&&t.deltaY<0)})),$("body").append(this.$listWrapper),clearTimeout(this.blurTimeOut),this.$list.css({left:`${t.left}px`,top:`${t.top}px`,width:`${t.width}px`}),this.$listWrapper.toggleClass("rise",!!this.$select.closest(".m_modal, .w_widget").length),this.$listWrapper.addClass("active"),this.scrollToSelected(),"function"==typeof this.opts.onActivate&&this.opts.onActivate()}}const oe=new Array(70).fill(1).map(((t,e)=>50+50*e));class ne extends qt{constructor(...t){super(...t),u(this,"mapScripts",[]),u(this,"mapScriptsLoaded",!1),this.is="map",this.data=this.$component.data("data"),this.$component.removeAttr("data-data")}onInit(){this.isUpdated&&this.mapScriptsLoaded&&this.createMap()}async onBeside({state:t}){if(!t||this.isCreated||this.isLoading)return!1;await this.loadMapScripts(),this.createMap()}onOpen(){this.isCreated&&this.fitToViewport()}onResize(){this.isCreated&&this.fitToViewport()}async loadMapScripts(){return this.isLoading=!0,new Promise((t=>flexbe_cli.require(this.mapScripts,(()=>{this.isLoading=!1,this.mapScriptsLoaded=!0,t()}))))}createMap(){this.isCreated=!0}fitToViewport(){}}class ae extends ne{constructor(...t){super(...t);const e=flexbe_cli.vars._group.googleMapsKey,i=le({provider:"google"})||"ru";this.mapScripts=[`https://maps.googleapis.com/maps/api/js?key=${e}&language=${i}`]}createMap(){"undefined"!=typeof google&&(super.createMap(),this.createVendor(),this.styleMap(),this.setPlaces(),this.dispatchEvents(),this.fixBehavior(),this.$component.trigger("mapInit"),this.$component.removeClass("loading"))}createVendor(){const{data:t}=this;this.map=new google.maps.Map(this.$component.find(".map")[0],{center:{lat:t.center[0],lng:t.center[1]},zoom:t.zoom,disableDefaultUI:!0,panControl:!0,zoomControl:!0,fullscreenControl:!0,mapTypeControl:!1,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1})}dispatchEvents(){const{$component:t,map:e}=this;let i=!1;e&&(t.on("selectMark",((t,e)=>{this.selectMark(e,!0)})),this.$component.on("mousedown",(()=>{i=!0,this.$component.trigger("preventSliderMove",{state:!0}),this.$component.trigger("preventSliderAutoplay",{state:!0})})),$(window).on("mouseup",(()=>{i&&(this.$component.trigger("preventSliderMove",{state:!1}),this.$component.trigger("preventSliderAutoplay",{state:!1}),i=!1)})))}fitToViewport(){const{map:t}=this;t&&google.maps.event.trigger(t,"resize")}setPlaces(){const{data:t,map:e}=this;e&&t.places.forEach(((t,i)=>{const s=`<svg width="32" height="48" viewBox="0 0 24 32" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36 0 0 5.36 0 12c0 8 12 20 12 20s12-12 12-20c0-6.64-5.36-12-12-12zm0 8a4 4 0 0 1 4 4c0 2.22-1.78 4-4 4a4 4 0 0 1-4-4c0-2.2 1.8-4 4-4z" fill="${t.color||"#222"}" fill-rule="evenodd"/></svg>`,o=new google.maps.Marker({position:{lat:t.coords[0],lng:t.coords[1]},map:e,visible:!0,animation:google.maps.Animation.DROP,icon:{url:`data:image/svg+xml;charset=UTF-8,${encodeURIComponent(s)}`}});t._mark=o,o.addListener("click",(()=>{this.selectMark(i)}))}))}styleMap(){const{data:t,map:e}=this;if(e)if("default"!==t.style&&t.style){const i=`/_s/lib/google/maps/styles/${t.style}.json`;$.getJSON(i,(t=>{t&&Array.isArray(t)&&e.setOptions({styles:t})}))}else e.setOptions({styles:[]})}selectMark(t,e=!1){const{data:i,map:s}=this,{places:o}=i;if(!(s&&o&&o.length&&o[t]))return;o.forEach((t=>t._info&&t._info.close()));const n=o[t];let a="";n.name&&(a+=`<div style="margin-bottom: 3px;"><strong>${n.name}</strong></div>`),n.address&&(a+=`<div>${n.address}</div>`),n._info=new google.maps.InfoWindow({content:a}),n._info.open(s,n._mark),e&&s.panTo({lat:n.coords[0],lng:n.coords[1]}),this.$component.trigger("balloonOpen",t,n)}fixBehavior(){const{$component:t,map:e}=this;if(!e)return;let i;t.off("mouseenter.preventzoom").on("mouseenter.preventzoom",(()=>{i=setTimeout((()=>{e.setOptions({scrollwheel:!0})}),500)})),t.off("mouseleave.preventzoom").on("mouseleave.preventzoom",(()=>{i&&(clearTimeout(i),e.setOptions({scrollwheel:!1}))}))}}class re extends ne{constructor(...t){super(...t);const e=le({provider:"yandex"})||"ru_RU",i=flexbe_cli.vars._group.yandexMapsKey?`&apikey=${flexbe_cli.vars._group.yandexMapsKey}`:"";this.mapScripts=[`https://api-maps.yandex.ru/2.1/?lang=${e}${i}`]}fitToViewport(){const{map:t}=this;t&&t.container.fitToViewport()}createMap(){"undefined"!=typeof ymaps&&(super.createMap(),ymaps.ready((()=>{this.createVendor(),this.setPlaces(),this.dispatchEvents(),this.fixBehavior(),this.$component.trigger("mapInit"),this.$component.removeClass("loading")})))}createVendor(){this.map&&this.map.destroy(),this.map=new ymaps.Map(this.$component.find(".map")[0],{center:this.data.center,zoom:this.data.zoom,controls:["zoomControl"],behaviors:["default","scrollZoom"],type:"yandex#map"})}setPlaces(){const{map:t,data:e}=this;if(!t)return;t.geoObjects.removeAll();const i=ymaps.templateLayoutFactory.createClass('<svg title="$[properties.balloonContent]" class="placemark" width="32" height="48" viewBox="0 0 24 32" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36 0 0 5.36 0 12c0 8 12 20 12 20s12-12 12-20c0-6.64-5.36-12-12-12zm0 8a4 4 0 0 1 4 4c0 2.22-1.78 4-4 4a4 4 0 0 1-4-4c0-2.2 1.8-4 4-4z" fill="$[properties.color]" fill-rule="evenodd"/></svg>');ymaps.layout.storage.get("custom#placemark")||ymaps.layout.storage.add("custom#placemark",i),e.places.forEach(((e,i)=>{e.color=e.color||"#3D52B0";const s=new ymaps.Placemark(e.coords,{balloonContentHeader:e.name||!1,balloonContent:e.address,color:e.color},{hideIconOnBalloonOpen:!1,balloonOffset:[0,-48],balloonCloseButton:!1,iconLayout:"custom#placemark",iconShape:{type:"Rectangle",coordinates:[[-16,-48],[16,0]]}});s.events.add("balloonopen",(()=>{this.$component.trigger("balloonOpen",i,e)})),t.geoObjects.add(s),e._mark=s}))}dispatchEvents(){const{data:t,map:e}=this;let i=!1;e&&(this.$component.on("selectMark",(async(i,s)=>{if(t.places.length&&t.places[s]){const i=t.places[s];await e.setCenter(i.coords,t.zoom,{duration:350,checkZoomRange:!0}),await e.setCenter(i.coords),i._mark&&i._mark.balloon.open()}})),this.$component.on("mousedown",(()=>{i=!0,this.$component.trigger("preventSliderMove",{state:!0}),this.$component.trigger("preventSliderAutoplay",{state:!0})})),$(window).on("mouseup",(()=>{i&&(this.$component.trigger("preventSliderMove",{state:!1}),this.$component.trigger("preventSliderAutoplay",{state:!1}),i=!1)})))}fixBehavior(){const{map:t}=this;if(!t)return;let e;t.behaviors.disable("scrollZoom"),this.$component.off("mouseenter.preventzoom").on("mouseenter.preventzoom",(()=>{e=setTimeout((()=>{t.behaviors.enable("scrollZoom")}),500)})),this.$component.off("mouseleave.preventzoom").on("mouseleave.preventzoom",(()=>{e&&(clearTimeout(e),t.behaviors.disable("scrollZoom"))})),flexbe_cli.run.is_mobile&&t.behaviors.disable("drag")}}const le=({lang:t,provider:e})=>{const i=t||X.language,s={yandex:{ru:"ru_RU",by:"ru_RU",ge:"ru_RU",kz:"ru_RU",ua:"uk_UA",default:"en_US"},google:{ru:"ru",by:"be",ge:"ru",kz:"kk",ua:"uk",fr:"fr",pl:"pl",de:"de",es:"es",it:"it",default:"en"}};return!!s[e]&&(s[e][i]||s[e].default)};class de{constructor(t,e){e=p({init:!0,targets:"span",active:0},e),"object"==typeof t&&t.querySelectorAll&&(Array.isArray(e.targets)||e.targets instanceof NodeList||e.targets instanceof HTMLCollection?this.targets=Array.from(e.targets):this.targets=Array.from(t.querySelectorAll(e.targets)),this.pagination=t,this.options=e,this.active=e.active,this.visible=e.visible||+t.getAttribute("data-bullets-visible"),this.visible||(this.visible=this.targets.length>=8?3:this.targets.length),this.init())}init(){this.bindEvents(),this.options.init&&this.setActive(this.active,!0)}bindEvents(){const{targets:t,options:e}=this,i=$(t);"function"==typeof e.onClick&&i.off(".bpc").on("click.bpc",(t=>{const s=$(t.currentTarget),o=+i.filter('[data-state="active"]').attr("data-index"),n=+s.attr("data-index");e.onClick(n,o)}))}setActive(t,e){const{targets:i,active:s}=this;let o,n,{oldMap:a,newMap:r}=this;if(!i.length)return t;t=Math.max(Math.min(t,i.length-1),0),a=a&&a.length?a:i.map((t=>{const e=t.getAttribute("data-state")||"hidden";return{target:t,state:e}}));if((e?0:a.reduce(((t,{state:e})=>t+(ue(e)?1:0)),0))!==this.visible)n=Math.min(t+this.visible-1,i.length-1),o=Math.max(n-this.visible+1,0),r=a.map((({target:t,state:e},i)=>({target:t,state:i>=o&&i<=n?"normal":"hidden"})));else{const e=pe({from:s,to:t,map:a});r=a.map((({target:t,state:i},s)=>{const r=a[s-e];return"normal"===(i=r&&r.state&&ue(r.state)?"normal":"hidden")&&(void 0===o&&(o=s),n=s),{target:t,state:i}}))}return r[t].state="active",r[o-1]&&(r[o-1].state="next"),r[o-2]&&(r[o-2].state="more"),r[n+1]&&(r[n+1].state="next"),r[n+2]&&(r[n+2].state="more"),i.forEach(((t,e)=>{t.setAttribute("data-state",r[e].state)})),this.active=t,this.oldMap=r,t}}class ce{constructor(t,e){e=p({init:!0,targets:"span"},e),this.options=e,this.pagination=t,this.tag=this.options.tag,this.filled=!1,this.states=["hidden","more","next","active","next","more","hidden"],this.init()}init(){this.bindEvents(),this.options.init&&this.fillPagination({states:this.states,force:!0})}bindEvents(){const{tag:t,pagination:e,options:i}=this,s=$(e);"function"==typeof i.onClick&&s.off(".bpc").on("click.bpc",t,(t=>{const e=$(t.currentTarget),s=+e.siblings('[data-state="active"]').attr("data-index"),o=+e.attr("data-index")-s;i.onClick(o)}))}setActive(t){const e=this.states,i=this.filled&&t;if(this.fillPagination({states:e,force:!0}),i){const i=e.map(((i,s)=>e[s+("prev"===t?1:-1)]||"hidden"));requestAnimationFrame((()=>{this.fillPagination({states:i})}))}}fillPagination({states:t,force:e}={}){const i=$(this.pagination),s=this.tag;if(this.filled=!0,e){const e=t.reduce(((t,e,i)=>`${t}<${s} data-index="${i}" class="swiper-pagination-bullet" data-state="${e}"></${s}>`),"");i.html(e)}else i.find(s).each(((e,i)=>{const s=$(i);s.attr("data-state",t[e]||"hidden"),s.attr("data-index",e)}))}}function he(t,e,i,s={}){const o=$(t),n=e?`[data-component="${e}"]`:"[data-component]";o.is(n)?o.trigger(i,s):$(t).find(n).each(((t,e)=>{$(e).trigger(i,s)}))}function ue(t){return["normal","active"].includes(t)}function pe({from:t,to:e,map:i,move:s=0}){const o=i[e-s],n=o&&ue(o.state);return!o||n?s:t<e?pe({from:t,to:e,map:i,move:s+1}):e<t?pe({from:t,to:e,map:i,move:s-1}):s}const me=$({});class fe{static getRecaptchaSettings(){const t=p({env:{}},flexbe_cli.vars._group.flood&&flexbe_cli.vars._group.flood.captcha||{});return!t.visible&&flexbe_cli.is_admin&&(t.enabled=0),t}constructor(t,e=fe.getRecaptchaSettings()){this.id=t.id,this.options=t,this.$form=t.$form,this.enabled=e.enabled,this.isOptional=e.ttl>0,this.isVisible=e.visible,this.isInvisible=!e.visible,this.inModal=!(!this.isVisible||!this.isOptional&&!t.inModal),this._widgetId=null,this._token=null}get loaded(){return"undefined"!=typeof grecaptcha}get recaptchaSiteKey(){const{env:t}=fe.getRecaptchaSettings();return this.isVisible?t.RECAPTCHA_VISIBLE_SITE_KEY:t.RECAPTCHA_INVISIBLE_SITE_KEY}init(){if(!this.enabled||!this.loaded||this._inited)return;this._inited=!0;const t=this.$form.find(".g-recaptcha-"+(this.isVisible?"visible":"invisible"));t[0]&&this.render(t[0])}getToken(){return this._token}render(t){if(!this.enabled||!this.loaded)return;let e=flexbe_cli.run.is_screen_mobile_s?"compact":"normal";this.isInvisible&&(e="invisible");const i={size:e,sitekey:this.recaptchaSiteKey,callback:t=>{this._token=t,this.closeModal(),this._onSuccess(t)},"expired-callback":()=>{this.reset(),this._onExpired()},"error-callback":()=>{this.reset(),this._onError()}};grecaptcha.ready((()=>{try{this._widgetId=grecaptcha.render(t,i)}catch(t){}"function"==typeof this.options.onRecaptchaRendered&&this.options.onRecaptchaRendered(this)}))}runModalCaptcha(){const t=`captcha-${this.id}`;if(!this._modal){const e=$(`\n                <div class="m_modal m_${t}" data-is="modal" data-id="${t}" data-m-id="CAPTCHA">\n                    <div class="modal-data">\n                        <div class="component-bg bg-color" data-type="color" data-parallax="0" data-component="background">\n                            <div class="overlay" data-opacity="1"></div>\n                        </div>\n\n                        <div class="modal-content" data-contrast="dark" data-v="1" data-as="1">\n                            <div class="close close-times"></div>\n\n                            <div class="recaptcha-title">\n                                ${X.tr("quiz::captcha_label")}\n                            </div>\n\n                            <div id="recaptcha-${this.id}" class="g-recaptcha g-recaptcha-visible"></div>\n                        </div>\n                    </div>\n                </div>\n            `);bt.$list.append(e),this._modal=zt.initArea(e[0])}h.emit("ui_modal_open",{id:t,options:{hash:!1,rise:!0,onClose:()=>{this._token||this._onError()}}});const e=this._modal.$area.find(".g-recaptcha");null!=this._widgetId?this.reset():this.render(e[0])}closeModal(){this._modal&&h.emit("ui_modal_close",{id:this._modal.id})}runInvisibleChallenge(){this.enabled&&this.loaded&&!this.isVisible&&(grecaptcha.ready((()=>grecaptcha.execute(this._widgetId))),$('iframe[title="recaptcha challenge"]').parent().parent().css("z-index",2e3))}reset(){this.enabled&&this.loaded&&(this._token=null,null!=this._widgetId&&grecaptcha.ready((()=>grecaptcha.reset(this._widgetId))),"function"==typeof this.options.onReset&&this.options.onReset(this))}_onError(...t){"function"==typeof this.options.onError&&this.options.onError(this,...t)}_onSuccess(...t){"function"==typeof this.options.onSuccess&&this.options.onSuccess(this,...t)}_onExpired(...t){"function"==typeof this.options.onExpired&&this.options.onExpired(this,...t)}}const ge={phone:{RU:["+7 (***) ***-**-**","8 (***) ***-**-**"],KZ:["+7 (***) ***-**-**","8 (***) ***-**-**"],UA:["+38 (***) ***-****"],BY:["+375 ** *******"],US:["+1 (***) ***-****"]}};class ve extends qt{static getDefaultMask(t){const e=String(t).toLowerCase(),i=X.country;let s=ge[e]&&ge[e][i];return s&&"string"==typeof s&&(s=[s]),Object.assign([],s)}static initMask(t){if("undefined"==typeof IMask)return!1;const e={signed:!0,lazy:!0,padFractionalZeros:!0,definitions:"tel"===t.getAttribute("type")?{"*":/\d/,"#":/\d/}:{"#":/\d/,"@":/[A-Za-z\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,"*":/./}},i=t.getAttribute("data-required");let s=t.getAttribute("data-mask");s=s&&!/[ #()*@{}]/.test(s)?this.getDefaultMask(s):[s];try{if(s=s.filter((t=>/[ #()*@_{}]/.test(t))),s=s.map((t=>t.replace(/0/g,"\\0"))),0===s.length)throw{message:"Mask is empty"};s=1===s.length?String(s[0]):s.map((t=>p({},e,{mask:t})));const o=new IMask(t,p({},e,{mask:s,dispatch:(t,e)=>{const i=e.compiledMasks;if(1===i.length)return i[0];const s=(e.value+t).replace(/\W/g,"");return i.find((t=>{const e=t.mask.replace(/\W/g,"")[0];return s[0]===e}))||i[0]}})),n=()=>{o.masked.isComplete||!i&&!o.value?t.setAttribute("data-mask-complete",!0):t.removeAttribute("data-mask-complete"),t.setAttribute("value",o.value)};t.value&&n(),o.on("accept",n),t._mask=o}catch(e){return e instanceof Error&&console.error("MASK ERROR:",{masks:s,errorMessage:e.message}),t.removeAttribute("data-mask"),!1}}static initCalendar(t,e){const i=$(t),s=i.closest("[data-type]").attr("data-type"),o=i.attr("data-date-range")||"any",n=i.attr("data-date-work-days")||"0,1,2,3,4,5,6";let a=(new Date).getFullYear()+3;if("datetime"===s){a=(new Date).getMonth()>=8?(new Date).getFullYear()+1:(new Date).getFullYear()}let r=new Date((new Date).getFullYear()-100,0,1),l=new Date(a,11,31);"datetime"!==s&&"future"!==o||(r=new Date),"date"===s&&"past"===o&&(l=new Date);const d={type:s,lowerLimit:r,upperLimit:l,dateRange:o,locale:X.translation.calendar,dateFormat:X.date_format,showDateSelector:"date"===s&&"future"!==o,constraintByEl:e};if(n&&(d.workDays=n.split(",")),"datetime"===s){const t=i.attr("data-date-time-interval")||30,e=i.attr("data-date-time-start")||"00:00",s=i.attr("data-date-time-finish")||"00:00";d.workTime={interval:t,start:{hour:+e.substring(0,2),minute:+e.substring(3,5)},finish:{hour:+s.substring(0,2),minute:+s.substring(3,5)}}}i.calendar(d)}constructor(...t){super(...t),this.is="form",this.id=this.core.id,this.eventId=`.${this.id}`,this.$form=this.$component.is("form")?this.$component:this.$component.find("form"),this.$button=this.$component.find(".form-submit"),this.$fields=this.$component.find(".form-fields"),this.action=this.$component.find('input[name="action"]').val(),this.isInline=this.$component.attr("data-inline")?1:0,this.inCart=this.$component.closest(".w_cart").length>0,this.inModal=this.$component.closest(".m_modal").length>0,this.busy=!1,this.submitDisabled=!1,this.submitDisabledMessage=""}onInit(){this.formInited=!1,this.$masked=this.$component.find("[data-mask]"),this.$calendars=this.$component.find(".form-field-date__input"),this.$masked.length&&(this.hasMaskedField=!0,this.require.push("/_s/lib/imask/imask.min.js?v1")),this.$calendars.length&&(this.hasCalendarField=!0,this.require.push("/_s/lib/scroll-lock/scroll-lock.min.js?fix"),this.require.push("/_s/lib/calendar/dist/js/calendar.js?v2.3.2","/_s/lib/calendar/dist/css/calendar.min.css?v2.3.2"))}onLoad(){(this.core.wasScreen||this.core.wasBeside)&&(this.hasMaskedField&&this.inputMask(),this.hasCalendarField&&this.inputDate())}onScreen({state:t}){if(!t)return!1;this.formInit()}onBeside({state:t}){if(!t)return!1;this.formInit()}onOpen(t={}){const{top:e}=this.component.getBoundingClientRect();!flexbe_cli.run.is_screen_mobile&&!flexbe_cli.is_admin&&D.viewportHeight>e+100&&this.$component.find(".form-field").eq(0).find("input, textarea").eq(0).focus(),t&&t.data&&this.setData(t.data)}onResize(){this.$component.find(".range-outer").trigger("resize")}formInit(){if(this.formInited)return!1;this.formInited=!0,this.unbindEvents(),this.bindEvents(),this.initCaptcha(),this.customize()}customize(){this.fileInput(),this.customSelect(),this.textResize(),this.inputRange(),this.deliveryField(),this.hasMaskedField&&this.isLoaded&&this.inputMask(),this.hasCalendarField&&this.isLoaded&&this.inputDate(),this.$component.find(".form-field-range").trigger("resize")}unbindEvents(){this.$component.off(this.eventId),this.$form.off(this.eventId)}bindEvents(){const t=this.$component.find('.form-field-text__input, .form-field-text__textarea, input[type="checkbox"]'),e=this.$component.closest(".scroller");t.on(`keydown${this.eventId}`,(t=>{const e=t.currentTarget,i=e.getAttribute("data-check"),s=t.key||"",o=t.ctrlKey||t.metaKey;return!("phone"===i&&!e._mask&&!o&&1===s.length&&/[^\d ()+-]/.test(s))&&(("email"!==i||!/[\s,]/.test(s))&&void 0)})),t.on(`input${this.eventId} change${this.eventId}`,(t=>{const e=t.currentTarget,i=$(e);i.attr("value",e.value),i.closest(".is_error").removeClass("is_error")})),this.hasCalendarField&&(this.inModal||this.inCart)&&setTimeout((()=>{const t=this.$calendars.toArray().map((t=>$(t).data("calendar"))).filter((t=>t));e.on(`scroll${this.eventId}`,(()=>{t.forEach((t=>t.main.toPosition()))}))}),150),this.$form.off("submit").on(`submit${this.eventId}`,(t=>((async()=>{if("function"==typeof this.beforeSend){if(!1===await this.beforeSend())return!1}try{await this.sendForm()}catch(t){alert(t.message)}})(),t.preventDefault(),t.stopPropagation(),!1)))}setData(t){if(!t)return!1;t&&t.fields&&this.addFields(t.fields),t&&t.items&&this.addItems(t.items)}defineBeforeSend(t){"function"==typeof t&&(this.beforeSend=t)}defineAfterSent(t){"function"==typeof t&&(this.afterSent=t)}defineOnRequestError(t){"function"==typeof t&&(this.onRequestError=t)}addFields(t,e=!0){const i=this.$component.find(".form-fields-advanced");t.length&&i[0]&&(e&&i.empty(),t.forEach((t=>{i.find(`input[name="${t.name}"]`).remove();const e=$("<input>").attr("type",t.type).attr("name",t.name).attr("value",t.value);i.append(e)})))}addItems(t=[]){if(!t||!t.length)return;let e=0,i=0,s="";const o=[];t=t.map((t=>"object"!=typeof t?{}:(t.count=parseInt(t.count,10)||1,t.price=parseFloat(t.price)||0,t.title="string"==typeof t.title&&t.title.trim()||t.title||"",e+=t.price*t.count||0,i+=t.count,t)));try{s=JSON.stringify(t)}catch(t){}let n={"product[items]":s,"product[price]":e,"product[total]":i};e&&(n=p({},n,{"pay[price]":e,"pay[desc]":""})),Object.entries(n).forEach((([t,e])=>{o.push({type:"hidden",name:t,value:e})})),this.lastItems=t||[],this.addFields(o)}async sendForm(){if(this.submitDisabled)return void setTimeout((()=>{this.$button.addClass("shake"),setTimeout((()=>{this.$button.removeClass("shake")}),500)}),30);if(this.busy||!this.validateForm())return!1;const t=this.captcha&&this.captcha.getToken();if(this.captcha&&this.captcha.enabled&&!this.captcha.isOptional&&!t){if(this.captcha.inModal)return void this.captchaModalRun();if(this.captcha.isInvisible)return void this.captchaInvisibleRun()}this.addSubmitting();const e=new FormData(this.$form.get(0));e.append("is_ajax","true"),e.append("p_id",flexbe_cli.p_id),e.append("jsform",parseInt(448312,10)),"undefined"!=typeof flexbeAPI&&void 0!==flexbeAPI.customLeadData&&e.append("customLeadData",JSON.stringify(flexbeAPI.customLeadData)),Y.u_id&&e.append("f_uid",Y.u_id),flexbe_cli.run.is_OSX&&"function"==typeof e.entries&&e.forEach(((t,i)=>{"object"==typeof t&&t instanceof File&&0===t.size&&"function"==typeof e.delete&&e.delete(i)})),e.append("f_ab",JSON.stringify(Y.AB.getCookie())),"function"==typeof e.delete&&e.delete("g-recaptcha-response"),t&&e.append("captcha-token",t);const i=this.$form.attr("action"),s={type:"POST",dataType:"json",processData:!1,contentType:!1,data:e};try{const t=await j(i,s);t.send_formdata=!0,null!=t.pay&&(this.pay=t.pay),this.clearSubmitting(!0),this.captchaRemoveError(),this.showDone()}catch(e){const i=e.data;if(i.captcha){if(this.captcha)t?this.captchaAddError():this.captcha.inModal?this.captchaModalRun():this.captcha.isInvisible&&(this.captcha.isOptional=!1,this.captchaInvisibleRun());else{const t="visible"===i.captcha;await this.initCaptcha(p({},fe.getRecaptchaSettings(),{enabled:!0,visible:t,ttl:1})),t?this.captchaModalRun():(this.captcha.isOptional=!1,this.captchaInvisibleRun())}return}await this.sendFormError(e)}}async sendFormError(t){this.clearSubmitting(),console.error("sendForm error: ",t),"function"==typeof this.onRequestError?await this.onRequestError(t,this):t.status&&500===t.status&&alert(flexbe.locale.tr("main::error::network"))}addSubmitting(){this.busy=+Date.now(),this.$component.addClass("submitting")}clearSubmitting(t=!1){this.busy&&(this.$component.removeClass("submitting"),t?(this.$component.addClass("success submit-ok"),setTimeout((()=>{this.busy=!1,this.$component.removeClass("success submit-ok")}),1e3)):this.busy=!1)}showDone(){if("function"==typeof this.afterSent&&this.afterSent(),Y.reachGoals({mainGoal:Y.goals.order_done,goal:this.$component.find('input[name="goal"]').val(),htmlGoal:this.$component.find('textarea[name="goal_html"]').val()}),"pay"===this.action&&void 0!==this.pay&&null!==this.pay){if(this.pay.pay_link.length>0){const t=`${window.location.origin+window.location.pathname+(window.location.search?`${window.location.search}&`:"?")}pay_id=${this.pay.pay_id}&h=${this.pay.pay_hash}`;try{window.history.pushState(null,null,t),setTimeout((()=>{h.emit("pay",{action:"init"})}),200)}catch(e){setTimeout((()=>{document.location=t}),500)}}}else if("redirect"===this.action){const t=this.$component.find('input[name="action_redirect"]');let e;t&&t.length&&(e=t.val()),e&&setTimeout((()=>{V(e)}),500)}else{let t=this.$component.find("[data-modal-id]").attr("data-modal-id");if(/^(form|done)$/.test(t)&&!bt.find(t)){t=`${String(this.id).split("_")[0]}_${t}`}h.emit("ui_modal_open",{id:t})}this.resetForm()}resetForm(){this.$component.find(".file-input-outer").removeClass("active");const t=this.$fields.find("input, textarea, select"),e=t.not("select").not('[type="hidden"]').not(".form-field-range__input").not(".g-recaptcha-response"),i=t.filter("select"),s=t.filter(".form-field-range__input");i.each(((t,e)=>{const i=e.querySelector("option"),s=i&&i.value||"";e.value!==s&&(e.value=s,e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})))})),s.each(((t,e)=>{e.value=e.getAttribute("data-value"),e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))})),e.each(((t,e)=>{const i=e.defaultChecked;if(["radio","checkbox"].includes(e.type))i?e.setAttribute("checked",!0):e.removeAttribute("checked"),e.checked=i;else{e.removeAttribute("value"),e.value="",e.removeAttribute("data-mask-complete");const t=e._mask;t&&t.updateValue()}e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))})),this.captcha&&this.captcha.enabled&&(this.captcha.reset(),this.captchaRemoveError()),this.$form.get(0).reset()}validateForm(){let t=!0,e=!0,i=!0;this.removeFieldsErrors();const s=this.$component.find(".policy-data-warning--checkbox"),o=s.find("input")[0];o&&!o.checked&&(t=!1,s.addClass("is_error")),this.$component.find(".form-field[data-type]").each(((t,s)=>{let o;const n=$(s),a=n.find("input, textarea, select").not('[type="hidden"]')[0],r=n.attr("data-type");if(!a&&"captcha"!==r)return;const l="checkbox"===a.type?a.checked:a.value;if("captcha"===r){if(!this.captcha)return;o=!this.captcha.getToken()&&X.tr("form::captcha_not_checked")}else o=this.checkField(a);if(o){const t=n.attr("data-type"),i=n.find(".error");n.outerWidth(),n.addClass("is_error"),i.length&&(i.attr("title",o),i.find(".error-text").text(o)),"checkbox"===t&&n.find(".form-field-checkbox__box").attr("title",o),e=!1}i&&l&&(i=!1)})),this.$fields.removeClass("all-fields-empty"),this.$fields.outerWidth(),e||this.$fields.addClass("has-error");const n=this.$component.find(".is_error");return n.addClass("animate"),setTimeout((()=>{n.removeClass("animate")}),500),i&&(this.$fields.toggleClass("all-fields-empty",i),e=!1),e&&t}checkField(t){if(t.disabled||t.hidden)return!1;const e=t.type,i="checkbox"===e?t.checked:"file"===e?t.files:t.value,s=t.getAttribute("data-required")||!1,o=t.getAttribute("data-check")||!1;let n=!(!s||i)&&"form.required";if(t._mask&&t.getAttribute("data-mask")||!1){!s&&!i||t.getAttribute("data-mask-complete")||(n="tel"===e&&i?"form.phone":"text"===e&&i?"form.text":"form.required")}else if(o)if("date"===o||"datetime"===o){const e=$(t).data("calendar"),i=e&&e.input.checkError();i&&(n=i)}else if(i.length&&"email"===e){/^(([^\s"(),.:;<>@[\\\]]+(\.[^\s"(),.:;<>@[\\\]]+)*)|(".+"))@((\[(?:\d{1,3}\.){3}\d{1,3}])|(([\w--]+\.)+[A-Za-z-]{2,}))$/.test(i)||(n="form.email")}else if(i.length&&"tel"===e)if(/[^\d\s()+-]/.test(i))n="form.digits";else{i.replace(/\D/g,"").length<5&&(n="form.minlength")}else"file"===e&&(n=!(!s||i.length)&&"form.required");return n=n&&X.tr(n)||!1,n}removeFieldsErrors(){this.$fields.removeClass("has-error"),this.$component.find(".is_error").removeClass("is_error animate"),this.$fields.outerWidth()}disableSubmit(t){this.submitDisabled=!0,this.submitDisableMessage=t,this.$button.attr("data-tip",t||""),this.$button.find(".component-button").attr("disabled","disabled"),tt.init(this.$button)}enableSubmit(){this.submitDisabled=!1,this.submitDisableMessage="",this.$button.removeAttr("data-tip"),this.$button.find(".component-button").removeAttr("disabled"),tt.destroy(this.$button)}async initCaptcha(t){return null==t&&(t=fe.getRecaptchaSettings()),new Promise(((e,i)=>{!this.captcha&&t.enabled&&(this.captcha=new fe({id:this.id,$form:this.$component,inModal:this.isInline,onSuccess:t=>{this.captchaRemoveError(),this.clearSubmitting(),(t.inModal||t.isInvisible)&&this.sendForm()},onError:()=>{this.captchaAddError()}},t),flexbe_cli.require(`https://www.google.com/recaptcha/api.js?render=explicit&hl=${flexbe_cli.vars._group.language}`,(()=>{let t=150;const s=setInterval((()=>{t-=1,this.captcha.loaded?(this.captcha.init(),clearInterval(s),e()):0===t&&i(new Error("Can not load grecaptcha"))}),10)})))}))}captchaAddError(t){if(!this.captcha||!this.captcha.enabled)return;null==t&&(t=X.tr("form::captcha_error"));const e=this.$component.find(".captcha-global-error");e.find(".error-text").text(t),e.addClass("show"),this.busy&&this.clearSubmitting()}captchaRemoveError(){if(!this.captcha||!this.captcha.enabled)return;const t=this.$component.find('.form-field[data-type="captcha"]'),e=this.$component.find(".captcha-global-error");t.removeClass("is_error"),e.removeClass("show")}captchaModalRun(){this.captcha&&this.captcha.enabled&&this.captcha.loaded&&this.captcha.runModalCaptcha()}captchaInvisibleRun(){if(!this.captcha||!this.captcha.enabled||!this.captcha.loaded||this.captcha.isVisible)return;this.addSubmitting(),this.captcha.runInvisibleChallenge();const t=this.busy;setTimeout((()=>{t===this.busy&&this.clearSubmitting()}),2500)}fileInput(){this.$component.on(`change${this.eventId}`,".file-input",(t=>{const e=$(t.currentTarget),i=e.parents(".file-input-outer"),s=e.val(),o=t.currentTarget.files.length;if(i.addClass("active"),e.parents(".form-field").removeClass("is_error"),1===o&&i.find(".form-field-file--file-name").text(s),o>1){const t=o%100,e=o%10,s=Math.floor(t/10);let n;n=1===e&&11!==t?"form.filesMult":e>1&&e<5&&1!==s?"form.filesMult1":"form.filesMult2",i.find(".form-field-file--file-name").text(`${o} ${X.tr(n)}`)}0===o&&i.removeClass("active")})),this.$component.on(`click${this.eventId}`,".clear-files",(t=>{const e=$(t.currentTarget).parents(".file-input-outer");e.find(".file-input").val(""),e.removeClass("active")}))}textResize(){this.$component.find(".autosize").each(((t,e)=>{const i=e.offsetHeight-e.clientHeight,s=$(e),o=getComputedStyle(e),n=+s.attr("rows")||0,a=parseInt(o.borderTop,10)+parseInt(o.borderBottom,10),r=parseInt(o.paddingTop,10)+parseInt(o.paddingBottom,10);let l=Math.round(+o.lineHeight.split("px")[0]);if(flexbe_cli.run.is_ios){l/=parseInt(o.textSizeAdjust||o.webkitTextSizeAdjust||"120%",10)/100}s.removeAttr("data-autoresize"),s.off("keyup input").on("keyup input",(function(t){const e=t.currentTarget;e.style.height=`${e.scrollHeight+i}px`})),s.css("minHeight",`${a+r+l*n}px`)}))}customSelect(){this.$component.find(".dropdown-container").remove();const t=this.$component.find("select.atom-custom-select"),e={dropdownClass:this.$component.hasClass("style-underlined")?"sharp size--medium ":"size--medium "};t.each(((t,i)=>{const s=$(i).closest('[data-type="select"]');se.create({element:i,config:e,onCollapse:()=>{s.removeClass("active")},onActivate:()=>{s.addClass("active"),s.siblings('[data-type="select"]').removeClass("active")}})}))}deliveryField(){if(this.$delivery=this.$component.find('[data-type="delivery"]'),!this.$delivery.length)return;const{cartStore:t,deliveryStore:e}=pt,i=()=>{const t=e.activeMethod;if(!t)return;const i=this.$delivery,s=i.find(".form-field-delivery-item"),o=i.find(".form-field-delivery-fields"),n=s.filter(`[data-delivery="${t.id}"]`),a=o.filter(`[data-delivery="${t.id}"]`);s.removeClass("form-field-delivery-item--active"),n.addClass("form-field-delivery-item--active"),o.removeClass("form-field-delivery-fields--active"),a.addClass("form-field-delivery-fields--active"),o.find("input, textarea, select").prop("disabled",!0),a.find("input, textarea, select").prop("disabled",!1),s.find("input[type=radio]").prop("checked",!1),n.find("input[type=radio]").prop("checked",!0)},s=()=>{this.$delivery.find(".form-field-delivery-item").each(((t,i)=>{const s=i.getAttribute("data-delivery"),o=$(i).find(".item-price"),n=$(i).find(".delimiter"),a=$(i).find(".min-total"),r=e.getPrice(s),l=`${X.tr("form.min_total_tip")} ${r.minTotalFormatted}`;r.notHasFree||r.untilFree&&r.notFixedPrice?(o.text(""),n.text("")):(o.text(r.currentFormatted),n.text("")),a.text(X.tr(l))}))};i(),s(),setTimeout((()=>{e.on(`dispatch.form-component-${this.id}`,((t,{name:e})=>{"selectMethod"===e&&i()})),t.on(`dispatch.form-component-${this.id}`,(()=>{s()}))}),10),this.$delivery.on("change",".form-field-delivery-item input",(t=>{if(t.currentTarget.checked){const i=t.currentTarget.closest("[data-delivery]").getAttribute("data-delivery");e.dispatch("selectMethod",i)}}))}inputRange(){this.$component.find(".form-field-range").each(((t,e)=>new ee($(e))))}inputMask(){return"undefined"!=typeof IMask&&(this.hasMaskedField=!1,this.$masked.each(((t,e)=>{this.constructor.initMask(e);const i=!!e.getAttribute("data-placeholder"),s=e._mask;i&&s&&($(e).on(`focus${this.eventId}`,(()=>{s.updateOptions({lazy:!1})})),$(e).on(`blur${this.eventId}`,(()=>{if(!s.unmaskedValue){const t=s.mask.replace(/\*/g,"_"),e=s.value;s.updateOptions({lazy:!0}),s.masked.rawInputValue&&t!==e||(s.unmaskedValue="",s.value="",s.updateValue())}})))})),!0)}inputDate(){return this.hasCalendarField=!1,this.inModal||this.inCart?this.$calendars.each(((t,e)=>{this.constructor.initCalendar(e,this.$component.closest(".scroller")[0])})):this.$calendars.each(((t,e)=>{this.constructor.initCalendar(e)})),!0}}var be={init(){flexbe_cli.is_admin||this.setHeaders()},setHeaders(){if(flexbe_cli.is_admin)return;const t=$("body > .container-list"),e='[data-b-type*="allow_head"]',i="b_head";t.find('[data-b-type*="header"][data-b-type*="overflow"]').each(((s,o)=>{const n=$(o),a=(t=>{let e=t.parents(".b_block").last();return e.length||(e=t),e})(n);let r=n.attr("data-owner");if(!r){const t=a.nextAll(".b_block").eq(0),i=t.is(e)?t:t.find(e);i.length&&(r=i.attr("data-id"))}const l=t.find(`.b_block[data-id=${r}]`).filter(e).eq(0);l.length&&!l.find("> .b_head").length&&(n.addClass(i),l.prepend(o),this.fixHeaderHeight(l,n))}))},fixHeaderHeight(t,e){if(!t[0]||!e[0])return;const i=t.attr("data-id"),s=t.find("> .container-fluid > .container").eq(0),o=s.find(".content");s.css("paddingTop","");const n=parseInt(s.css("paddingTop"),10),a=e.outerHeight(),r=o.offset().top-n-s.offset().top,l=a-r,d=o.outerHeight(!0)-o.outerHeight();r>=0&&s.css("paddingTop",l+d-r+"px"),t.triggerHandler("fixHeaderHeight"),$(window).off(`resized.fixHeaderHeight${i}`).on(`resized.fixHeaderHeight${i}`,(()=>{this.fixHeaderHeight(t,e)}))}};const we="next",$e="result";class ye extends qt{constructor(...t){super(...t),this.is="quiz",this.id=this.core.id,this.eventId=`.quiz${this.id}`,this.createQuiz()}onInit(){this.$masked=this.$form.find("[data-mask]"),this.require=[],this.$masked.length&&(this.needInitMasks=!0,this.require.push("/_s/lib/imask/imask.min.js?v1")),this.$calendars=this.$form.find(".form-field-date__input"),this.$calendars.length&&(this.needInitCalendar=!0,this.require.push("/_s/lib/scroll-lock/scroll-lock.min.js?fix"),this.require.push("/_s/lib/calendar/dist/js/calendar.js?v2.3.2","/_s/lib/calendar/dist/css/calendar.min.css?v2.3.2"))}onLoad(){(this.core.wasScreen||this.core.wasBeside)&&(this.needInitMasks&&this.initFieldMask(),this.needInitCalendar&&this.initFieldDate()),this.isLoaded=!0}onScreen({state:t}){if(!t)return!1;this.initQuiz()}onBeside({state:t}){if(!t)return!1;this.initQuiz()}onOpen(t={}){this.initQuiz(),this.started||this.startQuiz(),t&&t.data&&this.setData(t.data)}onResize(){this.$component.find(".range-outer").trigger("resize")}createQuiz(){this.timeouts=[],this.history=[],this.swiper=[],this.$area=this.core.$area,this.$root=this.core.$root,this.$form=this.$component.find("form"),this.$steps=this.$component.find(".quiz-steps"),this.$actions=this.$component.find(".quiz-actions"),this.$progress=this.$component.find(".quiz-progress"),this.$scroller=this.$root.find(".scroller"),this.$stepsWrapper=this.$steps.find(".steps-wrapper"),this.$outerWrapper=this.$area.find('[data-quiz-part="wrapper"]'),this.$welcomeScreen=this.$outerWrapper.find('[data-quiz-part="welcome"]'),this.$progress.length||(this.$progress=this.$area.find('[data-quiz-part="progress"]')),this.rootModal="modal"===this.core.is&&this.core,this.hasWelcome=!!this.rootModal||this.$welcomeScreen.length>0,this.autoNextEnabled=+this.$steps.attr("data-autonext")||0,this.currentId=null,this.currentIndex=-1,this.total=parseInt(this.$component.attr("data-total-steps"),10)}initQuiz(){if(this.inited)return;this.inited=!0,this.resetForm(),this.bindEvents(),this.initFields(),this.initControls(),this.initCaptcha();const t=flexbe_cli.is_admin&&this.$area.data("initialQuizStepId"),e=flexbe_cli.is_admin&&this.$area.data("initialQuizStepIndex");t?this.toStep({id:t,index:e,animated:!1}):this.hasWelcome||this.startQuiz({animated:!1})}bindEvents(){h.off(this.eventId),this.$form.off(this.eventId),this.$scroller.off(this.eventId),h.on(`quiz_command${this.eventId}`,((t,e)=>{this.id===e.id&&("welcome"===e.command?this.toWelcome():"start"===e.command?this.startQuiz():"step"===e.command&&this.toStep({id:e.stepId,index:e.stepIndex,force:e.force,animated:e.animated,scrl:e.scroll}))})),this.$form.on(`change${this.eventId}`,".policy-data-warning__input",(t=>{this.$form.find(".policy-data-warning__input").prop("checked",t.target.checked)})),this.$form.on(`input${this.eventId} change${this.eventId}`,"input, textarea",(t=>{const e=t.currentTarget,i=e.value,s=$(e);s.attr("value",i),s.closest(".is_error").removeClass("is_error")})),this.$form.on(`keydown${this.eventId}`,"input, textarea",(t=>{const e=t.currentTarget,i=e.getAttribute("data-check"),s=t.key||"",o=t.ctrlKey||t.metaKey;return!("phone"===i&&!e._mask&&!o&&1===s.length&&/[^\d ()+-]/.test(s))&&(("email"!==i||!/[\s,]/.test(s))&&void 0)})),this.needInitCalendar&&"modal"===this.core.is&&setTimeout((()=>{this.$calendars.toArray().forEach((t=>{const e=$(t).data("calendar");this.$scroller.on(`scroll${this.eventId}`,(()=>{e.main.toPosition()}))}))}),150),this.$form.on(`submit${this.eventId}`,(()=>this.onSubmit()))}initControls(){$("body").off(`keydown${this.eventId}`).on(`keydown${this.eventId}`,(t=>{const e=9===t.keyCode,i=13===t.keyCode;if(!i&&!e)return;const s=this.inFocus,o=t.metaKey||t.ctrlKey,n=t.shiftKey;if(s&&("TEXTAREA"!==t.target.tagName||!i||o)){if(n&&e)this.toPrevStep();else if(!n&&!o){const t=this.$currentStep.find(":focus").closest(".field").next(".field");this.focusField(t)||this.toNextStep()}return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1}})),this.$component.off("click.control").on("click.control","[data-quiz-action]",(t=>{const e=t.currentTarget.getAttribute("data-quiz-action");"welcome"===e?this.toWelcome():"prev"===e?this.toPrevStep():"next"===e&&this.toNextStep()}))}setProgress(){const t=this.$progress.find(".progress-loader-bar .current"),e=this.total,i=t.data("unit");let s=this.realIndex+1;if(flexbe_cli.is_admin&&-1===this.realIndex&&"welcome"!==this.currentId){s=(+this.$currentStep.prevAll('[data-linked="linked"]').first().attr("data-real-index")+1||0)+1}let o=parseInt(100*s/e,10)||0;if(s=Math.max(0,Math.min(e,s)),o=Math.max(0,Math.min(100,o)),t.length&&i){let n=`${o}%`;"step"===i?n=`${s} / ${e}`:"none"===i&&(n=""),t.attr("data-value",n)}this.$progress.attr("data-current-progress",o),this.$progress.attr("data-current",s),this.$progress.attr("data-total",e),this.$progress.find(".progress-text .current").text(s),this.$progress.find(".progress-text .total").text(e),this.$progress.find(".progress-percent .current").text(o),this.$progress.find(".progress-loader-bar .current").css("width",`${o}%`),this.$progress.find(".progress-loader-circle .current").attr("stroke-dashoffset",`${Math.abs(100-o)}`)}setActionButtons(){let t=this.hasWelcome||this.history.length>1||!!(flexbe_cli.is_admin&&0!==this.realIndex&&this.currentIndex>0);!flexbe_cli.is_admin||!this.rootModal||this.realIndex&&this.currentIndex||(t=!1),this.$actions.toggleClass("show-prev",t)}toWelcome({scrl:t=!0}={}){if(!this.hasWelcome)return this.startQuiz({scrl:t}),!0;if(this.started=!1,this.currentIndex=-1,this.realIndex=-1,this.currentId="welcome",this.$area.data("initialQuizStepId",this.currentId),this.$area.data("initialQuizStepIndex",this.currentIndex),this.$outerWrapper.attr("data-active-step",this.currentId),this.$outerWrapper.attr("data-active-index",this.currentIndex),this.$outerWrapper.toggleClass("quiz-state-welcome",!0),this.$outerWrapper.toggleClass("quiz-state-started",!1),this.rootModal)flexbe_cli.is_admin||h.emit("ui_modal_close",{id:this.rootModal.id});else if(this.$outerWrapper.length){const t=this.$welcomeScreen.outerHeight()||0;this.$outerWrapper.css("minHeight",t)}return this.setProgress(),this.setActionButtons(),t&&"block"===this.core.is&&!flexbe_cli.is_admin&&B.toElement(this.$area),h.emit("quiz_event",{event:"welcome",sender:"core",quiz:this}),!0}startQuiz({animated:t,scrl:e}={}){this.sessionId=parseInt(Date.now()/1e3,10);const i=this.$stepsWrapper.find('.step[data-type="root"][data-linked="linked"]').first();i.length&&this.toStep({$step:i,force:!0,animated:t,scrl:e})}autoNextStep(){!this.autoNextEnabled||this.$currentStep.find(".quiz-fields").data("count")>1||setTimeout((()=>{this.toNextStep()}),150)}toPrevStep(){const t=this.history[this.history.length-2];if(!t){const t=this.$currentStep.prevAll('.step[data-type="root"][data-linked="linked"]').first();return t.length?this.toStep({$step:t}):this.hasWelcome&&this.toWelcome(),!1}return this.toStep(t),!0}toNextStep({force:t}={}){if(!(t||this.validateStep()))return!1;const e=this.$currentStep.attr("data-goto"),i=this.$currentStep.attr("data-goal"),s=this.$currentStep.attr("data-html-goal"),o=this.history.find((t=>t.id===this.currentId))||{},n=this.$currentStep.find("[data-field-id]").map(((t,e)=>{const i=$(e),s=i.attr("data-field-id"),o=i.find("input, textarea").not('[type="hidden"]'),n=i.find("[data-goto]"),a=i.attr("data-type"),r=i.find(`[name="vars[${s}]"]`).val();let l=o.attr("type"),d=n,c=o.val();["checkbox","radio","image"].includes(a)?d=n.filter(":checked"):"select"===a?(d=d.filter(((t,e)=>e.selected)),l="select"):"file"===a&&(c=Array.from(o[0].files));const h=d.toArray(),u=h.map((t=>t.getAttribute("data-goto"))).filter((t=>t));return{id:s,title:r,type:a,inputType:l,value:c,variants:h.map((t=>({id:t.getAttribute("data-id"),value:t.value}))).filter((t=>t.id)),goto:u}})).toArray(),a=n.map((t=>{const e={id:t.id,title:t.title,type:t.type};return["radio","checkbox","select","image"].includes(t.inputType)?e.variants=t.variants:e.value=t.value,e})),r=n.reduce(((t,e)=>t.concat(e.goto)),[]),l=this.getNextStep({gotoId:r[0]||e||we});o&&(o.fields=n,o.answers=a,o.toId=l,o.goal=i,o.htmlGoal=s),this.toStep({id:l,historyItem:o})}getNextStep({gotoId:t,$current:e=this.$currentStep}={}){if(t===$e){const t=this.history.map((t=>t.$step[0])),e=this.$stepsWrapper.find('[data-type="root"][data-linked="linked"][data-required]').filter(((e,i)=>!t.includes(i)));return e.length?e.eq(0).attr("data-id"):$e}let i=t;if(t===we||!this.$stepsWrapper.find(`.step[data-id="${i}"]`).length){i=e.nextAll('.step[data-type="root"][data-linked="linked"]').first().attr("data-id")}if(t===we&&!i)return this.getNextStep({gotoId:$e,$current:e});if(!this.checkStepCondition({id:i})){const t=e.nextAll('.step[data-type="root"][data-linked="linked"]').first();return this.getNextStep({gotoId:we,$current:t})}return i}toStep({id:t,index:e,$step:i,force:s,scrl:o=!0,animated:n=!0,historyItem:a}){var r,l;if(this.inStepAnimation)return!1;if(null==a&&(a=this.history.find((t=>t.id===this.currentId))),t===$e)return void this.toResult({historyItem:a});if(i&&i.length||null==t||(i=this.$stepsWrapper.find(`.step[data-id="${t}"]`)),i&&i.length||null==e||(i=this.$stepsWrapper.find(`.step[data-index="${e}"]`)),!i||!i.length)return!1;if(t=null!=(r=t)?r:i.attr("data-id"),e=parseInt(null!=(l=e)?l:i.attr("data-index"),10),t===this.currentId)return this.enableStep(i),!1;const d=flexbe_cli.is_admin?parseInt(i.attr("data-real-index"),10):e,c=e>this.currentIndex;n||this.$area.addClass("noanimate"),i.find(".is_error").removeClass("is_error");const u=i.outerHeight(),p={$step:i,id:t,title:i.find(".step-title").text().trim(),index:e,realIndex:d,fields:[],answers:[]};let m=[];s?(m=this.history,this.history=[]):(m=this.history.filter((t=>t.index>=p.index)),this.history=this.history.filter((t=>!m.includes(t)))),m.forEach((t=>{this.disableStep(t.$step)})),this.enableStep(i),this.started=!0,this.history.push(p),this.$component.addClass("quiz-started"),n&&this.$component.addClass("step-change-animation");const f=window.scrollParent(this.$component[0])||document.scrollingElement,g=f&&f.scrollTop||0,v=this.$stepsWrapper.outerHeight();if(this.$area.data("initialQuizStepId",t),this.$area.data("initialQuizStepIndex",e),this.$outerWrapper.attr("data-active-step",t),this.$outerWrapper.attr("data-active-index",e),this.$outerWrapper.toggleClass("quiz-state-welcome",!1),this.$outerWrapper.toggleClass("quiz-state-started",!0),i.toggleClass("higher",u>v),n&&this.$stepsWrapper.css("height",`${v}px`),this.$outerWrapper.css("minHeight",`${v}px`),i.prevAll().removeClass("active next").addClass("prev"),i.nextAll().removeClass("active prev").addClass("next"),i.removeClass("next prev").addClass("active"),this.currentId=t,this.currentIndex=e,this.realIndex=d,this.$currentStep=i,this.core.updateTween(),this.setProgress(),this.setActionButtons(),this.initImages(),2===flexbe_cli.theme_id){const t=this.$area.find(".b_head");t.length&&be.fixHeaderHeight(this.$area,t)}return this.timeouts=this.timeouts.filter((t=>clearTimeout(t))),this.timeouts.push(setTimeout((()=>{n||this.$area.removeClass("noanimate")}),20)),n?(this.inStepAnimation=!0,this.timeouts.push(setTimeout((()=>{this.$stepsWrapper.css("height",""),this.$component.removeClass("step-change-animation"),this.$component.find(".range-outer").trigger("resize"),this.inStepAnimation=!1}),250)),o&&(this.timeouts.push(setTimeout((()=>{const t=this.$area.get(0).getBoundingClientRect();this.$stepsWrapper.css("height",`${u}px`);const e=f.scrollTop,i=this.$area.get(0).getBoundingClientRect().bottom-t.bottom-(g-e);i&&f.scrollTo(0,e+i)}),150)),flexbe_cli.is_admin||this.timeouts.push(setTimeout((()=>{let t=this.$component;this.$area.outerHeight()<=D.viewportHeight&&(t=this.$area),B.toElement(t,{centered:!0,force:!1,complete:()=>{z.is_mobile||this.focusField(i)}})}),450)))):this.$component.find(".range-outer").trigger("resize"),a=a||{},this.lastHistoryItem=a,h.emit("quiz_event",{event:"step",sender:"core",quiz:this,payload:{fromId:a.id,fromTitle:a.title,fromAnswers:a.answers,toNext:c,toId:t,sessionId:this.sessionId},answerGoals:{goal:a.goal,htmlGoal:a.htmlGoal}}),!0}toResult({force:t,historyItem:e}={}){const i=t||this.validateStep();return!!(t||!this.busy&&i)&&(null==e&&(e=this.history[this.history.length-1]),this.result=this.getResult(),this.lastHistoryItem=e,this.$form.submit(),!0)}validateStep(){let t=!0;if(!this.$currentStep||!this.$currentStep.length)return!0;const e=this.$currentStep.find(".policy-data-warning--checkbox"),i=e.find("input")[0];return i&&!i.checked&&(t=!1,e.addClass("is_error animate")),this.$currentStep.find(".field[data-type]").each(((e,i)=>{const s=$(i),o=s.attr("data-type");let n;if(s.removeClass("is_error"),"captcha"===o){if(!this.captcha)return;n=!this.captcha.getToken()&&X.tr("form::captcha_not_checked")}else n=this.checkField(s);n&&(s.outerWidth(),s.addClass("is_error animate"),setTimeout((()=>{s.removeClass("animate")}),500),s.find(".error").text(n),t&&this.focusField(s,500),t=!1)})),t}getResult(){const t=this.$form.find("input[name=results]").data("value")||[];let e=t.filter((t=>null!=t.id&&"default"!==t.id)).find((t=>this.checkResultCondition(t)));return e||(e=t.find((t=>null==t.id||"default"===t.id))||t[0]),"object"!=typeof e.action&&(e.action={pay:e.pay,name:e.action,modal_id:e.modal_id,action_redirect:e.action_redirect}),e}checkStepCondition(){return!0}checkResultCondition(t){const e=t.conditions||{},i=e.union,s=e.list||[],o=this.history.reduce(((t,e)=>t.concat(e.fields)),[]);let n=s.map((t=>{const e=o.find((e=>String(e.id)===String(t.field)));return{condition:t,field:e}}));return!!n.length&&(n=n["and"===i?"every":"some"]((({condition:t,field:e})=>{let i=!0;if(!e)return!1;if("vars"===t.type){const s=e.variants||[],o=(t.variants||[]).map((t=>`${t}`));if(!s.length)return!!t.emptyVariant;if(t.unionExtra||(i=s.every((t=>o.includes(`${t.id}`)))),i){let n=t.union;"radio"!==e.inputType&&"select"!==e.inputType||(n="or"),i=o["and"===n?"every":"some"]((t=>s.find((e=>e.id===t))))}}else if("range"===t.type){const s=`${e.value}`.replace(/\s+/g,"").split(/\s[-]\s/).map((t=>+t)).filter((t=>"number"==typeof t&&!Number.isNaN(t))),o=Math.min.apply(null,s),n=Math.max.apply(null,s),r=o!==n;let l=+t.rangeLimitFrom,d=+t.rangeLimitTo;if("equal"===t.operator)return r?o<=l&&l<=n:l===o;a(l)&&a(d)&&(l=Math.min(t.rangeLimitFrom,t.rangeLimitTo),d=Math.max(t.rangeLimitTo,t.rangeLimitFrom)),i&&a(l)&&(i=l<=o),i&&a(d)&&(i=n<=d)}else if("text"===t.type){const i=t.fill,s=(e.value||"").trim().replace(/ +/g," "),o=t.answers.map((t=>`${t}`.toLowerCase())).filter((t=>t));if("fill"===i)return!!s;if("empty"===i)return!s;if("include"===i)return o.some((t=>new RegExp(`^${t}|\\s${t}`,"i").test(s)));if("exclude"===i)return o.every((t=>!new RegExp(`^${t}|\\s${t}`,"i").test(s)))}else if("file"===t.type){const i=t.fill,s=e.value;if("fill"===i)return!!s.length;if("empty"===i)return!s.length}return i})),n);function a(t){return!Number.isNaN(+t)&&null!=t&&""!==t}}checkField(t){const e=t.find("input, textarea, select").not('[type="hidden"]'),i=e[0],s=t[0];if(!i)return;const o=s.getAttribute("data-type"),n=[!0,1,"true","1"].includes(s.getAttribute("data-is-required")),a=i.getAttribute("data-check")||!1,r=i._mask&&i.getAttribute("data-mask")||!1;let l;l=["checkbox","radio","image"].includes(o)?!!e.closest(":checked").length:"file"===o?i.files:i.value;let d=!(!n||l)&&"form.required";if(r){!n&&!l||i.getAttribute("data-mask-complete")||(d="phone"===o&&l?"form.phone":"text"===o&&l?"form.text":"form.required")}else if(a)if(l.length&&"email"===o){/^(([^\s"(),.:;<>@[\\\]]+(\.[^\s"(),.:;<>@[\\\]]+)*)|(".+"))@((\[(?:\d{1,3}\.){3}\d{1,3}])|(([\w--]+\.)+[A-Za-z-]{2,}))$/.test(l)||(d="form.email")}else if(l.length&&"phone"===o)if(/[^\d\s()+-]/.test(l))d="form.digits";else{l.replace(/\D/g,"").length<5&&(d="form.minlength")}else if("file"===o)d=!(!n||l.length)&&"form.required";else if("date"===o||"datetime"===o){const t=$(i).data("calendar"),e=t&&t.input.checkError();e&&(d=e)}return d=d&&X.tr(d)||!1,d}disableStep(t){t.find("input, textarea, select").prop("disabled",!0)}enableStep(t){t.find("input, textarea, select").prop("disabled",!1)}focusField(t,e=200){if(!t||!t.length)return!1;if(z.is_ios)return!1;const i=t.find(".form-field-text__input, .dropdown-select").not(".form-field-date__input").first();return!!i.length&&(e?setTimeout((()=>i.focus()),e):i.focus(),!0)}initImages(){setTimeout((()=>{const t=$(this.component).find(".step.active");$(t).find(".component-image").length&&he(t,"image","setImage")}),100)}initFields(){this.initFieldImage(),this.initFieldCheckbox(),this.initFieldRadio(),this.initFieldSelect(),this.initFieldTextarea(),this.initFieldFile(),this.initFieldRange(),this.isLoaded&&(this.needInitMasks&&this.initFieldMask(),this.needInitCalendar&&this.initFieldDate())}initFieldImage(){this.$component.off("click.fieldImages").on("click.fieldImages",".form-field-image-item",(t=>{const e=t.currentTarget.querySelector("input"),i=!e.checked;e.checked=i,i&&"radio"===e.type&&this.autoNextStep()}))}initFieldFile(){this.$component.off("change.uploadFile").on("change.uploadFile",".file-input",(t=>{const e=$(t.currentTarget),i=e.parents(".form-field-file"),s=i.find(".form-field-file--files"),o=e.val(),n=t.currentTarget.files.length;if(i.addClass("active"),e.parents(".field").removeClass("is_error"),0===n)i.removeClass("active");else if(1===n)s.find(".text").text(o);else if(n>1){const t=n%100,e=n%10;let i;i=1===e&&11!==t?"form.filesMult":e>1&&e<5?"form.filesMult1":"form.filesMult2",s.find(".text").text(`${n} ${X.tr(i)}`)}})),this.$component.off("click.clearFiles").on("click.clearFiles",".clear-files",(t=>{const e=$(t.currentTarget).parents(".form-field-file");e.find(".file-input").val(""),e.removeClass("active")}))}initFieldCheckbox(){}initFieldRadio(){this.autoNextEnabled&&this.$component.off("change.initRadio").on("change.initRadio",".form-field-radio-item",(()=>{this.autoNextStep()}))}initFieldSelect(){this.$component.find(".dropdown-container").remove();const t=this.$component.find("select.atom-custom-select"),e={dropdownClass:this.$component.hasClass("style-underlined")?"sharp size--large":"size--large"};t.each(((t,i)=>{const s=$(i).closest('[data-type="select"]');se.create({element:i,config:e,onChange:this.autoNextStep.bind(this),onSelect:this.autoNextStep.bind(this),onCollapse:()=>{s.removeClass("active")},onActivate:()=>{s.addClass("active"),s.siblings('[data-type="select"]').removeClass("active")}})}))}initFieldTextarea(){this.$component.find("textarea.autosize").each(((t,e)=>{const i=e.offsetHeight-e.clientHeight,s=$(e);s.removeAttr("data-autoresize"),s.off("keyup input").on("keyup input",(function(t){t.currentTarget.style.height="auto",t.currentTarget.style.height=`${t.currentTarget.scrollHeight+i}px`}))}))}initFieldRange(){this.$component.find(".form-field-range").each(((t,e)=>new ee($(e))))}addSubmitting(){this.busy=+Date.now(),this.$component.addClass("submitting"),this.$form.addClass("submitting")}clearSubmitting(t=!1){this.busy&&(this.$component.removeClass("submitting"),this.$form.removeClass("submitting"),t?(this.$component.addClass("success"),setTimeout((()=>{this.busy=!1,this.$component.removeClass("success")}),1e3)):this.busy=!1)}onSubmit(){const t={p_id:flexbe_cli.p_id,id:this.core.id,name:this.result.name,action:this.result.action.name,jsform:parseInt(448312,10)};if(Y.u_id&&(t.f_uid=Y.u_id),"pay"===this.result.action.name&&this.result.action.pay){const e=this.result.action.pay;e.desc&&(t["pay[desc]"]=e.desc),e.price&&(t["pay[price]"]=e.price,e.title&&(t["product[items]"]=JSON.stringify([{title:e.title,id:`${flexbe_cli.p_id}_${flexbe_cli.s_id}`,img:e.img,count:1,price:e.price}]),t["product[price]"]=e.price,t["product[total]"]=1))}return Object.entries(t).forEach((([t,e])=>{null!=e&&this.addFields([{name:t,value:e,type:"hidden"}],!1)})),this.sendForm(),!1}async sendForm(){const t=this.captcha&&this.captcha.getToken();if(this.captcha&&this.captcha.enabled&&!this.captcha.isOptional&&!t)return void(this.captcha.isVisible?this.toStep({id:"captcha"}):this.captchaInvisibleRun());this.addSubmitting();const e=new FormData(this.$form.get(0));if(e.append("is_ajax","true"),"undefined"!=typeof flexbeAPI&&void 0!==flexbeAPI.customLeadData&&e.append("customLeadData",JSON.stringify(flexbeAPI.customLeadData)),e.append("f_ab",JSON.stringify(Y.AB.getCookie())),"function"==typeof e.delete&&e.delete("g-recaptcha-response"),t&&e.append("captcha-token",t),z.is_OSX&&"function"==typeof e.entries)for(const t of e.entries()){const[i,s]=t;"object"==typeof s&&s instanceof File&&0===s.size&&"function"==typeof e.delete&&e.delete(i)}try{const t=await j(this.$form.attr("action"),{processData:!1,contentType:!1,data:e});void 0!==t.pay&&(this.pay=t.pay),this.clearSubmitting(!0),this.captchaRemoveError(),this.showDone()}catch(e){const i=e.data;if(i.captcha)return this.captcha||await this.initCaptcha(p({},fe.getRecaptchaSettings(),{enabled:!0,visible:"visible"===i.captcha,ttl:1})),void(t?this.captchaAddError():this.captcha.isVisible?(this.captcha.isOptional=!1,this.total=parseInt(this.$component.attr("data-total-steps"),10)+1,this.clearSubmitting(!1),this.toStep({id:"captcha"})):this.captcha.isInvisible&&this.captchaInvisibleRun());this.clearSubmitting(!1),console.error("sendForm error: ",e),alert("Form submitting error!")}}showDone(){const t=()=>{setTimeout((()=>{this.resetForm(),this.toWelcome({scrl:!1})}),500)},e=this.result.action.name,i=this.lastHistoryItem;if(i){const t=i.answers,e=i.id,s=i.title,o=this.result.goals||{};h.emit("quiz_event",{event:"submit",sender:"core",quiz:this,payload:{fromAnswers:t,fromId:e,fromTitle:s,sessionId:this.sessionId},answerGoals:{goal:i.goal,htmlGoal:i.htmlGoal},resultGoals:{mainGoal:Y.goals.order_done,goal:o.goal,htmlGoal:o.goal_html}})}if("function"==typeof this.afterSent&&this.afterSent(),"pay"===e&&void 0!==this.pay&&null!==this.pay&&this.pay.pay_link.length>0){const e=`${window.location.origin+window.location.pathname+(window.location.search?`${window.location.search}&`:"?")}pay_id=${this.pay.pay_id}&h=${this.pay.pay_hash}`;try{window.history.pushState(null,null,e),setTimeout((()=>{h.emit("pay",{action:"init"})}),200)}catch(t){setTimeout((()=>{document.location=e}),500)}t()}else if(["redirect","anchor"].includes(e)){const e=this.result.action.action_redirect,i=this.result.action.action_link;if(e)setTimeout((()=>{V(e),t()}),1e3);else if(i){const e=$(`a[name="${i.replace("#","")}"]`);e.length>0&&B.toElement(e.parent()),t()}else t()}else{const e=this.result.action.modal_id;h.emit("ui_modal_open",{id:e}),t()}}resetForm(){this.$form.find(".form-field-file, .file-input-outer").removeClass("active");const t=this.$stepsWrapper.find("input, textarea, select"),e=t.not("select").not('[type="hidden"]').not(".form-field-range__input"),i=t.filter("select"),s=t.filter(".form-field-range__input");t.prop("disabled",!0),i.each(((t,e)=>{const i=e.querySelector("option"),s=i&&i.value||"";e.value!==s&&(e.value=s,e.dispatchEvent(new Event("change")))})),s.each(((t,e)=>{e.value=e.getAttribute("data-value"),e.dispatchEvent(new Event("change"))})),e.each(((t,e)=>{const i=e.defaultChecked;["radio","checkbox"].includes(e.type)?e.checked=i:(e.removeAttribute("value"),e.value="",e.removeAttribute("data-mask-complete"),e._mask&&e._mask.updateValue()),e.dispatchEvent(new Event("change"))})),this.captcha&&this.captcha.enabled&&(this.captcha.reset(),this.captchaRemoveError()),this.$form[0].reset()}async initCaptcha(t){return null==t&&(t=fe.getRecaptchaSettings()),new Promise(((e,i)=>{!this.captcha&&t.enabled&&(this.captcha=new fe({id:this.id,$form:this.$component,onSuccess:()=>{this.captchaRemoveError(),this.toResult({force:!0})},onError:()=>{this.captchaAddError()}},t),flexbe_cli.require(`https://www.google.com/recaptcha/api.js?render=explicit&hl=${flexbe_cli.vars._group.language}`,(()=>{let t=150;const s=setInterval((()=>{t-=1,this.captcha.loaded?(this.captcha.init(),clearInterval(s),e()):0===t&&i(new Error("Can not load grecaptcha"))}),10)})))}))}captchaAddError(t){if(!this.captcha||!this.captcha.enabled)return;null==t&&(t=X.tr("form::captcha_error"));const e=this.$component.find(".captcha-global-error");e.find(".error-text").text(t),e.addClass("show"),this.busy&&this.clearSubmitting()}captchaRemoveError(){if(!this.captcha||!this.captcha.enabled)return;const t=this.$component.find('.field[data-type="captcha"]'),e=this.$component.find(".captcha-global-error");t.removeClass("is_error"),e.removeClass("show")}captchaInvisibleRun(){if(!this.captcha||!this.captcha.enabled||!this.captcha.loaded||this.captcha.isVisible)return;this.addSubmitting(),this.captcha.runInvisibleChallenge();const t=this.busy;setTimeout((()=>{t===this.busy&&this.clearSubmitting()}),2500)}setData(t){if(!t)return!1;t&&t.fields&&this.addFields(t.fields),t&&t.items&&this.addItems(t.items)}addFields(t,e=!0){const i=this.$component.find(".form-fields-advanced");t.length&&i[0]&&(e&&i.empty(),t.forEach((t=>{i.find(`input[name="${t.name}"]`).remove();const e=$("<input>").attr("type",t.type).attr("name",t.name).attr("value",t.value);i.append(e)})))}addItems(t=[]){if(!t||!t.length)return;let e=0,i=0,s="";const o=[];t=t.map((t=>"object"!=typeof t?{}:(t.count=parseInt(t.count,10)||1,t.price=parseFloat(t.price)||0,t.title="string"==typeof t.title&&t.title.trim()||t.title||"",e+=t.price*t.count||0,i+=t.count,t)));try{s=JSON.stringify(t)}catch(t){}let n={"product[items]":s,"product[price]":e,"product[total]":i};e&&(n=p({},n,{"pay[price]":e,"pay[desc]":""})),Object.entries(n).forEach((([t,e])=>{o.push({type:"hidden",name:t,value:e})})),this.addFields(o)}initFieldMask(){return"undefined"!=typeof IMask&&(this.needInitMasks=!1,this.$masked.each(((t,e)=>{ve.initMask(e);const i=!!e.getAttribute("data-placeholder"),s=e._mask;i&&s&&($(e).on(`focus${this.eventId}`,(()=>{s.updateOptions({lazy:!1})})),$(e).on(`blur${this.eventId}`,(()=>{if(!s.unmaskedValue){const t=s.mask.replace(/\*/g,"_"),e=s.value;s.updateOptions({lazy:!0}),s.masked.rawInputValue&&t!==e||(s.unmaskedValue="",s.value="",s.updateValue())}})))})),!0)}initFieldDate(){return this.needInitCalendar=!1,this.$calendars.each(((t,e)=>{ve.initCalendar(e,this.$root.find(".scroller")[0])})),!0}}Xt.registerComponents({background:class extends qt{constructor(...t){var e;super(...t),this.is="background";const{$component:i}=this;this.data={type:i.data("type")||"color",parallax:i.data("parallax")||0,video:i.data("video")||!1,videoType:i.data("video-type")||"color",infinityVideo:null!=(e=i.data("infinity-video"))&&e,mobileVideoEnabled:i.data("mobile-video-enabled")||!1,videoParallaxFactor:.6,hasImagePlaceholder:!!i.data("has-image-placeholder"),imageLoadingOptions:flexbe_cli.vars._group.images,isLazyLoading:!!i.data("lazy"),isImgLoaded:i.data("loaded"),originalResolution:!!i.data("original-resolution")}}async onInit(){this.$component.on("setImage",(async()=>{if(this.isVisible&&!this.isImgLoading&&!this.data.isImgLoaded){this.setImageParams();("image"===this.data.type||"video"===this.data.type&&"image"===this.data.videoType)&&await this.loadImage()}}))}onScreen({state:t}){this.videoInstance&&(this.data.infinityVideo||(t?this.videoInstance.play():this.videoInstance.pause())),this.onscreen=t,t&&!this.played&&this.playVideo()}async onBeside({state:t,first:e}){if(t&&e){this.setImageParams();const t="image"===this.data.type||"video"===this.data.type&&"image"===this.data.videoType;this.data.isLazyLoading&&!this.data.isImgLoaded&&this.image.id&&t&&await this.loadImage(),this.imageParallaxInit(),this.videoParallaxInit()}this.played||this.playVideo()}onResize(){this.bgEffect&&setTimeout((()=>{this.bgEffect.updateCanvasSource()}),150),"video"===this.data.type&&(this.videoInstance?(this.videoInstance.resize(),setTimeout((()=>{this.videoInstance.resize()}),150),this.data.parallax&&this.fixHolder&&this.setParallax&&setTimeout((()=>{this.fixHolder(),this.setParallax()}),100)):this.fixHolder&&this.fixHolder())}async loadImage(){this.isImgLoading=!0;const t={width:this.componentWidth,height:this.componentHeight},{width:e}=this.data.originalResolution?{width:0}:await k(this.image,t,p({},this.data.imageLoadingOptions,{sizes:Zt})),i=A(this.image,e,this.data.imageLoadingOptions);this.data.hasImagePlaceholder&&await b(i),this.setImage(i)}setImage(t){this.$component.find(".image").css("background-image",`url(${t})`),this.$component.addClass("image-loaded"),this.isImgLoading=!1,this.data.isImgLoaded=!0}setImageParams(){const t=this.$component.data();this.image={id:t.imgId,ext:t.imgExt,proportion:t.imgProportion,width:t.imgWidth,animated:t.imgAnimated,transparent:t.imgTransparent,scale:"cover",type:"background"}}imageParallaxInit(){if("image"!==this.data.type||!this.data.parallax||flexbe_cli.is_service)return;const{owner:t,$component:e,data:i}=this,s=t._core&&t._core.id||t.getAttribute("data-id");"object"==typeof t._bgEffects&&t._bgEffects.destroy(),"fixed"!==this.data.parallax&&(t._bgEffects=new Kt(s,e,i),this.bgEffect=t._bgEffects)}videoParallaxInit(){if("video"!==this.data.type||!this.data.parallax||!this.owner._core||flexbe_cli.is_service)return;const t=$(".image-holder, .video_bg_container",this.$component),e=t.find(".image"),i=t.find(".video_bg_player"),s=this.owner._core;let o=!1;const n=()=>D.viewportHeight<s.tween.height?s.tween.height+60:D.viewportHeight+60;this.fixHolder=()=>{"parallax"===this.data.parallax&&t.css("height",`${n()}px`)},this.setParallax=()=>{const t=s.$area[0].getBoundingClientRect().top+B.latest;let o;D.viewportWidth,D.viewportHeight,window.devicePixelRatio,"fixed"===this.data.parallax?o=0:"parallax"===this.data.parallax&&(o=1-(1-this.data.videoParallaxFactor)*(n()/D.viewportHeight),o<.1&&(o=this.data.videoParallaxFactor/2));const a=parseInt((B.latest-t)*-o,10)||0;e.css("transform",`translate3d(0, ${a}px, 0)`),i.css("transform",`translate3d(0, ${a}px, 0)`)},this.fixHolder(),this.setParallax(),s.$area.off("fixHeaderHeight.component-bg").on("fixHeaderHeight.component-bg",(()=>{this.setParallax()})),$(window).off(`scroll.component-bg-${s.id}`).on(`scroll.component-bg-${s.id}`,(()=>{!o&&this.onscreen&&(o=!0,requestAnimationFrame((()=>{this.setParallax(),o=!1})))}))}playVideo(){if(z.is_screen_mobile&&!this.data.mobileVideoEnabled)return!1;this.played=!0;const{data:t}=this,{video:e}=t;return!("video"!==t.type||!e)&&(!("custom"!==e.type&&!e.id)&&(this.videoInstance=new Jt(this,e,(()=>{this.videoParallaxInit()})),!0))}destroyVideo(){const{$component:t}=this;t.data("ytPlayer")&&t.data("ytPlayer").destroy(),t.removeData("video_bg_played")}},timer:class extends qt{constructor(...t){super(...t),this.is="timer"}onInit(){this.$timer=this.$component.find(".timer"),this.data=this.$timer.data("time"),this.initTimer()}initTimer(){const t=this.$timer,e=this.data,i=new Date;if("date"===e.type){const t=e.my?String(e.my).replace(".","/").split("/"):[1,2018];this.finalDate=new Date(t[1],parseInt(t[0],10)-1,e.d,e.h,e.m)}else if("monthly"===e.type)this.finalDate=new Date(i.getFullYear(),i.getMonth(),e.d,e.h,e.m),i.getTime()>this.finalDate.getTime()&&(this.finalDate=new Date(i.getFullYear(),i.getMonth()+1,e.d,e.h,e.m)),parseInt(e.d,10)!==this.finalDate.getDate()&&(this.finalDate.setDate(0),i.getTime()>this.finalDate.getTime()&&(this.finalDate=new Date(this.finalDate.getFullYear(),this.finalDate.getMonth()+2,0,e.h,e.m)));else if("weekly"===e.type){const t=parseInt(i.getDate(),10)-parseInt(i.getDay(),10)+parseInt(e.dw,10);this.finalDate=new Date(i.getFullYear(),i.getMonth(),t,e.h,e.m),i.getTime()>this.finalDate.getTime()&&this.finalDate.setDate(this.finalDate.getDate()+7)}else"daily"===e.type?(this.finalDate=new Date(i.getFullYear(),i.getMonth(),i.getDate(),e.h,e.m),i.getTime()>this.finalDate.getTime()&&this.finalDate.setDate(this.finalDate.getDate()+1)):(this.finalDate=new Date,this.finalDate.setMonth(this.finalDate.getMonth()+1,15));this.$itemDay1=t.find(".d [data-value]").eq(0),this.$itemDay2=t.find(".d [data-value]").eq(1),this.$itemDay3=t.find(".d [data-value]").eq(2),this.$itemHour1=t.find(".h [data-value]").eq(0),this.$itemHour2=t.find(".h [data-value]").eq(1),this.$itemMinute1=t.find(".m [data-value]").eq(0),this.$itemMinute2=t.find(".m [data-value]").eq(1),this.$itemSecond1=t.find(".s [data-value]").eq(0),this.$itemSecond2=t.find(".s [data-value]").eq(1),this.lastOffset={d:void 0,h:void 0,m:void 0,s:void 0},!flexbe_cli.is_admin&&"none"!==this.data.on_expired&&this.finalDate.getTime()<i.getTime()?("element"===this.data.on_expired?$(this.owner).hide():$(this.root).hide(),Rt.$blocks.each(((t,e)=>{e._core&&e._core.updateTween()}))):this.start()}tick(){if(this.secondLeft=this.finalDate.getTime()-(new Date).getTime(),this.secondLeft=Math.ceil(this.secondLeft/1e3),this.secondLeft=this.secondLeft<0?0:this.secondLeft,this.offset={d:Math.floor(this.secondLeft/60/60/24),h:Math.floor(this.secondLeft/60/60)%24,m:Math.floor(this.secondLeft/60)%60,s:this.secondLeft%60},this.lastOffset.d!==this.offset.d){const t=this.offset.d.toString().split("");t.length<2&&t.unshift(0),t.length<3&&t.unshift(0),this.$itemDay1.attr("data-value",t[0]).text(t[0]),this.$itemDay2.attr("data-value",t[1]).text(t[1]),this.$itemDay3.attr("data-value",t[2]).text(t[2])}if(this.lastOffset.h!==this.offset.h){const t=this.offset.h.toString().split("");t.length<2&&t.unshift(0),this.$itemHour1.attr("data-value",t[0]).text(t[0]),this.$itemHour2.attr("data-value",t[1]).text(t[1])}if(this.lastOffset.m!==this.offset.m){const t=this.offset.m.toString().split("");t.length<2&&t.unshift(0),this.$itemMinute1.attr("data-value",t[0]).text(t[0]),this.$itemMinute2.attr("data-value",t[1]).text(t[1])}if(this.lastOffset.s!==this.offset.s){const t=this.offset.s.toString().split("");t.length<2&&t.unshift(0),this.$itemSecond1.attr("data-value",t[0]).text(t[0]),this.$itemSecond2.attr("data-value",t[1]).text(t[1])}this.lastOffset=this.offset,this.secondLeft<0&&this.stop()}start(){this.tick(),clearInterval(this.interval),this.interval=setInterval((()=>{this.tick()}),200)}stop(){clearInterval(this.interval)}},video:class extends qt{constructor(...t){super(...t),this.is="video",this.type=this.$component.data("type"),this.autoplay=!!+this.$component.data("autoplay"),this.$preview=this.$component.find(".video-preview"),this.$iframe=this.$component.find("iframe"),this.$video=this.$component.find(".custom-video"),this.hasPreview=this.$preview.length,this.frameLoaded=!1,this.autoSet=!this.hasPreview,this.$preview.on("click",(()=>{this.set(),this.play(!0)})),this.$component.off("sliderActivate").on("sliderActivate",(()=>{this.preventAutoplay=!1,this.inScreen&&this.autoSet&&(this.set(),this.autoplay&&this.play())})),this.$component.off("sliderDeactivate").on("sliderDeactivate",(()=>{this.preventAutoplay=!0,this.pause()}))}onScreen({state:t}){t?((this.autoplay||this.autoSet)&&this.set(),this.autoplay&&!this.preventAutoplay&&this.play()):this.pause()}set(){this.isSet||(this.isSet=!0,"youtube"===this.type?this.initYoutube():"vimeo"===this.type?this.initVimeo():this.initCustom())}initCustom(){this.$component.addClass("loading");const t=this.$video[0],e=t.getAttribute("data-src"),i=t.getAttribute("src");if(e&&!i){const i=document.createElement("source");t.addEventListener("error",console.error),t.addEventListener("playing",(()=>this.onPlay())),t.addEventListener("pause",(()=>this.onPause())),i.addEventListener("error",console.error),i.setAttribute("type","video/mp4"),i.setAttribute("src",e),t.appendChild(i),t.load()}}initVimeo(){this.$component.addClass("loading");const t=this.$iframe[0],e=t.getAttribute("data-src"),i=t.getAttribute("src");e&&!i&&(t.src=e),M(["https://player.vimeo.com/api/player.js"],(()=>{this.vPlayer=new window.Vimeo.Player(t),this.onFrameLoaded((()=>{this.$component.addClass("loaded"),this.frameLoaded=!0})),this.vPlayer.on("bufferstart",(()=>{this.vPlayer.off("bufferstart"),this.$component.addClass("started")})),this.vPlayer.on("play",(()=>{this.onPlay()})),this.vPlayer.on("pause",(()=>{this.onPause()}))}))}initYoutube(){this.$component.addClass("loading");const t=this.$iframe[0],e=t.getAttribute("data-src"),i=t.getAttribute("src");this.onFrameLoaded((()=>{this.$component.addClass("loaded");const e=t=>{t!==window.YT.PlayerState.BUFFERING&&t!==window.YT.PlayerState.PLAYING||this.$component.addClass("started"),t===window.YT.PlayerState.PLAYING?this.onPlay():t!==window.YT.PlayerState.PAUSED&&t!==window.YT.PlayerState.ENDED||this.onPause()};M([`https://www.youtube.com/iframe_api?origin=${window.location.host}`],(()=>{((t,e)=>{if("function"!=typeof e||"function"!=typeof t)return!1;if(t())e();else{const i=setInterval((()=>{t()&&(clearInterval(i),e())}),10)}})((()=>window.YT&&window.YT.Player),(()=>{this.ytVideo=new window.YT.Player(t,{events:{onStateChange:t=>{e(t.data)},onReady:()=>{e(this.ytVideo.getPlayerState())}}})}))}))})),e&&!i&&(t.src=e)}play(t=!1){this.isAutoplayed=!t,this.isPaused=!1,this.onFrameLoaded((()=>{if("custom"===this.type)this.$video[0].play();else if("vimeo"===this.type&&this.vPlayer)this.vPlayer.play();else if("youtube"===this.type){const t=this.$iframe[0];(t&&t.contentWindow).postMessage('{"event":"command","func":"playVideo","args":""}',"*")}this.hasPreview&&this.$preview.fadeOut(150,(()=>{this.$preview.remove()}))})),this.hasPreview&&this.$preview.off("click").addClass("preloading")}pause(){this.isAutoplayed=!1,this.isPaused=!0,this.onFrameLoaded((()=>{try{if("custom"===this.type)this.$video[0].pause();else if("vimeo"===this.type&&this.vPlayer)this.vPlayer.pause();else if("youtube"===this.type){const t=this.$iframe[0];(t&&t.contentWindow).postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}}catch(t){}}))}onFrameLoaded(t=(()=>{})){this.frameLoaded?t():"custom"===this.type?(this.frameLoaded=!0,t()):this.$iframe.one("load",(()=>{this.frameLoaded=!0,t()}))}onPlay(){this.autoplay&&this.isAutoplayed||(this._sliderAutoplayPrevented=!0,this.$component.trigger("preventSliderAutoplay",{state:!0}))}onPause(){this._sliderAutoplayPrevented&&(this._sliderAutoplayPrevented=!1,this.$component.trigger("preventSliderAutoplay",{state:!1}))}},image:class extends qt{constructor(...t){super(...t),this.is="image"}async onInit(){this.$component.off(".componentImage").on("setImage.componentImage sliderActivate.componentImage",$.debounce((async t=>{this.autoLoad=!0,this.lazyLoad=!0,"sliderActivate"===t.type?this.inBeside&&this.isVisible&&!this.isImgLoading&&!this.isImgLoaded&&await this.loadImage():"setImage"===t.type&&(!this.isVisible||this.isImgLoading||this.isImgLoaded||await this.loadImage())}),10))}async onBeside({state:t}){if(!t)return!1;this.isCreated||await this.create(),this.autoLoad&&this.lazyLoad&&!this.isImgLoaded&&await this.loadImage()}async onResize(){this.isCreated&&await this.loadImage(!0)}async create(){this.isCreated=!0,this.imageLoadingOptions=flexbe_cli.vars._group.images,this.lazyLoad=!!+this.$component.data("img-lazy"),this.autoLoad=!!+this.$component.data("img-autoload"),this.isImgLoaded=!!+this.$component.data("img-loaded"),this.hasImagePlaceholder=!!this.$component.data("has-image-placeholder"),this.img=this.$component.find("img").get(0),this.layer=this.$component.find("[data-img-layer]").get(0)||this.component,this.overlay=this.$component.find(".overlay-container").get(0),this.setParams(),this.img&&(this.isImgLoaded||!this.autoLoad||this.lazyLoad||await this.loadImage())}async loadImage(t=!1){if(this.isCreated||await this.create(),!t&&(this.isImgLoaded||this.isImgLoading))return;this.isImgLoading=!0,this.setOverlay();const e=this.params;let i;e.original_resolution||(i=await this.getOptimalSize(),i&&te[this.params.id].sizes&&!te[this.params.id].sizes.includes(i)&&te[this.params.id].sizes.push(i));const s=A(e,i,this.imageLoadingOptions);this.hasImagePlaceholder&&await b(s),this.setImage(s),this.isImgLoading=!1}async getOptimalSize(){const t=this.params,e=await C(t);t.proportion=e,te[this.params.id]&&(te[this.params.id].params.proportion=e);const i="fixed"===t.attachment?flexbe_cli.resize.viewportWidth:this.componentWidth,s="fixed"===t.attachment?flexbe_cli.resize.viewportHeight:this.componentHeight;let{width:o}=await k(this.params,{width:i,height:s},this.imageLoadingOptions);const n=o-2,a=Math.max(50,1.2*o);return o=this.getClosestSize(o,n,a),o}setImage(t){const{$component:e,params:i}=this;this.img&&(this.img.src=t),"background"===i.type&&(this.layer.style.backgroundImage=`url(${t})`),this.isImgLoaded||(e.removeClass("loading"),this.isImgLoaded=!0),e.trigger("load")}setOverlay(){const{overlay:t,componentWidth:e,componentHeight:i}=this;if(!t)return;let s="medium";e<=200||i<=150?s="xsmall":e<=400||i<=250?s="small":e>=650&&i>=400&&(s="large"),t.setAttribute("data-size",s),"hover"===t.getAttribute("data-type")&&$(t).on("mouseenter mouseleave touchstart touchend",(e=>{const i=/enter|start/.test(e.type);$(t).toggleClass("hover",i)}))}setParams(){var t;const e=$(this.component),i=this.img;let s={};const o=e.data("img-id");if(null!=(t=te[o])&&t.params)s=p({},te[o].params);else{s.id=o,s.ext=e.data("img-ext"),s.proportion=+e.data("img-proportion");const t=e.data("img-name");if(!s.ext&&t){const e=t.match(/\.(\D{2,4})$/i)||[];e[1]&&s.ext!==e[1]&&(s.ext=e[1]||!1)}}s.x=e.data("img-x"),s.y=e.data("img-y"),s.type=e.data("img-type"),s.action=e.data("action"),!s.proportion&&i&&i.src&&(s.proportion=i.naturalHeight/i.naturalWidth*100),s.scale=e.data("img-scale")||"cover",s.original_resolution=+e.data("original-resolution"),te[s.id]||(te[s.id]={params:p({},s),sizes:[]}),s.animated=e.data("img-animated"),s.width=e.data("img-width"),s.transparent=e.data("img-transparent"),s.attachment=e.data("img-attachment"),this.params=s}getClosestSize(t,e=t,i=t+10){var s;const o=te[this.params.id].sizes||[];let n,a=1/0;return o.forEach((s=>{const o=Math.abs(s-t);s>=e&&s<=i&&o<a&&(n=s,a=o)})),null!=(s=n)?s:t}},videoBackground:Jt,rangeInput:ee,selectInput:se,icon:class extends qt{constructor(...t){super(...t),u(this,"is",void 0),u(this,"isCreated",void 0),u(this,"isImgLoaded",void 0),u(this,"isLazyLoading",void 0),u(this,"isVisible",void 0),u(this,"svgUrl",void 0),u(this,"image",void 0),u(this,"imageLoadingOptions",void 0),this.is="icon"}async onInit(){this.$component.on("setImage",(async()=>{this.isVisible&&!this.isImgLoaded&&(this.isCreated||this.create(),await this.loadImage())}))}async onBeside({state:t}){if(!t)return!1;this.isCreated||this.create(),this.isLazyLoading&&!this.isImgLoaded&&await this.loadImage()}async onResize(){this.isCreated&&await this.loadImage()}create(){const t=this.$component.data();this.imageLoadingOptions=flexbe_cli.vars._group.images,this.svgUrl=t.svgUrl,this.isLazyLoading=!!t.imgLazy,this.image={id:t.imgId,ext:t.imgExt,proportion:t.imgProportion,width:t.imgWidth,animated:t.imgAnimated,transparent:t.imgTransparent,scale:t.imgScale,type:"background"},this.isCreated=!0}async loadImage(){const t=this.$component.find(".vector-icon use"),e=this.$component.find(".raster-icon");if(t.length&&t.attr("href",this.svgUrl),e.length){const t={width:this.componentWidth,height:this.componentHeight},{width:i}=await k(this.image,t,p({},this.imageLoadingOptions,{sizes:oe})),s=A(this.image,i,this.imageLoadingOptions);e.css("background-image",`url(${s})`)}this.isImgLoaded=!0}},map:class{constructor(t){var e;return"yandex"===(null!=(e=t.component.getAttribute("data-type"))?e:"yandex")?new re(t):new ae(t)}},slider:class extends qt{constructor(...t){super(...t);const{component:e}=this;this.require=["/_s/lib/swiper7/dist/swiper-bundle.min.js?v1"],this.is="slider",this.swiper=null,this.initialSlide=0,this.index=$(e).closest("[data-item-id]").attr("data-item-id"),this.sliderEl=e.querySelector(".swiper"),this.paginationEl=e.querySelector(".slider-pagination"),this.prevEl=e.querySelector('.slider-prev, [data-direction="prev"]'),this.nextEl=e.querySelector('.slider-next, [data-direction="next"]');const i=this.paginationEl&&this.paginationEl.getAttribute("data-type")||"bullets";this.options={paginationType:i,count:e.getAttribute("data-count"),loop:Boolean(!flexbe_cli.is_admin&&Math.floor(e.getAttribute("data-loop"))),autoplay:!flexbe_cli.is_admin&&Math.floor(e.getAttribute("data-autoplay"))||!1,effect:e.getAttribute("data-effect")||"slide"}}onInit(){this.isUpdated&&this.isLoaded&&this.initSwiper()}onLoad(){if(!this.inScreen&&!this.inBeside)return!1;this.initSwiper()}onView({state:t}){this.isLoaded&&(t&&!this.swiper&&this.initSwiper(),this.swiper&&this.toggleAutoplay({state:t}))}onScreen({state:t}){if(t)return!!this.isLoaded&&void(this.swiper||this.initSwiper())}onBeside({state:t}){t&&this.isLoaded&&!this.swiper&&this.initSwiper()}onResize(){this.setComponentSize(),this.setSliderClasses(),this.swiper&&this.swiper.initialized&&this.swiper.update()}initSwiper(){if(this.swiper||"undefined"==typeof Swiper)return!1;if(this.options.count<=1)return void Ct((()=>this.loadImages()),10);const{options:t,component:e,core:i,root:s,index:o,sliderEl:n,paginationEl:a,prevEl:r,nextEl:l}=this,d=`${i&&i.id||"-"}:${o}`,{count:c,loop:h,paginationType:u,effect:p}=t,m=this.owner.closest(".swiper-inited"),f={prevEl:r,nextEl:l},g={el:a,type:u,clickable:4!==flexbe_cli.theme_id||!h,modifierClass:"slider-pagination-"},v=!!t.autoplay&&{delay:1e3*t.autoplay,stopOnLastSlide:!h,disableOnInteraction:!1};let b,w=this.initialSlide;if(flexbe_cli.is_admin){s._sliderState||(s._sliderState={});const t=s._sliderState;t[d]&&(w=Math.max(0,Math.min(c-1,t[d])||0)),t[d]=w}if("thumbs"===u){g.type=!1,g.el=null;const t=new Swiper(a.querySelector(".thumbs-slider"),{wrapperClass:"thumbs",slideClass:"thumb-item",loop:!1,slidesPerView:"auto",watchSlidesProgress:!0,watchSlidesVisibility:!0,roundLengths:!0,freeMode:{enabled:!0,sticky:!0},normalizeSlideIndex:!1});b={swiper:t,autoScrollOffset:1,slideThumbActiveClass:"thumb-item--active"},this.thumbsSwiper=t}const y=new Swiper(n,{init:!1,speed:"fade"===p?450:300,nested:m,wrapperClass:"swiper-wrapper",slideClass:"swiper-slide",noSwipingClass:"redactor-box",initialSlide:w,navigation:f,pagination:g,thumbs:b,autoplay:v,effect:p,loop:h,fadeEffect:{crossFade:!0},observer:!0,observeParents:!0,passiveListeners:!0,shortSwipes:!0,longSwipes:!0,longSwipesMs:150,longSwipesRatio:.2,threshold:0,touchReleaseOnEdges:!1,preventInteractionOnTransition:!1,loopPreventsSlide:!0,simulateTouch:!flexbe_cli.run.isTouch&&!flexbe_cli.is_admin,roundLengths:!0,touchMoveStopPropagation:!1,preventClicksPropagation:!0,preventClicks:!0,runCallbacksOnInit:!1});this.swiper=y,y.on("init",At((()=>{if(this.setComponentSize(),this.setSliderClasses(),$(r).add(l).removeClass("disabled"),"thumbs"===u&&$(a).removeClass("disabled"),h){$(".swiper-slide-duplicate",e).attr("data-cloned",!0),Ct((()=>{Xt.initComponents({core:i})}))}const t=y.slides[y.previousIndex],s=y.slides[y.activeIndex];Ct((()=>{null!=t&&he(t,!1,"sliderDeactivate"),null!=s&&he(s,!1,"sliderActivate")}),10)})));let _=!1;h&&y.on("slideChangeTransitionEnd",(()=>{y.activeIndex!==y.realIndex+1?(_=!0,y.slideToLoop(y.realIndex,0)):_=!1})),y.on("slideChange",(()=>{if(_)return;const t=y.slides[y.previousIndex],i=y.slides[y.activeIndex],o=i&&i.getAttribute("data-type")||"image";e.setAttribute("data-current-index",y.realIndex),e.setAttribute("data-current-content",o),flexbe_cli.is_admin&&(s._sliderState[d]=y.realIndex),Ct((()=>{he(t,!1,"sliderDeactivate"),he(i,!1,"sliderActivate"),y.initialized&&this.loadImages()}),10)})),y.on("slideChangeTransitionStart touchStart",(()=>{$(n).addClass("slider-in-animation")})),y.on("slideChangeTransitionEnd touchEnd",(()=>{$(n).removeClass("slider-in-animation")})),y.on("paginationRender",(()=>{4===flexbe_cli.theme_id&&"bullets"===g.type&&(h?this.loopPagination=new ce(a,{init:!1,tag:"span",onClick:t=>{t<0?y.slidePrev():t>0&&y.slideNext()}}):this.bulletsPagination=new de(a,{init:!1,targets:"span",active:y.realIndex})),$(a).removeClass("disabled")})),y.on("paginationUpdate",(()=>{if(!_)if(this.bulletsPagination)this.bulletsPagination.setActive(y.realIndex);else if(this.loopPagination){const t=y.previousIndex<y.activeIndex?"next":"prev";this.loopPagination.setActive(t)}})),this.$component.on("preventSliderAutoplay",((t,{state:e=!0})=>{this.preventAutoplay=!!e,this.preventAutoplay&&this.toggleAutoplay({state:!1})})),Ct((()=>{y.init(),this.toggleAutoplay({state:this.inView})}))}loadImages(){this._imagesLoaded||(he(this.$component,"image","setImage"),this._imagesLoaded=!0)}toggleAutoplay({state:t}){if(!this.swiper)return!1;const{swiper:e,options:i}=this;this.preventAutoplay&&(t=!1),i.autoplay&&e.autoplay&&(t&&!e.autoplay.running?e.autoplay.start():!t&&e.autoplay.running&&e.autoplay.stop())}slideTo(t,e=!0){if(!this.swiper)return void(this.initialSlide=t);const i=this.swiper.params.loop;void 0!==this.swiper.realIndex&&this.swiper.realIndex!==t&&(i?this.swiper.slideToLoop(t,e?null:0):this.swiper.slideTo(t,e?this.swiper.params.speed:0))}setSliderClasses(){if(!this.swiper)return;const{effect:t}=this.swiper.params,e=$(this.sliderEl);this._inited||(this._inited=!0,e.addClass("swiper-inited")),this._activeEffect!==t&&(this._activeEffect=t,e.toggleClass("swiper-effect-slide","slide"===t),e.toggleClass("swiper-effect-fade","fade"===t))}setComponentSize(){const t=this.$component.find(".swiper");if(!t.length)return;const e=t[0];e.style.width="";const i=e.getBoundingClientRect().width,s=e.offsetWidth;if(i%1>0&&Math.abs(s-i)<2&&(e.style.width=`${Math.round(i)}px`,this.swiper&&this.swiper.update()),"thumbs"===this.options.paginationType){const t=$(this.paginationEl).find(".thumbs-slider"),e=t.find(".thumb-item"),i=4,s=e.length,o=this.thumbsSwiper&&this.thumbsSwiper.params.slidesPerView;t.css("width",""),e.css("width","");const n=t[0].offsetWidth,a=e[0].offsetWidth;let r=Math.max(i,Math.round(n/a));s>=i&&(s===r+1||s===r-1)?r=s:!o||o!==r+1&&o!==r-1||(r=o);const l=Math.round(n/r)*r;n!==l&&t.css("width",`${l}px`),t.toggleClass("is-filled",s>=r),this.thumbsSwiper&&(this.thumbsSwiper.params.slidesPerView=r,this.thumbsSwiper.update())}}},bulletsPagination:de,bulletsLoopPagination:ce,backgroundElement:class extends qt{constructor(...t){super(...t),this.is="backgroundElement",this.$bgElement=this.$component.find(".bg-element__fill"),this.$hoverElement=this.$component.find(".bg-element__fill_hover"),this.lazy=this.$bgElement.data("lazy"),this.isImgLoaded=this.$bgElement.data("loaded"),this.bgType=this.$bgElement.data("type"),this.hoverType=this.$hoverElement.data("hover-type"),this.hasImagePlaceholder=!!this.$bgElement.data("has-image-placeholder"),this.imageLoadingOptions=flexbe_cli.vars._group.images}async onInit(){this.$bgElement.on("setImage",(async()=>{!this.isVisible||this.isImgLoading||this.isImgLoaded||(this.setImageParams(),await this.loadImage())}))}async onBeside({state:t,first:e}){t&&e&&(this.lazy&&"image"===this.bgType&&!this.isImgLoaded&&(this.setImageParams(),await this.loadImage()),"image"===this.hoverType&&(this.setHoverImageParams(),await this.loadHoverImage()),this.dispatchEffects())}onWindowResize(){this.dispatchEffects()}getComponentSize(){return{width:this.componentWidth,height:this.componentHeight}}dispatchEffects(){var t,e;const i=t=>[!0,1,"true","1"].includes(t),s="mobile"===flexbe_cli.resize.responsiveMode,o=i(null==(t=this.$component.data("effects-desktop"))||t),n=i(null==(e=this.$component.data("effects-mobile"))||e),a=s?n:o;this.$component.toggleClass("bg-element--hover",a)}async loadImage(){this.isImgLoading=!0;const{width:t}=await k(this.image,this.getComponentSize(),this.imageLoadingOptions),e=A(this.image,t,this.imageLoadingOptions);this.hasImagePlaceholder&&await b(e),this.setImage(this.$bgElement,e),this.isImgLoading=!1,this.isImgLoaded=!0}async loadHoverImage(){const{width:t}=await k(this.hoverImage,this.getComponentSize(),this.imageLoadingOptions),e=A(this.hoverImage,t,this.imageLoadingOptions);this.setImage(this.$hoverElement,e)}setImage(t,e){t.css("background-image",`url(${e})`),this.$component.addClass("image-loaded")}setImageParams(){const{$bgElement:t}=this;this.image={id:t.data("id"),ext:t.data("ext"),width:t.data("width"),animated:t.data("animated"),transparent:t.data("transparent"),proportion:t.data("proportion"),type:"background",scale:"cover"}}setHoverImageParams(){const{$hoverElement:t}=this;this.hoverImage={id:t.data("id"),ext:t.data("ext"),width:t.data("width"),animated:t.data("animated"),transparent:t.data("transparent"),proportion:t.data("proportion"),type:"background",scale:"cover"}}},cards:class extends qt{constructor(...t){super(...t);const{component:e,$component:i}=this;this.is="cards",this.mode=e.getAttribute("data-mode"),"slider"===this.mode&&(this.require=["/_s/lib/swiper7/dist/swiper-bundle.min.js?v1"],this.$cardsRoot=i.closest(".flexbe-cards-root"),this.$slider=this.$cardsRoot.find(".swiper"),this.$pagination=this.$cardsRoot.find(".slider-pagination--cards"),this.$navigation=this.$cardsRoot.find(".slider-button--cards"),this.$swiperHelper=this.$cardsRoot.find(".swiper-mobile-helper"),this.$flexbeCardsSlider=this.$cardsRoot.find(".flexbe-cards-slider"),this.$flexbeCards=this.$cardsRoot.find(".flexbe-cards"),this.$flexbeCard=this.$cardsRoot.find(".flexbe-card"),this.sliderResponsive=this.$slider.attr("data-slider-responsive-mode"))}onLoad(){this.core.isVisible&&this.sliderDisposer(),this.core.inView&&this.initSwiperAnimation()}onBeside({state:t}){this.isLoaded&&t&&this.sliderDisposer()}onScreen({state:t}){t||this.destroySwipeAnimation()}onResize(){if(this.isLoaded&&this.sliderDisposer(),this.swiper){const t=this.getAdaptiveSwiperSettings();this.settings=p({},this.settings,t),this.swiper.params=p({},this.swiper.params,t),this.swiper.update(),this.checkSlidesVisibility()}}onView({state:t}){t&&!this.wasView&&this.swiper&&this.swiper.inited&&(this.swiper.update(),this.checkSlidesVisibility(),this.checkNavigationState()),this.toggleAutoplay(t),t&&this.isLoaded&&this.initSwiperAnimation()}sliderDisposer(){if("slider"!==this.mode)return;const t="mobile"===flexbe_cli.resize.responsiveMode,e=this.sliderResponsive,i=t?"desktop"!==e:"mobile"!==e;i&&!this.swiper?this.initSlider():i||this.destroySlider()}initSlider(){if("slider"===this.mode&&!this.swiper&&"undefined"!=typeof Swiper){Ct((()=>{this.$cardsRoot.addClass("slider-active slider-inited slider-enabled"),this.$cardsRoot.removeClass("slider-disabled"),this.$flexbeCardsSlider.addClass("swiper-active"),this.$flexbeCards.addClass("swiper-wrapper")}));try{this.savePropsFromAttributes(),this.createSwiperSettings(),this.createSwiperInstance(),this.createSwiperNavigation(),this.createSwiperPagination(),this.createSwiperEditorFixes(),Ct((()=>{this.swiper.init(),Ct((()=>this.toggleAutoplay(this.core.inView)))}))}catch(t){console.warn(t)}}}destroySlider(){"slider"===this.mode&&(this.swiper&&this.swiper.destroy(),this.swiper=null,this.$cardsRoot.removeClass("slider-active slider-inited slider-enabled"),this.$cardsRoot.addClass("slider-disabled"),this.$flexbeCardsSlider.removeClass("swiper-active"),this.$flexbeCards.removeClass("swiper-wrapper"),this.$flexbeCard.removeClass("swiper-slide-hidden"))}initSwiperAnimation(){if("slider"!==this.mode)return;"mobile"===flexbe_cli.resize.responsiveMode&&"desktop"!==this.sliderResponsive&&!this.$swiperHelper.hasClass("show")&&setTimeout((()=>{this.core.inView&&(this.$swiperHelper.addClass("show"),this.swiper.once("sliderMove",(()=>{this.destroySwipeAnimation()})))}),500)}destroySwipeAnimation(){"slider"===this.mode&&this.$swiperHelper.hasClass("show")&&this.$swiperHelper.removeClass("show")}savePropsFromAttributes(){this.props={totalSlides:+this.$slider.attr("data-count"),isOverflow:+this.$slider.attr("data-overflow"),autoplayDelay:!flexbe_cli.is_admin&&Math.floor(1e3*+this.$slider.attr("data-autoplay"))||0,pagination:this.$pagination.attr("data-type")||!1,loop:!flexbe_cli.is_admin&&!!+this.$slider.attr("data-loop"),effectDesktop:this.$slider.attr("data-effect"),effectMobile:this.$slider.attr("data-effect-mobile"),inRowDesktop:+this.$slider.attr("data-cards"),inRowMobile:+this.$slider.attr("data-cards-mobile")||1}}createSwiperSettings(){const t=this.getAdaptiveSwiperSettings(),{totalSlides:e,isOverflow:i,autoplayDelay:s,pagination:o}=this.props,n=!(e<=t.slidesPerView)&&this.props.loop;let a=0;if(flexbe_cli.is_admin&&(a=Math.floor($(this.root).data("slide-move"))||0,a=Math.max(0,Math.min(e-1,a))),this.freeSlides=0,n&&!i){const e=this.$slider[0].offsetWidth,i=e/t.slidesPerView,s=(D.viewportWidth-e)/2;this.freeSlides=Math.ceil(s/i)}this.settings=p({autoHeight:!1,preloadImages:!1,allowClick:!0,preventClicks:!1,preventClicksPropagation:!1,touchStartPreventDefault:!1,touchMoveStopPropagation:!1,passiveListeners:!0,longSwipes:!0,longSwipesMs:150,longSwipesRatio:.2,shortSwipes:!0,threshold:10,touchReleaseOnEdges:!0,preventInteractionOnTransition:!1,loopPreventsSlide:!1,simulateTouch:!flexbe_cli.run.isTouch&&!flexbe_cli.is_admin,edgeSwipeDetection:!1,edgeSwipeThreshold:0,virtualTranslate:!0,resistanceRatio:.65,initialSlide:a,loop:n,freeMode:{enabled:!0,sticky:!0,momentum:!0,momentumRatio:1,momentumVelocityRatio:.1},autoplay:!!s&&{delay:s,stopOnLastSlide:!n,disableOnInteraction:!0,waitForTransition:!0},fadeEffect:{crossFade:!0},navigation:{},pagination:{clickable:!1,type:o,el:this.$pagination[0],renderBullet:()=>"",formatFractionCurrent:()=>this.getGroupIndex()+1,formatFractionTotal:()=>Math.ceil(this.props.totalSlides/this.swiper.params.slidesPerView)},watchSlidesProgress:!0,loopedSlides:t.slidesPerView+this.freeSlides},t)}getAdaptiveSwiperSettings(){const t="mobile"===flexbe_cli.resize.responsiveMode,e=t?this.props.inRowMobile:this.props.inRowDesktop;let i=t?this.props.effectMobile:this.props.effectDesktop;return e>1&&(i="slide"),{effect:i,speed:"fade"===i?450:300,slidesPerGroup:1,slidesPerView:e}}createSwiperInstance(){this.swiper&&(this.swiper.destroy(),this.swiper=null);let t,e,i=!1;const s=new Swiper(this.$slider[0],p({init:!1,wrapperClass:"flexbe-cards",slideClass:"flexbe-card",noSwipingClass:"redactor-box"},this.settings)),o=()=>{const{effect:o,slidesPerView:n}=s.params,a=this.props.totalSlides>n;i||(i=!0,this.$cardsRoot.addClass("slider-inited"),this.$slider.addClass("swiper-inited")),e!==o&&(e=o,this.$slider.toggleClass("swiper-effect-slide","slide"===o),this.$slider.toggleClass("swiper-effect-fade","fade"===o)),t!==a&&(t=a,this.$cardsRoot.toggleClass("slider-active",a),this.$slider.toggleClass("swiper-active",a),s.update())},n=()=>{if(s.loopedSlides){const t=$(s.slides).filter(`.${s.params.slideDuplicateClass}`),e={};t.each(((t,i)=>{const s=$(i),o=s.attr("data-swiper-slide-index");e[o]=e[o]?e[o]+1:1,s.attr("data-cloned",e[o])})),zt.initArea(t),xt.initIosHacks(t),Xt.initComponents({core:this.core})}};s.on("init",(()=>{requestAnimationFrame((()=>{o(),n(),this.checkSlidesVisibility()}))})),s.on("slideChange",(()=>{requestAnimationFrame((()=>{this.checkSlidesVisibility()}))})),s.on("resize",$.debounce((()=>{this.swiper&&requestAnimationFrame((()=>{o(),this.checkSlidesVisibility()}))}),50)),s.on("setTranslate",((t,e)=>{const i=t.$wrapperEl,s=t.isHorizontal(),o=s?e:0,n=s?0:e;"slide"===t.params.effect?(flexbe_cli.is_admin?i.css({position:"relative",top:`${n}px`,left:`${o}px`}):i.css({transform:`translate3d(${o}px, ${n}px, 0px)`}),t.slides.css({opacity:"",transform:""})):"fade"===t.params.effect&&i.css({transform:""})}));let a=!1;const r=()=>{this.$cardsRoot.addClass("slider-in-animation"),this.checkSlidesVisibility()},l=()=>{this.$cardsRoot.removeClass("slider-in-animation"),this.checkSlidesVisibility()};s.on("sliderFirstMove",(()=>{a=!0,r()})),s.on("touchEnd",(()=>{a=!1,l()})),s.on("transitionStart",(()=>{a||r()})),s.on("transitionEnd",(()=>{a||l()})),this.$slider.on("preventSliderAutoplay",((t,{state:e=!0})=>{this.preventAutoplay=!!e,this.preventAutoplay&&this.toggleAutoplay({state:!1})})),this.$slider.on("preventSliderMove",((t,{state:e=!0})=>{s.allowTouchMove=!e})),this.swiper=s}createSwiperNavigation(){const t=this.swiper;t.on("init",(()=>{this.checkNavigationState()})),t.on("resize",$.debounce((()=>{this.swiper&&this.checkNavigationState()}),50)),t.on("slideChange",(()=>{this._skipSlide||this.checkNavigationState()})),this.$navigation.on("click",(t=>{this["prev"===t.currentTarget.getAttribute("data-direction")?"prevSlide":"nextSlide"]()})),this.$slider.on("click.swiper-hidden",".swiper-slide-hidden",(e=>{e.preventDefault(),e.stopPropagation();const i=e.currentTarget,s=Array.from(t.slides||[]).findIndex((t=>t===i)),o=t.activeIndex,n=o-s,a=s-(o+t.params.slidesPerView-1);n>0?this.prevSlide(n):a>0&&this.nextSlide(a)}))}createSwiperPagination(){const t=this.swiper;let e=!1;t.on("paginationRender",(()=>{const e=t.params;if("bullets"===e.pagination.type)if(t.loopedSlides)this.loopPagination=new ce(this.$pagination[0],{init:!1,tag:"span",onClick:t=>{t<0?this.prevSlide():t>0&&this.nextSlide()}});else{const i=e.pagination.bulletElement||"span",s=e.pagination.bulletClass||"span",o=e.slidesPerView||1,n=Math.ceil(this.props.totalSlides/o);let a=new Array(n).fill();a=a.map(((t,e)=>`<${i} class="${s}" data-index="${e}"></${i}>`)).join(""),this.$pagination.html(a),this.bulletsPagination=new de(this.$pagination[0],{init:!1,targets:"span",active:t.realIndex,onClick:(t,e)=>{e!==t&&this.toSlide(t)}})}this.$pagination.toggleClass("disabled",this.props.totalSlides<=t.params.slidesPerView)})),t.on("paginationUpdate",(()=>{if(!this._skipSlide){if(this.bulletsPagination){const e=this.getGroupIndex(t.realIndex);this.bulletsPagination.setActive(e)}else if(this.loopPagination){const i=t.previousIndex,s=t.activeIndex,o=this.props.totalSlides,n=i<s?"next":"prev";!!(i===s||"next"===n&&i===s-o||"prev"===n&&i===s+o)&&e||this.loopPagination.setActive(n)}e=!0}}))}createSwiperEditorFixes(){if(!flexbe_cli.is_admin)return;const t=this.swiper;t.on("slideChange",(()=>{$(this.root).data("slide-move",t.realIndex)}))}checkSlidesVisibility(){const t=this.swiper;t.updateSlides();const e=$(t.slides),i=e.slice(t.activeIndex,t.activeIndex+t.params.slidesPerView),s=e.not(i);s.removeClass("swiper-slide-visible").addClass("swiper-slide-hidden"),i.removeClass("swiper-slide-hidden").addClass("swiper-slide-visible"),he(s,!1,"sliderDeactivate"),he(i,!1,"sliderActivate")}checkNavigationState(){const t=this.swiper,e=t.params.navigation.disabledClass,i=this.$navigation,s=i.eq(0),o=i.eq(1);let{isBeginning:n,isEnd:a}=t;t.loopedSlides&&(n=!1,a=!1),i.toggleClass("disabled",this.props.totalSlides<=t.params.slidesPerView),s.toggleClass(e,n),o.toggleClass(e,a)}getGroupIndex(t,e,i=!0){const s=this.swiper;null==t&&(t=s.realIndex),e||(e=s.params.slidesPerView||1),i&&(s.loopedSlides||e<=1)&&(i=!1);const o=Math.ceil(this.props.totalSlides/e);let n=Math.floor(t/e);if(i){const i=n*e,s=t-i>i+e-1-t,o=t%e!=0&&t+e>=this.props.totalSlides;(s||o)&&(n+=1)}return Math.max(0,Math.min(o,n))}getSlideIndex(t,e){return null==e&&(e=this.swiper.params.slidesPerView||1),t*e}toSlide(t,e){const i=this.swiper,s=this.getSlideIndex(t,e);return i.loopedSlides?i.slideToLoop(s):i.slideTo(s)}prevSlide(t){let e;const i=this.swiper;if(i.animating)return;t=t?Math.abs(t):1;const s=i.activeIndex;if(i.loopedSlides){const o=s>=(this.props.isOverflow?t:t+this.freeSlides);s+this.props.totalSlides<=i.slides.length&&!o&&(this.toggleSkip(!0),i.slideTo(s+this.props.totalSlides,0)),e=i.activeIndex-t}else e=i.activeIndex-t;setTimeout((()=>{this.toggleSkip(!1),i.slideTo(e)}),5)}nextSlide(t){let e;const i=this.swiper,s=i.params.slidesPerView;if(i.animating)return;t=t?Math.abs(t):1;const o=i.activeIndex,n=o+s-1;if(i.loopedSlides){const s=i.slides.length-n-1>=(this.props.isOverflow?t:t+this.freeSlides);o-this.props.totalSlides>=0&&!s&&(this.toggleSkip(!0),i.slideTo(o-this.props.totalSlides,0)),e=i.activeIndex+t}else e=i.activeIndex+t;setTimeout((()=>{this.toggleSkip(!1),i.slideTo(e)}),5)}toggleSkip(t=!this._skipSlide){this._skipSlide=!!t,this.$slider.toggleClass("noanimate",this._skipSlide)}toggleAutoplay(t){if(!this.swiper)return;this.preventAutoplay&&(t=!1);const e=this.swiper,i=e.autoplay,s=e.params.autoplay||{};i&&s.enabled&&(t&&!i.running?i.start():t||i.stop())}},menu:class extends qt{get showOnClick(){return"click"===this.showType||"mobile"===flexbe_cli.resize.responsiveMode||flexbe_cli.run.is_touch}get showOnHover(){return"hover"===this.showType&&"desktop"===flexbe_cli.resize.responsiveMode&&flexbe_cli.run.is_pointer}get isRowDirection(){return"row"===("desktop"===flexbe_cli.resize.responsiveMode?this.direction:this.directionAdaptive)}get showAsPopup(){return"desktop"===flexbe_cli.resize.responsiveMode||this.isRowDirection}constructor(...t){super(...t),this.is="menu",this.eventId=this.owner._core.id,this.rootModal="modal"===this.core.is&&this.core,this.$menuList=this.$component.find(".component-menu-list--root"),this.showType=this.$component.attr("data-type"),this.direction=this.$component.attr("data-direction"),this.directionAdaptive=this.$component.attr("data-direction-adaptive"),this.allowShowMore="true"===this.$component.attr("data-show_more"),this.isNested=!!this.$menuList.find(".folder-item").length,this.openFolders=[]}onBeside({state:t,first:e}){t&&e&&(this.bindEvents(),this.dispatchShowMore(),this.$button=this.$component.find(".folder-item"),this.$header=this.$button.closest(".floating-header"),this.$header.length&&this.$header.off("sticky_header").on("sticky_header",(()=>{this._closeFolder()})))}onResize(t={}){["bottom","top"].includes(t.type)||(this.dispatchShowMore(),this.openFolders.forEach((t=>{t.$dropdown?this.setDropdownPosition(t):this.showAsPopup&&this._closeFolder(t)})))}onWindowResize(){this.onResize()}onClose(){this.toggleFolder(null,!1)}bindEvents(){$(window).off(`.${this.eventId}`),this.$component.off(".core"),flexbe_cli.is_admin&&this.$component.on("mouseup.core.prevent click.core.prevent",".folder-item",(t=>{t.stopPropagation()})),$(window).on(`blur.${this.eventId}`,(()=>{this.showAsPopup&&this._closeFolder()})),this.$component.on("pointerenter.core.item pointerleave.core.item",".menu-item",(t=>{if("desktop"===flexbe_cli.resize.responsiveMode){const e="pointerenter"===t.type;this.$component.toggleClass("in-hover",e),$(t.currentTarget).toggleClass("hover",e)}})),this.$component.on("pointerenter.core.folder",".folder-item",(t=>{this.showOnHover&&(clearTimeout(this._dropdownTimer),$(t.currentTarget).hasClass("show")||(this._dropdownTimer=setTimeout((()=>{me.trigger("closeAll"),this.toggleFolder(t.currentTarget,!0)}),50)))})),this.$component.on("pointerleave.core.folder",".folder-item",(()=>{this.showOnHover&&(clearTimeout(this._dropdownTimer),this._dropdownTimer=setTimeout((()=>{me.trigger("closeAll")}),100))})),this.$component.on("click.core",".folder-item",(t=>{if(!this.showOnClick)return;const e=t.currentTarget;return("mobile"!==flexbe_cli.resize.responsiveMode||t.target.closest(".folder-item-text"))&&e?(this.toggleFolder(e),!1):void 0})),me.off(`closeAll.${this.eventId}`).on(`closeAll.${this.eventId}`,(()=>{this.openFolders.forEach((t=>this.toggleFolder(t,!1)))}))}observeItems(){let t,e=!0;const i=this.$component.find("li.root-item")[0];this.unobserveItems(),this._resizeObserver=new ResizeObserver((()=>{e?e=!1:(clearTimeout(t),t=setTimeout((()=>{this.onResize({})}),30))})),this._resizeObserver.observe(i)}unobserveItems(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}dispatchShowMore(){if(!this.allowShowMore||"mobile"===flexbe_cli.resize.responsiveMode||!this.isRowDirection)return void this.restoreMenuItems();this.$componentCopy?this.restoreMenuItems():this.$componentCopy=this.$component.clone();const t=getComputedStyle(this.$component[0]),e=this.$component.innerWidth(),i=this.$menuList.innerWidth(),s=parseInt(t.getPropertyValue("--gapX"),10)||0,o=e+2*s;if(i<=o)return this.observeItems(),!1;const n=this.$menuList.find("li.root-item");this.$menuList.append('\n            <li class="menu-item root-item folder-item show-more">\n                <svg viewBox="0 0 18 4">\n                    <path transform="rotate(-90 2 2)" d="M4 2a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm0 7a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm-2 9a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/>\n                </svg>\n\n                <ul class="component-menu-list component-menu-list--nested"></ul>\n            </li>\n        ');const a=this.$menuList.find(".show-more .component-menu-list--nested");let r=18+2*s;n.toArray().forEach((t=>{const e=t.offsetWidth;r+e>o&&(a.append(t),$(t).removeClass("root-item")),r+=e})),this.observeItems()}restoreMenuItems(){const t=this.$menuList.find(".show-more");if(t.length){if(this.$componentCopy){const t=this.$componentCopy.find(".component-menu-list--root").clone();this.$menuList.html(t.html())}else{const e=t.find(".component-menu-list").eq(0).children();e.addClass("root-item"),t.replaceWith(e)}this.$menuList.css({position:"",top:"",left:""}),this.unobserveItems()}}toggleFolder(t,e){null==e&&(e=!$(t).hasClass("show")),this[e?"_openFolder":"_closeFolder"](t)}toggleNestedFolder(t,e){null==e&&(e=!$(t).hasClass("show")),this[e?"_openNestedDropdown":"_closeNestedDropdown"](t)}_openFolder(t){const e=$(t);if(!e.length||e.hasClass("show"))return;const i=flexbe_cli.is_admin&&!!this.$component.closest(".editor-focus").length;if(!flexbe_cli.is_admin||i){if(this.showAsPopup){me.trigger("closeAll");const s=$("body"),o=e.find(".component-menu-list--nested").eq(0).clone(),n=$(`<div class="component-menu-dropdown ${i?"editor-focus":""}"></div>`);t.$dropdown=n;const a=getComputedStyle(t),r=["--gapY","--fontSize","--lineHeight","--fontWeight","--letterSpacing","--itemFontStyle","--itemTextDecoration"].reduce(((t,e)=>p({},t,{[e]:a.getPropertyValue(e)})),{});n.css(r),this.$component.addClass("in-show"),e.addClass("show"),n.append(o).appendTo(s),this.setDropdownPosition(t),$(this.root).closest(".m_modal").length&&this.$component.closest(".scroller").one(`scroll.${this.eventId}`,(()=>{this._closeFolder()})),n.off("pointerenter").on("pointerenter",(()=>{clearTimeout(this._dropdownTimer)})),s.on(`keydown.dropdown-${this.eventId}`,(t=>{"Escape"===t.code&&this._closeFolder()})),s.on(`click.dropdown-${this.eventId}`,(t=>{t.target.closest(".folder-item")||this._closeFolder()})),n.off("pointerleave").on("pointerleave",(()=>{clearTimeout(this._dropdownTimer),this.toggleNestedFolder(null,!1),this.showOnHover&&(this._dropdownTimer=setTimeout((()=>{this.toggleFolder(t,!1)}),100))})),n.on("pointerenter.core.folder pointerleave.core.folder",".menu-item",(t=>{$(t.currentTarget).toggleClass("hover","pointerenter"===t.type)})),flexbe_cli.run.is_touch?n.on("click.core.folder",".folder-item",(t=>{this.toggleNestedFolder(t.currentTarget)})):(n.on("pointerenter.core.folder",".folder-item",(t=>{this.toggleNestedFolder(t.currentTarget,!0)})),n.on("pointerleave.core.folder",".folder-item",(t=>{this.toggleNestedFolder(t.currentTarget,!1)})))}else e.addClass("show"),e.find(".component-menu-list--nested").eq(0).slideDown(350);this.openFolders.push(t)}}_closeFolder(t){const e=t?$(t):this.$menuList.find(".folder-item.show");$("body").off(`.dropdown-${this.eventId}`),this.$component.removeClass("in-show"),this.$component.closest(".scroller").off(`.${this.eventId}`),e.removeClass("show"),e.find(".show").removeClass("show"),this.showAsPopup?(e.find(".component-menu-list--nested").css("display",""),e.each(((t,e)=>{e.$dropdown&&e.$dropdown.remove()}))):e.find(".component-menu-list--nested").slideUp(350),this.openFolders=this.openFolders.filter((t=>!e.is(t)))}_openNestedDropdown(t){const{viewportWidth:e,documentHeight:i}=flexbe_cli.resize,s=$(t),o=s.siblings(".nested-item.show"),n=s.find(".component-menu-list--nested").eq(0),a=s.offset(),r=s.innerWidth(),l=s.innerHeight(),d=a.left,c=d+r,h=a.top,u=h+l,p=n.innerWidth(),m=n.innerHeight(),f=d>p,g=e-c>p,v=h>m,b=i-u>m;o.each(((t,e)=>this._closeNestedDropdown(e))),s.addClass("show"),n.addClass("show-dropdown"),g?n.addClass("in-right"):f?n.addClass("in-left"):(n.addClass("in-right"),n.css({marginTop:"15px",marginLeft:`-${Math.floor(p-(e-c)+10)}px`})),b?n.addClass("in-bottom"):v?n.addClass("in-top"):n.addClass("in-bottom")}_closeNestedDropdown(t){const e=$(t),i=e.find(".component-menu-list--nested").eq(0);e.removeClass("show"),i.removeClass("show-dropdown in-left in-right in-bottom in-top")}setDropdownPosition(t){if(!t||!t.$dropdown)return;const e=$(t),i=t.$dropdown,{documentHeight:s,viewportHeight:o,viewportWidth:n}=flexbe_cli.resize,a=i.find(".component-menu-list--nested"),r=e.hasClass("show-more"),l=r?e:e.children().first(),d=l.innerWidth(),c=l.innerHeight(),h=l.offset(),u=h.top,p=u+c,m=h.left,f=a.innerWidth(),g=a.innerHeight(),v=m+f>n,b=m+m/2-(f/2+12)<0,w=p+g+12>s,y=p+g>window.scrollY+o;let _;v?_=m+d-f:r||!this.isRowDirection&&!b?(_=m+d/2-f/2,f<d&&(_=m)):_=m-8;const x=this.$header.length&&this.$header.hasClass("fixed-header"),A={position:"absolute",width:f,height:g+3,paddingTop:"3px",left:_};if(x){const t=l[0].getBoundingClientRect();A.position="fixed",A.top=`${t.bottom}px`}else w||this.rootModal&&y?(A.top=u-(g+3),A.paddingBottom="3px",A.paddingTop=0):A.top=p;f<d&&(A.width=d+12,a.css("min-width",`${d+12}px`)),i.toggleClass("rise",x),i.css(A)}},form:class extends ve{fileInput(){this.$form.on(`change${this.eventId}`,".file-input--original",(t=>{const e=$(t.currentTarget),i=e.parents(".file-input-outer"),s=e.val(),o=t.currentTarget.files.length;if(i.addClass("active"),e.parents(".form-field").removeClass("is_error"),1===o&&i.find(".file-item--title").text(s),o>1){const t=o%100,e=o%10,s=Math.floor(t/10);let n;n=1===e&&11!==t?"form.filesMult":e>1&&e<5&&1!==s?"form.filesMult1":"form.filesMult2",i.find(".file-item--title").text(`${o} ${X.tr(n)}`)}0===o&&i.removeClass("active")})),this.$form.on(`click${this.eventId}`,".clear-files",(t=>{const e=$(t.currentTarget).parents(".file-input-outer");e.find(".file-input--original").val(""),e.removeClass("active")}))}},quiz:class extends ye{setProgress(){const t=this.$progress.find(".progress-loader-bar .current"),e="step"===this.$progress.attr("data-text-style"),i=t.attr("data-unit"),s=this.total;let o=this.realIndex;if(flexbe_cli.is_admin&&-1===this.realIndex&&"welcome"!==this.currentId){o=+this.$currentStep.prevAll('[data-linked="linked"]').first().attr("data-real-index")+1||0}o=Math.max(0,Math.min(s-1,o));const n=e?o+1:o,a=parseInt(100*n/s,10);if(this.$progress.attr("data-current",n),this.$progress.attr("data-total",s),this.$progress.attr("data-current-progress",a>0?a:0),t&&i){const e=t.find(".progress-runner");let o=`${a}%`;"step"===i?o=`${n} / ${s}`:"none"===i&&(o=""),e.attr("data-value",o)}this.$progress.find(".progress-text .current").text(n),this.$progress.find(".progress-text .total").text(s),this.$progress.find(".progress-percent .current").text(a),this.$progress.find(".progress-loader-bar .current").css("width",`${a}%`),this.$progress.find(".progress-loader-circle .current").attr("stroke-dashoffset",`${Math.abs(100-a)}`)}initFieldFile(){this.$form.on(`change.file${this.eventId}`,".file-input--original",(t=>{const e=$(t.currentTarget),i=e.parents(".file-input-outer"),s=e.val(),o=t.currentTarget.files.length;if(i.addClass("active"),e.closest("[data-type]").removeClass("is_error"),1===o)i.find(".file-item--title").text(s);else if(o>1){const t=o%100,e=o%10;let s;s=1===e&&11!==t?"form.filesMult":e>1&&e<5?"form.filesMult1":"form.filesMult2",i.find(".file-item--title").text(`${o} ${X.tr(s)}`)}else i.removeClass("active")})),this.$form.on(`click${this.eventId}`,".clear-files",(t=>{const e=$(t.currentTarget).parents(".file-input-outer");e.find(".file-input--original").val(""),e.removeClass("active")}))}}}),void 0===window.flexbe_cli&&(window.flexbe_cli={}),flexbe_cli.helpers=q,flexbe_cli.vars=E,flexbe_cli.run=z,flexbe_cli.lib=N,flexbe_cli.stat=Y,flexbe_cli.events=h,flexbe_cli.locale=X,flexbe_cli.adaptive=J,flexbe_cli.scroll=B,flexbe_cli.resize=D,flexbe_cli.tip=tt,flexbe_cli.require=M,flexbe_cli.fixed=lt,flexbe_cli.entity=zt,flexbe_cli.block=Rt,flexbe_cli.modal=bt,flexbe_cli.widget=Lt,flexbe_cli.element=Ot,flexbe_cli.components=Xt,flexbe_cli.ecommerce=pt,function(t=(()=>{})){let e=!1;function i(){e||("undefined"!=typeof jQuery&&jQuery.debounce?(e=!0,requestAnimationFrame((async()=>{await t(),flexbe_cli.is_service||(O(),setTimeout((()=>O()),1e3),window.addEventListener("popstate",O)),flexbe_cli.isInited=!0}))):setTimeout(i,10))}["complete","loaded"].includes(document.readyState)?i():document.addEventListener("DOMContentLoaded",(()=>{i()})),window.addEventListener("load",(()=>{i(),flexbe_cli.isLoaded=!0}))}((async()=>{E.init(),await z.init(),h.init(),B.init(),D.init(),Ct((()=>N.init())),Ct((()=>X.init())),Ct((()=>Y.init())),Ct((()=>J.init())),Ct((()=>pt.init(!0))),Ct((()=>Xt.init())),Ct((()=>zt.init())),Ct((()=>Rt.init())),Ct((()=>bt.init())),Ct((()=>Lt.init())),Ct((()=>Ot.init())),Ct((()=>st.init())),Ct((()=>lt.init()),200)}))}();
